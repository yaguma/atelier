# Performance Specialist チェックリスト

## 観点: Phaserライフサイクル・メモリリーク・リソース管理

参照ルール: `performance.md`, `phaser-best-practices.md`, `ui-components.md`

---

## チェック項目

### 1. Phaserライフサイクル

- [ ] `update()` 内でオブジェクト生成（new, [], {}）が行われていないか
- [ ] `update()` 内でDOM操作が行われていないか
- [ ] `update()` 内で重い計算（配列フィルタ, ソート, 経路探索）が行われていないか
- [ ] `update()` 内でネットワーク通信が行われていないか
- [ ] 不要な `update()` が定義されていないか（イベント駆動で済む場合）
- [ ] `init()`, `create()`, `preload()` の責務が適切か

### 2. メモリリーク防止

- [ ] EventBusの購読が `destroy()` で解除されているか
- [ ] Phaserイベントリスナー（`this.input.on`, `this.events.on`）が解除されているか
- [ ] Tweenが `destroy()` で停止されているか
- [ ] タイマー（`this.time.addEvent`）が `destroy()` で削除されているか
- [ ] GameObjectが適切に破棄されているか
- [ ] グローバル参照（`window.*`）が使用されていないか

### 3. BaseComponent準拠

- [ ] カスタムUIコンポーネントが `BaseComponent` を継承しているか
- [ ] `create()` メソッドが実装されているか
- [ ] `destroy()` メソッドが実装され、全リソースを解放しているか
- [ ] 子コンポーネントも明示的に破棄されているか
- [ ] `addToScene: false` が親子関係で適切に使われているか

### 4. THEME使用

- [ ] 色がハードコードされていないか（`THEME.colors.*` を使用）
- [ ] フォントサイズがハードコードされていないか（`THEME.font.size.*` を使用）
- [ ] スペーシングがハードコードされていないか（`THEME.spacing.*` を使用）

### 5. リソース管理

- [ ] テクスチャアトラスが活用されているか（多数の小画像の場合）
- [ ] 画像サイズが適切か（2の累乗サイズ推奨）
- [ ] 頻繁に生成・破棄するオブジェクトにプーリングが検討されているか
- [ ] アセットキーの命名規則（`<category>-<name>[-<variant>]`）に従っているか

### 6. 状態管理のパフォーマンス

- [ ] 状態更新がイミュータブルに行われているか（直接変更なし）
- [ ] 必要な部分のみが更新されているか（全体再計算の回避）
- [ ] 画面外のオブジェクトが非表示に設定されているか
- [ ] 複数のUI更新がバッチ処理されているか

### 7. レンダリング

- [ ] 可視性管理が適切か（画面外オブジェクトの setVisible/setActive）
- [ ] スクロールパネルで仮想化が検討されているか（大量要素の場合）
- [ ] 不要な再描画が発生していないか

---

## 重点チェックポイント

### シーン追加・変更時
- `shutdown()` / `destroy()` でのクリーンアップ漏れ
- シーン遷移時のリソース解放
- `update()` の必要性の検討

### UIコンポーネント追加時
- BaseComponent継承の確認
- destroy()の完全性チェック
- THEME定数の使用

### イベント購読の追加時
- 対応する解除処理の存在
- 購読解除関数の保持パターン
