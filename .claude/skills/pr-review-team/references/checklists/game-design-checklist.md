# Game Design Reviewer チェックリスト

## 観点: ゲームロジック整合性・状態管理・マスターデータ

参照ルール: `architecture.md`, `state-management.md`

---

## チェック項目

### 1. Feature層 / Shared層の実効性

- [ ] 新規コードがFeature層で適切な場所に配置されているか
- [ ] デッドコード（使われていない関数, クラス, 型）が存在しないか
- [ ] Feature層の実装がシーンから実際に参照されているか
- [ ] 重複実装がないか（同じロジックがFeature層とシーンの両方に存在）
- [ ] `index.ts` で公開しているが実際には未使用のエクスポートがないか

### 2. ゲームメカニクスの正しさ

- [ ] 報酬計算が仕様通りか（ゴールド, 貢献度, 経験値）
- [ ] 品質計算（調合品質, 素材品質）のロジックが正しいか
- [ ] 難易度に応じたスケーリングが適切か
- [ ] マスターデータ（レシピ, アイテム, 素材）のID参照が正しいか
- [ ] 存在しないIDを参照していないか

### 3. ゲームバランスへの影響

- [ ] 報酬金額が適切な範囲か（ゲーム進行を壊さない）
- [ ] コスト設定がプレイヤーの進行度に見合っているか
- [ ] 確率設定（ドロップ率, 品質ボーナス等）が妥当か
- [ ] 難易度曲線が意図通りか

### 4. 状態管理の正しさ

- [ ] StateManagerの更新が適切なタイミングで行われているか
- [ ] フェーズ遷移が `VALID_PHASE_TRANSITIONS` に準拠しているか
- [ ] ゲーム状態の整合性制約が維持されているか（ゴールド非負, 日数正数）
- [ ] 状態の直接変更が行われていないか（`stateManager.updateState()` 経由）
- [ ] EventBusイベントが適切なタイミングで発行されているか

### 5. フェーズ遷移

- [ ] 遷移図に従っているか: `QUEST_ACCEPT → GATHERING → ALCHEMY → DELIVERY → QUEST_ACCEPT`
- [ ] `DAY_END` 遷移が正しいか
- [ ] 不正な遷移が防止されているか（`canTransitionTo()` チェック）
- [ ] 各フェーズの開始条件・終了条件が明確か

### 6. データ整合性

- [ ] 依頼（Quest）のデータが完全か（必須フィールドの欠落なし）
- [ ] アイテムIDとマスターデータの対応が正しいか
- [ ] インベントリ操作（追加, 削除, 数量変更）が整合性を保っているか
- [ ] セーブ/ロード時にゲーム状態が正しく保持されるか

### 7. UI表示とゲームロジックの一致

- [ ] UI表示がゲーム状態を正確に反映しているか
- [ ] ゴールド表示が実際の値と一致するか
- [ ] フェーズ表示が現在のフェーズと一致するか
- [ ] ボタンの活性/非活性状態がゲームルールに従っているか

---

## 重点チェックポイント

### 依頼（Quest）関連の変更時
- 依頼生成ロジックの難易度スケーリング
- 報酬計算の正確性
- 依頼タイプと要求アイテムの整合性
- SPECIFIC依頼のitemId参照の正しさ

### 調合（Alchemy）関連の変更時
- レシピ参照の正しさ
- 品質計算の論理
- 素材消費の正確性
- 生成アイテムのマスターデータ整合性

### 採取（Gathering）関連の変更時
- ドロップテーブルの正しさ
- AP消費の適切性
- 採取結果のインベントリ反映

### ショップ（Shop）関連の変更時
- 価格設定の妥当性
- 購入可能条件の正しさ
- ゴールド消費とアイテム付与の整合性

### ランク（Rank）関連の変更時
- 昇格条件の正しさ
- 貢献度計算の正確性
- ランクに応じた機能解放の適切性
