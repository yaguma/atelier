# メイン画面詳細設計

## 基本情報

| 項目 | 値 |
|------|-----|
| 画面ID | SCR-003 |
| 画面名 | メイン画面（MainGameScene） |
| 親画面 | タイトル画面 |
| 子画面 | リザルト画面 |

---

## ワイヤーフレーム

🟡

```
┌──────────────────────────────────────────────────────────────────┐
│ [ステータスバー]                                                   │
│  開拓度: ██████░░░░ 60%  消耗度: ████░░░░░░ 40%                    │
│  お金: 150G                          ターン: 15/30                 │
├──────────────────────────────────────────────────────────────────┤
│ [タブ] [依頼] [採取] [調合] [買い物] [デッキ]                       │
├──────────────────────────────────────────────────────────────────┤
│                                                                   │
│                                                                   │
│                    [タブコンテンツエリア]                           │
│                                                                   │
│                    ┌─────────────────────────────────┐           │
│                    │                                 │           │
│                    │     各タブの内容がここに表示      │           │
│                    │                                 │           │
│                    └─────────────────────────────────┘           │
│                                                                   │
├──────────────────────────────────────────────────────────────────┤
│ [ターン終了ボタン] [ヘルプ]                                         │
└──────────────────────────────────────────────────────────────────┘
```

---

## UI要素

### ステータスバー

🔵

| 要素ID | 種類 | 説明 | 更新タイミング |
|--------|------|------|---------------|
| progress-exploration | プログレスバー | 開拓度表示 | 依頼納品時 |
| progress-exhaustion | プログレスバー | 消耗度表示 | 毎ターン |
| text-money | テキスト | 所持金表示 | 収支発生時 |
| text-turn | テキスト | ターン表示 | 毎ターン |

```html
<div class="status-bar">
  <div class="status-item">
    <label>開拓度</label>
    <div class="progress-bar">
      <div class="progress-fill exploration" id="progress-exploration"></div>
    </div>
    <span id="text-exploration">0%</span>
  </div>
  <div class="status-item">
    <label>消耗度</label>
    <div class="progress-bar">
      <div class="progress-fill exhaustion" id="progress-exhaustion"></div>
    </div>
    <span id="text-exhaustion">0%</span>
  </div>
  <div class="status-item">
    <label>お金</label>
    <span id="text-money">100G</span>
  </div>
  <div class="status-item">
    <label>ターン</label>
    <span id="text-turn">1/30</span>
  </div>
</div>
```

### タブコンテンツ

#### 依頼タブ

🔵

```
┌────────────────────────────────────────────────────────────┐
│ [受注可能な依頼]                                            │
│ ┌──────────────────────┐ ┌──────────────────────┐         │
│ │ 初心者の剣          │ │ 薬草の水薬          │         │
│ │ カテゴリ: 武器       │ │ カテゴリ: 薬         │         │
│ │ 要件: 火≥10         │ │ 要件: 水≥10         │         │
│ │ 報酬: 50G, 開拓+15% │ │ 報酬: 40G, 消耗-15% │         │
│ │ 期限: 12ターン       │ │ 期限: 12ターン       │         │
│ │ [受注する]           │ │ [受注する]           │         │
│ └──────────────────────┘ └──────────────────────┘         │
├────────────────────────────────────────────────────────────┤
│ [受注中の依頼] (1/2)                                        │
│ ┌──────────────────────┐                                   │
│ │ 鋼の剣              │                                   │
│ │ 残り: 8ターン        │                                   │
│ │ 要件: 火≥12, 土≥5   │                                   │
│ │ [納品する] ← 調合済みアイテムがあれば有効                 │
│ └──────────────────────┘                                   │
└────────────────────────────────────────────────────────────┘
```

| 要素ID | 種類 | 説明 |
|--------|------|------|
| quest-available-list | リスト | 受注可能な依頼一覧 |
| quest-active-list | リスト | 受注中の依頼一覧 |
| btn-accept-quest | ボタン | 依頼受注 |
| btn-deliver-quest | ボタン | 依頼納品 |

#### 採取タブ

🟡

```
┌────────────────────────────────────────────────────────────┐
│ [採取地を選択]                                              │
│                                                            │
│ ┌──────────────────────┐ ┌──────────────────────┐         │
│ │ 🌲 近郊の森          │ │ ⛰️ 山麓の岩場        │         │
│ │                      │ │                      │         │
│ │ ターン消費: 1        │ │ ターン消費: 2        │         │
│ │ 獲得: 2枚            │ │ 獲得: 3枚            │         │
│ │ 傾向: 水・風         │ │ 傾向: 火・土         │         │
│ │                      │ │                      │         │
│ │ [採取する]           │ │ [採取する]           │         │
│ └──────────────────────┘ └──────────────────────┘         │
│                                                            │
│ ※ デッキ残り容量: 7枚                                       │
└────────────────────────────────────────────────────────────┘
```

| 要素ID | 種類 | 説明 |
|--------|------|------|
| location-forest | カード | 近郊の森 |
| location-rocky | カード | 山麓の岩場 |
| btn-gather | ボタン | 採取実行 |
| text-deck-capacity | テキスト | デッキ残り容量 |

#### 調合タブ

🟡

```
┌────────────────────────────────────────────────────────────┐
│ [素材を選択] (2〜5枚)                                       │
│                                                            │
│ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐       │
│ │鉄鉱│ │薬草│ │石  │ │花  │ │硫黄│ │苔  │ │粘土│       │
│ │火3 │ │水3 │ │土3 │ │風3 │ │火4 │ │水2 │ │土2 │       │
│ │土1 │ │風1 │ │火1 │ │水1 │ │    │ │土1 │ │水1 │       │
│ └────┘ └────┘ └────┘ └────┘ └────┘ └────┘ └────┘       │
│   ✓      ✓                                                 │
├────────────────────────────────────────────────────────────┤
│ [選択中のカード: 2枚]                                       │
│ 鉄鉱石 + 薬草                                               │
│                                                            │
│ [属性合計]                                                  │
│ 火: 3  水: 3  土: 1  風: 1  合計: 8                         │
│                                                            │
│ [予測カテゴリ] 要件不足（火または土が10必要）                 │
│                                                            │
│ [調合する] (無効)                                           │
└────────────────────────────────────────────────────────────┘
```

| 要素ID | 種類 | 説明 |
|--------|------|------|
| card-list-crafting | カードリスト | 調合用カード一覧 |
| selected-cards | 表示 | 選択中のカード |
| attribute-preview | 表示 | 属性プレビュー |
| category-preview | 表示 | カテゴリ予測 |
| btn-craft | ボタン | 調合実行 |

#### 買い物タブ

🟡

```
┌────────────────────────────────────────────────────────────┐
│ [ショップ] (次の更新まで: 2ターン)                          │
│                                                            │
│ ┌────────────┐ ┌────────────┐ ┌────────────┐             │
│ │ 鉄鉱石     │ │ 薬草       │ │ 水晶       │             │
│ │ 火+3, 土+1 │ │ 水+3, 風+1 │ │ 火+3, 土+2 │             │
│ │ 15G        │ │ 15G        │ │ 30G        │             │
│ │ [購入]     │ │ [購入]     │ │ [購入]     │             │
│ └────────────┘ └────────────┘ └────────────┘             │
│                                                            │
│ 所持金: 150G                                               │
└────────────────────────────────────────────────────────────┘
```

| 要素ID | 種類 | 説明 |
|--------|------|------|
| shop-item-list | カードリスト | ショップ商品一覧 |
| shop-refresh-timer | テキスト | 更新までのターン数 |
| btn-purchase | ボタン | 購入ボタン |

#### デッキタブ

🟡

```
┌────────────────────────────────────────────────────────────┐
│ [デッキ] (8/15枚)                                          │
│                                                            │
│ [火属性] ━━━━━━━━━━━                                       │
│ ┌────┐ ┌────┐                                             │
│ │鉄鉱│ │硫黄│                                             │
│ └────┘ └────┘                                             │
│                                                            │
│ [水属性] ━━━━━━━━━━━                                       │
│ ┌────┐ ┌────┐                                             │
│ │薬草│ │苔  │                                             │
│ └────┘ └────┘                                             │
│                                                            │
│ [土属性] ━━━━━━━━━━━                                       │
│ ┌────┐ ┌────┐                                             │
│ │石  │ │粘土│                                             │
│ └────┘ └────┘                                             │
│                                                            │
│ [風属性] ━━━━━━━━━━━                                       │
│ ┌────┐ ┌────┐                                             │
│ │花  │ │種  │                                             │
│ └────┘ └────┘                                             │
└────────────────────────────────────────────────────────────┘
```

| 要素ID | 種類 | 説明 |
|--------|------|------|
| deck-card-list | カードリスト | デッキ内カード一覧 |
| deck-count | テキスト | デッキ枚数表示 |

---

## 状態遷移

### 初期状態

🟡

- タブ: 依頼タブが選択状態
- ステータス: 初期値を表示
- 依頼: 受注可能な依頼を表示

### ローディング状態

🟡

- 行動実行中（採取、調合、買い物）にローディング表示
- ボタンを無効化

### 結果表示状態

🟡

- 行動結果をダイアログで表示
- 採取: 獲得カード一覧
- 調合: 完成アイテム情報
- 納品: 報酬情報

---

## イベント

| イベント名 | トリガー | 処理内容 |
|-----------|----------|----------|
| OnTabClick | タブクリック | タブ切替、コンテンツ更新 |
| OnQuestAccept | 受注ボタン | 依頼受注処理 |
| OnQuestDeliver | 納品ボタン | 依頼納品処理 |
| OnGather | 採取ボタン | 採取処理 |
| OnCardSelect | カードクリック | カード選択/解除 |
| OnCraft | 調合ボタン | 調合処理 |
| OnPurchase | 購入ボタン | 購入処理 |

---

## アニメーション

| トリガー | アニメーション | 時間 |
|----------|---------------|------|
| ステータス更新 | 数値カウントアップ | 0.3s |
| プログレスバー変化 | スムーズ伸縮 | 0.5s |
| カード獲得 | フェードイン + スライド | 0.3s |
| カード選択 | スケール拡大 | 0.15s |
| タブ切替 | クロスフェード | 0.15s |

---

## アクセシビリティ

🟡

- [x] キーボード操作対応（Tab, Enter, Escape）
- [ ] スクリーンリーダー対応（本番で対応）
- [x] 色覚多様性対応（テキストラベル併用）
- [x] フォーカス表示

---

## 参照

- [../overview.md](../overview.md) - UI設計概要
- [../input-system.md](../input-system.md) - 入力システム設計
- [../../architecture.md](../../architecture.md) - システムアーキテクチャ

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2025-12-29 | 1.0 | 初版作成（HTMLプロトタイプ用） |
