# TASK-0019: TitleScene実装 - 要件定義書

**タスクID**: TASK-0019
**タスク名**: TitleScene実装
**フェーズ**: Phase 3 - UI層
**作成日**: 2026-01-17
**バージョン**: 1.0.0

---

## 1. 概要

本要件定義書は、ゲームのタイトル画面（TitleScene）の実装要件を定義する。EARS（Easy Approach to Requirements Syntax）記法を使用し、テスト可能な要件を明確化する。

### 1.1 目的

- ゲーム起動後の最初のユーザー操作画面を提供する
- 新規ゲーム開始、コンティニュー、設定へのナビゲーションを提供する
- 既存のUIコンポーネント（Button、Dialog）を活用した実装を行う

### 1.2 スコープ

- TitleSceneクラスの実装
- タイトルロゴ・サブタイトルの表示
- メニューボタン（新規ゲーム、コンティニュー、設定）の表示と動作
- 確認ダイアログの表示と動作
- バージョン情報の表示

### 1.3 信頼性レベル

- 🔵 **青信号**: 設計文書に記載
- 🟡 **黄信号**: 設計文書から妥当な推測
- 🔴 **赤信号**: 設計文書にない推測

---

## 2. 機能要件（EARS記法）

### 2.1 画面表示要件

#### REQ-0019-001: タイトルロゴ表示 🔵

**EARS形式**: Ubiquitous（普遍的要件）

> TitleSceneが表示されている間、システムは画面中央上部に「ATELIER GUILD」というタイトルロゴテキストを表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-001-1 | TitleSceneが開始された時 | タイトルロゴテキスト「ATELIER GUILD」が表示される |
| AC-001-2 | タイトルロゴの位置 | 画面中央上部（Y座標: 約200px）に配置される |
| AC-001-3 | タイトルロゴのスタイル | フォントサイズ48px、色#8B4513（SaddleBrown）で表示される |

---

#### REQ-0019-002: サブタイトル表示 🔵

**EARS形式**: Ubiquitous（普遍的要件）

> TitleSceneが表示されている間、システムはタイトルロゴの下に「錬金術師ギルド」というサブタイトルテキストを表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-002-1 | TitleSceneが開始された時 | サブタイトル「錬金術師ギルド」が表示される |
| AC-002-2 | サブタイトルの位置 | タイトルロゴの下（Y座標: 約260px）に配置される |
| AC-002-3 | サブタイトルのスタイル | フォントサイズ24px、色#666666で表示される |

---

#### REQ-0019-003: バージョン情報表示 🔵

**EARS形式**: Ubiquitous（普遍的要件）

> TitleSceneが表示されている間、システムは画面右下に「Version 1.0.0」というバージョン情報を表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-003-1 | TitleSceneが開始された時 | バージョン情報が表示される |
| AC-003-2 | バージョン情報の位置 | 画面右下に配置される |
| AC-003-3 | バージョン情報の内容 | 「Version 1.0.0」と表示される |

---

### 2.2 ボタン表示要件

#### REQ-0019-004: 新規ゲームボタン表示 🔵

**EARS形式**: Ubiquitous（普遍的要件）

> TitleSceneが表示されている間、システムは画面中央に「新規ゲーム」ボタン（プライマリスタイル）を表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-004-1 | TitleSceneが開始された時 | 「新規ゲーム」ボタンが表示される |
| AC-004-2 | ボタンのスタイル | プライマリスタイル（背景色#8B4513、テキスト色白）で表示される |
| AC-004-3 | ボタンの位置 | 画面中央（Y座標: 約380px）に配置される |
| AC-004-4 | ボタンの状態 | 常に有効（enabled）状態である |

---

#### REQ-0019-005: コンティニューボタン表示 🔵

**EARS形式**: Ubiquitous（普遍的要件）

> TitleSceneが表示されている間、システムは画面中央に「コンティニュー」ボタン（セカンダリスタイル）を表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-005-1 | TitleSceneが開始された時 | 「コンティニュー」ボタンが表示される |
| AC-005-2 | ボタンのスタイル | セカンダリスタイルで表示される |
| AC-005-3 | ボタンの位置 | 新規ゲームボタンの下（Y座標: 約450px）に配置される |

---

#### REQ-0019-006: 設定ボタン表示 🔵

**EARS形式**: Ubiquitous（普遍的要件）

> TitleSceneが表示されている間、システムは画面中央に「設定」ボタン（セカンダリスタイル）を表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-006-1 | TitleSceneが開始された時 | 「設定」ボタンが表示される |
| AC-006-2 | ボタンのスタイル | セカンダリスタイルで表示される |
| AC-006-3 | ボタンの位置 | コンティニューボタンの下（Y座標: 約520px）に配置される |
| AC-006-4 | ボタンの状態 | 常に有効（enabled）状態である |

---

### 2.3 ボタン状態制御要件

#### REQ-0019-007: コンティニューボタン有効化 🔵

**EARS形式**: State-driven（状態駆動要件）

> セーブデータが存在する場合、システムはコンティニューボタンを有効（enabled）状態にしなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-007-1 | セーブデータが存在する時 | コンティニューボタンが有効状態になる |
| AC-007-2 | ボタンの見た目 | 通常の透明度（alpha: 1.0）で表示される |
| AC-007-3 | ボタンのクリック | クリック可能である |

---

#### REQ-0019-008: コンティニューボタン無効化 🔵

**EARS形式**: State-driven（状態駆動要件）

> セーブデータが存在しない場合、システムはコンティニューボタンを無効（disabled）状態にしなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-008-1 | セーブデータが存在しない時 | コンティニューボタンが無効状態になる |
| AC-008-2 | ボタンの見た目 | 半透明（alpha: 0.5）で表示される |
| AC-008-3 | ボタンのクリック | クリックしても何も起きない |

---

### 2.4 ボタンアクション要件

#### REQ-0019-009: 新規ゲームボタン押下（セーブデータなし） 🔵

**EARS形式**: Event-driven（イベント駆動要件）

> セーブデータが存在しない状態で新規ゲームボタンがクリックされた時、システムはMainSceneへ遷移しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-009-1 | セーブデータなしで新規ゲームボタンをクリック | MainSceneへ遷移する |
| AC-009-2 | 遷移時の動作 | 確認ダイアログは表示されない |
| AC-009-3 | ゲーム状態 | 初期状態でゲームが開始される |

---

#### REQ-0019-010: 新規ゲームボタン押下（セーブデータあり） 🔵

**EARS形式**: Event-driven（イベント駆動要件）

> セーブデータが存在する状態で新規ゲームボタンがクリックされた時、システムは確認ダイアログを表示しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-010-1 | セーブデータありで新規ゲームボタンをクリック | 確認ダイアログが表示される |
| AC-010-2 | ダイアログのタイトル | 「新規ゲーム開始」と表示される |
| AC-010-3 | ダイアログのメッセージ | 「既存のセーブデータは削除されます。よろしいですか？」と表示される |
| AC-010-4 | ダイアログのボタン | 「はい」「いいえ」の2つのボタンが表示される |

---

#### REQ-0019-011: 確認ダイアログ「はい」押下 🔵

**EARS形式**: Event-driven（イベント駆動要件）

> 確認ダイアログで「はい」ボタンがクリックされた時、システムは既存セーブデータを削除し、MainSceneへ遷移しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-011-1 | 確認ダイアログで「はい」をクリック | ダイアログが閉じる |
| AC-011-2 | セーブデータ | 既存セーブデータが削除される |
| AC-011-3 | シーン遷移 | MainSceneへ遷移する |
| AC-011-4 | ゲーム状態 | 初期状態でゲームが開始される |

---

#### REQ-0019-012: 確認ダイアログ「いいえ」押下 🔵

**EARS形式**: Event-driven（イベント駆動要件）

> 確認ダイアログで「いいえ」ボタンがクリックされた時、システムはダイアログを閉じ、TitleSceneに戻らなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-012-1 | 確認ダイアログで「いいえ」をクリック | ダイアログが閉じる |
| AC-012-2 | セーブデータ | 既存セーブデータは維持される |
| AC-012-3 | シーン | TitleSceneのまま（遷移しない） |

---

#### REQ-0019-013: コンティニューボタン押下 🔵

**EARS形式**: Event-driven（イベント駆動要件）

> コンティニューボタンがクリックされた時、システムはセーブデータを読み込み、MainSceneへ遷移しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-013-1 | コンティニューボタンをクリック | セーブデータが読み込まれる |
| AC-013-2 | シーン遷移 | MainSceneへ遷移する |
| AC-013-3 | ゲーム状態 | セーブデータの状態からゲームが再開される |

---

#### REQ-0019-014: 設定ボタン押下 🔴

**EARS形式**: Event-driven（イベント駆動要件）

> 設定ボタンがクリックされた時、システムは設定ダイアログを表示しなければならない（SHALL）。

**補足**: 設定ダイアログの詳細仕様は設計文書に明記されていないため、Phase 1ではスタブ実装とする。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-014-1 | 設定ボタンをクリック | 設定ダイアログが表示される（スタブ可） |
| AC-014-2 | ダイアログの内容 | 「設定機能は準備中です」と表示される（Phase 1） |

---

### 2.5 アニメーション要件 🟡

#### REQ-0019-015: 画面表示時フェードイン

**EARS形式**: Event-driven（イベント駆動要件）

> TitleSceneが開始された時、システムは画面全体をフェードインアニメーションで表示すべきである（SHOULD）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-015-1 | TitleSceneが開始された時 | 画面がフェードインで表示される |
| AC-015-2 | フェードイン時間 | 約500ms（0.5秒）のアニメーション |
| AC-015-3 | イージング | ease-outで自然な表示 |

---

#### REQ-0019-016: ボタンホバーエフェクト

**EARS形式**: Event-driven（イベント駆動要件）

> ボタンにマウスがホバーした時、システムはボタンを1.05倍に拡大すべきである（SHOULD）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-016-1 | ボタンにマウスホバー時 | ボタンが1.05倍に拡大される |
| AC-016-2 | ホバー解除時 | ボタンが元のサイズに戻る |
| AC-016-3 | アニメーション時間 | 約100ms（0.1秒） |

---

#### REQ-0019-017: 画面遷移時フェードアウト

**EARS形式**: Event-driven（イベント駆動要件）

> MainSceneへ遷移する時、システムは画面全体をフェードアウトアニメーションで遷移すべきである（SHOULD）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-017-1 | MainSceneへ遷移時 | 画面がフェードアウトで消える |
| AC-017-2 | フェードアウト時間 | 約300ms（0.3秒）のアニメーション |
| AC-017-3 | フェードアウト後 | MainSceneが開始される |

---

### 2.6 エラーハンドリング要件 🟡

#### REQ-0019-018: セーブデータ破損時の処理

**EARS形式**: Unwanted behavior（望ましくない動作）

> セーブデータが破損している場合、システムはコンティニューボタンを無効化し、新規ゲーム開始を促すべきである（SHOULD）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-018-1 | セーブデータが破損している時 | コンティニューボタンが無効化される |
| AC-018-2 | ユーザーへの通知 | コンソールに警告ログが出力される |
| AC-018-3 | ゲーム継続 | 新規ゲームは正常に開始できる |

---

#### REQ-0019-019: セーブデータ読み込み失敗時の処理

**EARS形式**: Unwanted behavior（望ましくない動作）

> コンティニュー時にセーブデータ読み込みが失敗した場合、システムはエラーダイアログを表示し、TitleSceneに戻らなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-019-1 | セーブデータ読み込み失敗時 | エラーダイアログが表示される |
| AC-019-2 | ダイアログのメッセージ | エラー内容が表示される |
| AC-019-3 | ダイアログ閉じた後 | TitleSceneに戻る |

---

## 3. 非機能要件

### 3.1 パフォーマンス要件

#### REQ-0019-020: 画面表示速度 🟡

> TitleSceneは、BootSceneからの遷移後1秒以内に全UI要素を表示完了しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-020-1 | シーン遷移後 | 1秒以内に全要素が表示される |
| AC-020-2 | ボタンの応答性 | クリック後100ms以内に反応する |

---

### 3.2 保守性要件

#### REQ-0019-021: コンポーネント再利用 🔵

> TitleSceneは、既存のUIコンポーネント（Button、Dialog）を使用して実装しなければならない（SHALL）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-021-1 | ボタン実装 | `Button`コンポーネントを使用する |
| AC-021-2 | ダイアログ実装 | `Dialog`コンポーネントを使用する |
| AC-021-3 | テーマ適用 | `THEME`定数からスタイルを適用する |

---

### 3.3 テスト容易性要件

#### REQ-0019-022: 依存性注入対応 🟡

> TitleSceneは、依存するサービス（SaveDataRepository）を外部から注入可能にすべきである（SHOULD）。

**受け入れ基準**:
| ID | 条件 | 期待結果 |
|-----|------|---------|
| AC-022-1 | 依存関係 | DIコンテナから依存を取得できる |
| AC-022-2 | テスト時 | モックに差し替え可能である |

---

## 4. テストケース対応表

| テストID | 要件ID | テスト内容 | 期待結果 |
|---------|--------|----------|---------|
| T-0019-01 | REQ-0019-001〜006 | 画面表示 | 全UI要素が正しく表示される |
| T-0019-02 | REQ-0019-009 | 新規ゲーム（セーブなし） | MainSceneへ遷移する |
| T-0019-03 | REQ-0019-010〜011 | 新規ゲーム（セーブあり→はい） | 確認後MainSceneへ遷移する |
| T-0019-04 | REQ-0019-012 | 新規ゲーム（セーブあり→いいえ） | ダイアログが閉じる |
| T-0019-05 | REQ-0019-013 | コンティニュー | セーブから再開する |
| T-0019-06 | REQ-0019-007 | コンティニュー有効化 | セーブありで有効になる |
| T-0019-07 | REQ-0019-008 | コンティニュー無効化 | セーブなしで無効になる |
| T-0019-08 | REQ-0019-014 | 設定ボタン | 設定ダイアログが表示される |
| T-0019-09 | REQ-0019-018 | セーブ破損時 | コンティニューが無効化される |
| T-0019-10 | REQ-0019-019 | 読み込み失敗時 | エラーダイアログが表示される |

---

## 5. 依存関係

### 5.1 使用するコンポーネント

| コンポーネント | ファイルパス | 用途 |
|--------------|-------------|------|
| Button | `src/presentation/ui/components/Button.ts` | メニューボタン表示 |
| Dialog | `src/presentation/ui/components/Dialog.ts` | 確認ダイアログ表示 |
| THEME | `src/presentation/ui/theme.ts` | スタイル定義 |
| BaseComponent | `src/presentation/ui/components/BaseComponent.ts` | コンポーネント基底クラス |

### 5.2 使用するインターフェース

| インターフェース | ファイルパス | 用途 |
|----------------|-------------|------|
| ISaveDataRepository | `src/domain/interfaces/save-data-repository.interface.ts` | セーブデータ操作 |

### 5.3 依存タスク

| タスクID | タスク名 | 状態 |
|---------|---------|-----|
| TASK-0008 | Phaser基本設定とBootScene | 完了 |
| TASK-0018 | 共通UIコンポーネント基盤 | 完了 |

---

## 6. 用語定義

| 用語 | 説明 |
|-----|------|
| TitleScene | ゲームのタイトル画面シーン |
| MainScene | ゲームのメイン画面シーン |
| プライマリボタン | 主要なアクション用のボタン（背景色付き） |
| セカンダリボタン | 補助的なアクション用のボタン |
| セーブデータ | ゲームの進行状況を保存したデータ |

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2026-01-17 | 1.0.0 | 初版作成 |
