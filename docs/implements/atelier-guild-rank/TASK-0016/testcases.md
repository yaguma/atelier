# TDDテストケース: TASK-0016 ShopService・ArtifactService実装

**作成日**: 2026-01-18
**タスクID**: TASK-0016

---

## 1. ShopServiceテストケース

### 1.1 getAvailableItems（ショップアイテム一覧取得）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-SHOP-001 | ランクGでアイテム一覧取得 | ランクG以下で解放されたアイテムのみ返す | 高 |
| T-SHOP-002 | ランクSでアイテム一覧取得 | 全アイテムを返す | 中 |
| T-SHOP-003 | 在庫0のアイテムは除外 | 在庫切れアイテムは含まれない | 高 |
| T-SHOP-004 | 無制限在庫(-1)のアイテムは含む | 在庫-1のアイテムは常に表示 | 中 |

### 1.2 canPurchase（購入可能判定）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-SHOP-005 | 十分なゴールドで購入可能 | true | 高 |
| T-SHOP-006 | ゴールド不足で購入不可 | false | 高 |
| T-SHOP-007 | 在庫切れで購入不可 | false | 高 |
| T-SHOP-008 | ランク不足で購入不可 | false | 中 |
| T-SHOP-009 | 存在しないアイテムで購入不可 | false | 中 |
| T-SHOP-010 | ゴールドちょうどで購入可能 | true | 中 |

### 1.3 purchase（購入処理）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-SHOP-011 | カード購入成功 | デッキにカード追加、ゴールド減少 | 高 |
| T-SHOP-012 | 素材購入成功 | インベントリに素材追加、ゴールド減少 | 高 |
| T-SHOP-013 | アーティファクト購入成功 | インベントリにアーティファクト追加、ゴールド減少 | 高 |
| T-SHOP-014 | ゴールド不足時エラー | INSUFFICIENT_GOLDエラー | 高 |
| T-SHOP-015 | 在庫切れ時エラー | OUT_OF_STOCKエラー | 高 |
| T-SHOP-016 | ランク不足時エラー | RANK_REQUIREDエラー | 中 |
| T-SHOP-017 | 購入後在庫が減少する | stock - 1 | 高 |
| T-SHOP-018 | 無制限在庫購入後も在庫-1維持 | stock = -1のまま | 中 |

### 1.4 getItemPrice（価格取得）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-SHOP-019 | 存在するアイテムの価格取得 | 正しい価格を返す | 高 |
| T-SHOP-020 | 存在しないアイテムの価格取得 | エラーまたは0 | 中 |

---

## 2. ArtifactServiceテストケース

### 2.1 getOwnedArtifacts（所持アーティファクト取得）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-001 | 初期状態で空配列 | [] | 高 |
| T-ART-002 | 追加後に所持リスト取得 | 追加したIDを含む | 高 |
| T-ART-003 | 複数所持時にすべて取得 | すべてのIDを含む | 中 |

### 2.2 addArtifact（アーティファクト追加）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-004 | 新規アーティファクト追加 | 所持リストに追加される | 高 |
| T-ART-005 | 重複追加でエラー | ALREADY_OWNEDエラー | 高 |

### 2.3 hasArtifact（所持判定）

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-006 | 所持しているアーティファクト | true | 高 |
| T-ART-007 | 所持していないアーティファクト | false | 高 |

### 2.4 品質ボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-008 | アーティファクトなしで0 | 0 | 高 |
| T-ART-009 | 錬金術師の眼鏡(QUALITY_UP+1)所持 | 1 | 高 |
| T-ART-010 | 賢者の石(偽)(QUALITY_UP+1)所持 | 1 | 中 |
| T-ART-011 | 複数QUALITY_UP効果の累積 | 合計値 | 高 |

### 2.5 貢献度ボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-012 | アーティファクトなしで0 | 0 | 高 |
| T-ART-013 | ギルドマスターの印(CONTRIBUTION_BONUS+20)所持 | 20 | 高 |

### 2.6 ゴールドボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-014 | アーティファクトなしで0 | 0 | 高 |
| T-ART-015 | 商人の指輪(GOLD_BONUS+20)所持 | 20 | 高 |

### 2.7 倉庫拡張ボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-016 | アーティファクトなしで0 | 0 | 高 |
| T-ART-017 | 採取袋の拡張(STORAGE_EXPANSION+5)所持 | 5 | 高 |

### 2.8 行動ポイントボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-018 | アーティファクトなしで0 | 0 | 高 |
| T-ART-019 | 時の砂時計(ACTION_POINT_BONUS+1)所持 | 1 | 高 |

### 2.9 レア確率ボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-020 | アーティファクトなしで0 | 0 | 高 |
| T-ART-021 | 幸運の四つ葉(RARE_CHANCE_UP+15)所持 | 15 | 高 |

### 2.10 調合コスト削減計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-022 | アーティファクトなしで0 | 0 | 高 |
| T-ART-023 | 伝説の釜(ALCHEMY_COST_REDUCTION+1)所持 | 1 | 高 |

### 2.11 提示回数ボーナス計算

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-024 | アーティファクトなしで0 | 0 | 高 |
| T-ART-025 | 古代の地図(PRESENTATION_BONUS+1)所持 | 1 | 高 |

### 2.12 ALL_BONUS効果

| テストID | テスト内容 | 期待結果 | 優先度 |
|---------|----------|----------|-------|
| T-ART-026 | 錬金王の冠(ALL_BONUS+10)の品質ボーナス | 1 (10%分) | 高 |
| T-ART-027 | 錬金王の冠(ALL_BONUS+10)の貢献度ボーナス | 1 (10%分) | 高 |
| T-ART-028 | ALL_BONUSと個別効果の累積 | 個別効果 + ALL_BONUS分 | 高 |

---

## 3. テストケースサマリー

| カテゴリ | テスト数 | 優先度高 | 優先度中 |
|---------|---------|---------|---------|
| ShopService | 20 | 14 | 6 |
| ArtifactService | 28 | 22 | 6 |
| **合計** | **48** | **36** | **12** |

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2026-01-18 | 1.0.0 | 初版作成 |
