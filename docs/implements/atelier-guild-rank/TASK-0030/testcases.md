# TASK-0030: E2Eテスト・デバッグ - テストケース定義書

**バージョン**: 1.0.0
**作成日**: 2026-01-18
**タスクID**: TASK-0030
**要件名**: atelier-guild-rank
**フェーズ**: 4 - 統合・テスト

---

## 1. 概要

本ドキュメントは、TASK-0030「E2Eテスト・デバッグ」のテストケースを定義する。
E2Eテスト（Playwright）、デバッグツールのユニットテスト、テストヘルパーのテスト、パフォーマンステストを網羅的に記載する。

---

## 2. E2Eテストケース（Playwright）

### 2.1 新規ゲーム開始

#### TC-E2E-001: タイトル画面が正常に表示される

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-001 |
| **テスト名** | タイトル画面の表示確認 |
| **対応要件** | REQ-E2E-001 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. ゲームページにアクセスする<br>2. タイトル画面の表示を待機する |
| **期待結果** | - タイトル画面が表示される<br>- 「新規ゲーム」ボタンが表示される<br>- コンソールにエラーが出力されない |
| **優先度** | 必須 |

#### TC-E2E-002: 新規ゲーム開始でMainSceneに遷移する

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-002 |
| **テスト名** | 新規ゲーム開始 |
| **対応要件** | REQ-E2E-001 |
| **前提条件** | タイトル画面が表示されている |
| **テスト手順** | 1. 「新規ゲーム」ボタンをクリックする<br>2. MainSceneへの遷移を待機する |
| **期待結果** | - MainSceneに遷移する<br>- 現在のランクが「G」と表示される<br>- 残り日数が「30」と表示される<br>- 所持金が「100G」と表示される |
| **優先度** | 必須 |

#### TC-E2E-003: 新規ゲーム開始時の初期デッキ確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-003 |
| **テスト名** | 初期デッキの確認 |
| **対応要件** | REQ-E2E-001 |
| **前提条件** | 新規ゲームが開始されている |
| **テスト手順** | 1. 新規ゲームを開始する<br>2. デバッグツールでデッキ状態を取得する |
| **期待結果** | - 手札が5枚表示される<br>- 初期デッキが正しく構成されている |
| **優先度** | 推奨 |

#### TC-E2E-004: セーブデータ存在時のコンティニュー表示

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-004 |
| **テスト名** | コンティニューボタンの有効化確認 |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. セーブデータを事前に作成する<br>2. ページをリロードする<br>3. タイトル画面を確認する |
| **期待結果** | - 「コンティニュー」ボタンが有効になっている<br>- クリック可能な状態である |
| **優先度** | 必須 |

---

### 2.2 1日サイクル完了

#### TC-E2E-010: 依頼受注フェーズの基本操作

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-010 |
| **テスト名** | 依頼受注フェーズの操作確認 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 新規ゲームが開始され、依頼受注フェーズにいる |
| **テスト手順** | 1. 表示された依頼者リストを確認する<br>2. 依頼を1件選択する<br>3. 受注ボタンをクリックする<br>4. フェーズ終了ボタンをクリックする |
| **期待結果** | - 依頼者が1〜3件表示される<br>- 依頼の選択が可能<br>- 受注後、アクティブ依頼に追加される<br>- 次のフェーズ（採取）に遷移する |
| **優先度** | 必須 |

#### TC-E2E-011: 依頼受注フェーズのスキップ

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-011 |
| **テスト名** | 依頼受注フェーズのスキップ |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 依頼受注フェーズにいる |
| **テスト手順** | 1. 依頼を受注せずにフェーズ終了ボタンをクリックする |
| **期待結果** | - 採取フェーズに遷移する<br>- アクティブ依頼は増えない |
| **優先度** | 推奨 |

#### TC-E2E-012: 採取フェーズの基本操作

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-012 |
| **テスト名** | 採取フェーズの操作確認 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 採取フェーズにいる、手札に採取地カードがある |
| **テスト手順** | 1. 手札から採取地カードを選択する<br>2. カードを使用する<br>3. 表示された素材選択肢から素材を選ぶ<br>4. 採取を終了する |
| **期待結果** | - 採取地カードの使用が可能<br>- 素材選択UIが表示される<br>- 選択した素材がインベントリに追加される<br>- 行動ポイントが消費される |
| **優先度** | 必須 |

#### TC-E2E-013: 採取フェーズでの複数ラウンド採取

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-013 |
| **テスト名** | 複数ラウンドの素材採取 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 採取フェーズにいる |
| **テスト手順** | 1. 採取地カードを使用する<br>2. 複数ラウンドにわたり素材を選択する<br>3. 採取を終了する |
| **期待結果** | - 各ラウンドで素材選択が可能<br>- 全ラウンドの素材がインベントリに追加される |
| **優先度** | 推奨 |

#### TC-E2E-014: 採取フェーズのスキップ

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-014 |
| **テスト名** | 採取フェーズのスキップ |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 採取フェーズにいる |
| **テスト手順** | 1. カードを使用せずにフェーズ終了ボタンをクリックする |
| **期待結果** | - 調合フェーズに遷移する<br>- インベントリは変化しない |
| **優先度** | 推奨 |

#### TC-E2E-015: 調合フェーズの基本操作

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-015 |
| **テスト名** | 調合フェーズの操作確認 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 調合フェーズにいる、素材とレシピカードがある |
| **テスト手順** | 1. レシピカードを選択する<br>2. 必要な素材を選択する<br>3. 調合ボタンをクリックする |
| **期待結果** | - レシピカードの選択が可能<br>- 素材選択UIが表示される<br>- 品質プレビューが表示される<br>- 調合後、アイテムがインベントリに追加される<br>- 使用した素材が消費される |
| **優先度** | 必須 |

#### TC-E2E-016: 調合フェーズでの強化カード使用

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-016 |
| **テスト名** | 強化カードを使用した調合 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 調合フェーズにいる、強化カードがある |
| **テスト手順** | 1. レシピカードを選択する<br>2. 素材を選択する<br>3. 強化カードを選択する<br>4. 調合ボタンをクリックする |
| **期待結果** | - 強化カードの効果が品質に反映される<br>- 強化カードが消費される |
| **優先度** | 推奨 |

#### TC-E2E-017: 調合フェーズのスキップ

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-017 |
| **テスト名** | 調合フェーズのスキップ |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 調合フェーズにいる |
| **テスト手順** | 1. 調合せずにフェーズ終了ボタンをクリックする |
| **期待結果** | - 納品フェーズに遷移する<br>- インベントリは変化しない |
| **優先度** | 推奨 |

#### TC-E2E-018: 納品フェーズの基本操作

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-018 |
| **テスト名** | 納品フェーズの操作確認 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 納品フェーズにいる、受注済み依頼と調合アイテムがある |
| **テスト手順** | 1. 受注済み依頼を選択する<br>2. 納品するアイテムを選択する<br>3. 納品ボタンをクリックする |
| **期待結果** | - 依頼の選択が可能<br>- 条件を満たすアイテムが選択可能<br>- 納品後、貢献度が加算される<br>- 報酬（ゴールド）が加算される<br>- 報酬カード選択UIが表示される |
| **優先度** | 必須 |

#### TC-E2E-019: 納品フェーズでの強化カード使用

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-019 |
| **テスト名** | 強化カードを使用した納品 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 納品フェーズにいる、強化カードがある |
| **テスト手順** | 1. 依頼とアイテムを選択する<br>2. 強化カードを選択する<br>3. 納品ボタンをクリックする |
| **期待結果** | - 強化カードの効果が貢献度に反映される<br>- 強化カードが消費される |
| **優先度** | 推奨 |

#### TC-E2E-020: 日終了処理

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-020 |
| **テスト名** | 日終了と翌日開始 |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 納品フェーズを終了した |
| **テスト手順** | 1. 納品フェーズを終了する<br>2. 日終了処理の完了を待機する |
| **期待結果** | - 残り日数が1減少する<br>- 行動ポイントが3に回復する<br>- 手札が5枚に補充される<br>- 翌日の依頼受注フェーズに遷移する |
| **優先度** | 必須 |

#### TC-E2E-021: 1日サイクル完全フロー

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-021 |
| **テスト名** | 1日サイクルの完全な流れ |
| **対応要件** | REQ-E2E-002 |
| **前提条件** | 新規ゲームが開始されている |
| **テスト手順** | 1. 依頼を受注する<br>2. 素材を採取する<br>3. アイテムを調合する<br>4. 依頼を納品する<br>5. 日終了を確認する |
| **期待結果** | - 全フェーズが正常に遷移する<br>- 翌日が開始される<br>- 状態が正しく更新される |
| **優先度** | 必須 |

---

### 2.3 セーブ/ロード

#### TC-E2E-030: セーブ実行

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-030 |
| **テスト名** | ゲームのセーブ |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | ゲームが進行中である |
| **テスト手順** | 1. ゲームを数ターン進める<br>2. セーブを実行する |
| **期待結果** | - セーブが正常に完了する<br>- localStorageにデータが保存される |
| **優先度** | 必須 |

#### TC-E2E-031: ロード実行

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-031 |
| **テスト名** | ゲームのロード |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. ページをリロードする<br>2. タイトル画面で「コンティニュー」を選択する |
| **期待結果** | - セーブ時の状態が復元される<br>- MainSceneに遷移する |
| **優先度** | 必須 |

#### TC-E2E-032: 日数の復元確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-032 |
| **テスト名** | セーブ/ロード後の日数確認 |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. 特定の日数でセーブする<br>2. ロードする<br>3. 日数を確認する |
| **期待結果** | - セーブ時の残り日数が正確に復元される |
| **優先度** | 必須 |

#### TC-E2E-033: ランクの復元確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-033 |
| **テスト名** | セーブ/ロード後のランク確認 |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. 特定のランクでセーブする<br>2. ロードする<br>3. ランクを確認する |
| **期待結果** | - セーブ時のランクが正確に復元される |
| **優先度** | 必須 |

#### TC-E2E-034: 所持金の復元確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-034 |
| **テスト名** | セーブ/ロード後の所持金確認 |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. 特定の所持金でセーブする<br>2. ロードする<br>3. 所持金を確認する |
| **期待結果** | - セーブ時の所持金が正確に復元される |
| **優先度** | 必須 |

#### TC-E2E-035: デッキ状態の復元確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-035 |
| **テスト名** | セーブ/ロード後のデッキ確認 |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. 特定のデッキ状態でセーブする<br>2. ロードする<br>3. デッキ状態を確認する |
| **期待結果** | - 手札・山札・捨て札が正確に復元される |
| **優先度** | 推奨 |

#### TC-E2E-036: インベントリの復元確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-036 |
| **テスト名** | セーブ/ロード後のインベントリ確認 |
| **対応要件** | REQ-E2E-003 |
| **前提条件** | セーブデータが存在する |
| **テスト手順** | 1. 素材・アイテムを持った状態でセーブする<br>2. ロードする<br>3. インベントリを確認する |
| **期待結果** | - 素材・アイテムが正確に復元される |
| **優先度** | 推奨 |

---

### 2.4 ゲームクリア

#### TC-E2E-040: Sランク到達でゲームクリア

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-040 |
| **テスト名** | Sランク到達によるゲームクリア |
| **対応要件** | REQ-E2E-004 |
| **前提条件** | デバッグツールが利用可能 |
| **テスト手順** | 1. デバッグツールでSランク状態をセットアップする<br>2. 昇格条件を満たす<br>3. ゲームクリア画面の表示を確認する |
| **期待結果** | - ゲームクリア画面に遷移する<br>- クリアメッセージが表示される |
| **優先度** | 必須 |

#### TC-E2E-041: ゲームクリア画面からタイトルへ戻る

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-041 |
| **テスト名** | ゲームクリア後のタイトル復帰 |
| **対応要件** | REQ-E2E-004 |
| **前提条件** | ゲームクリア画面が表示されている |
| **テスト手順** | 1. 「タイトルへ戻る」ボタンをクリックする |
| **期待結果** | - タイトル画面に遷移する |
| **優先度** | 必須 |

#### TC-E2E-042: ゲームクリア時のリザルト表示

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-042 |
| **テスト名** | ゲームクリア時のリザルト確認 |
| **対応要件** | REQ-E2E-004 |
| **前提条件** | ゲームクリア状態 |
| **テスト手順** | 1. ゲームクリア画面のリザルト情報を確認する |
| **期待結果** | - クリア日数が表示される<br>- 最終ランクが表示される |
| **優先度** | 推奨 |

---

### 2.5 ゲームオーバー

#### TC-E2E-050: 日数切れでゲームオーバー

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-050 |
| **テスト名** | 日数切れによるゲームオーバー |
| **対応要件** | REQ-E2E-005 |
| **前提条件** | デバッグツールが利用可能 |
| **テスト手順** | 1. デバッグツールで残り日数1、非Sランク状態をセットアップする<br>2. 日終了処理を実行する<br>3. ゲームオーバー画面の表示を確認する |
| **期待結果** | - ゲームオーバー画面に遷移する<br>- ゲームオーバーメッセージが表示される |
| **優先度** | 必須 |

#### TC-E2E-051: ゲームオーバー画面からタイトルへ戻る

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-051 |
| **テスト名** | ゲームオーバー後のタイトル復帰 |
| **対応要件** | REQ-E2E-005 |
| **前提条件** | ゲームオーバー画面が表示されている |
| **テスト手順** | 1. 「タイトルへ戻る」ボタンをクリックする |
| **期待結果** | - タイトル画面に遷移する |
| **優先度** | 必須 |

#### TC-E2E-052: 昇格試験失敗でゲームオーバー

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-052 |
| **テスト名** | 昇格試験失敗によるゲームオーバー |
| **対応要件** | REQ-E2E-005 |
| **前提条件** | G〜Fランクで昇格試験に挑戦 |
| **テスト手順** | 1. 昇格試験に挑戦する<br>2. 試験に失敗する |
| **期待結果** | - ゲームオーバー画面に遷移する |
| **優先度** | 推奨 |

---

### 2.6 コンソールエラー監視

#### TC-E2E-060: ゲーム起動時のエラー確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-060 |
| **テスト名** | 起動時のコンソールエラー確認 |
| **対応要件** | AC-006 |
| **前提条件** | なし |
| **テスト手順** | 1. ゲームを起動する<br>2. コンソールログを監視する |
| **期待結果** | - コンソールにエラーが出力されない |
| **優先度** | 必須 |

#### TC-E2E-061: 1日サイクル中のエラー確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-E2E-061 |
| **テスト名** | 1日サイクル中のコンソールエラー確認 |
| **対応要件** | AC-006 |
| **前提条件** | ゲームが進行中 |
| **テスト手順** | 1. 1日サイクルを実行する<br>2. コンソールログを監視する |
| **期待結果** | - コンソールにエラーが出力されない |
| **優先度** | 必須 |

---

## 3. デバッグツールのユニットテストケース

### 3.1 setRank

#### TC-DBG-001: ランクをSに変更

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-001 |
| **テスト名** | setRankでSランクに変更 |
| **対応要件** | REQ-DBG-001 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.setRank('S')`を実行する<br>2. 現在のランクを取得する |
| **期待結果** | - ランクが「S」に変更される<br>- StateManagerの状態が更新される |
| **優先度** | 推奨 |

#### TC-DBG-002: ランクをGに変更

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-002 |
| **テスト名** | setRankでGランクに変更 |
| **対応要件** | REQ-DBG-001 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.setRank('G')`を実行する<br>2. 現在のランクを取得する |
| **期待結果** | - ランクが「G」に変更される |
| **優先度** | 推奨 |

#### TC-DBG-003: 無効なランク指定時のエラー処理

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-003 |
| **テスト名** | 無効なランク指定時の動作 |
| **対応要件** | REQ-DBG-001 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.setRank('X')`を実行する |
| **期待結果** | - エラーがスローされる or 警告ログが出力される<br>- ランクは変更されない |
| **優先度** | 任意 |

---

### 3.2 addGold

#### TC-DBG-010: ゴールドを追加

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-010 |
| **テスト名** | addGoldで正の値を追加 |
| **対応要件** | REQ-DBG-002 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. 現在のゴールドを記録する<br>2. `debug.addGold(1000)`を実行する<br>3. ゴールドを確認する |
| **期待結果** | - ゴールドが1000増加する |
| **優先度** | 推奨 |

#### TC-DBG-011: ゴールドを減少

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-011 |
| **テスト名** | addGoldで負の値を指定 |
| **対応要件** | REQ-DBG-002 |
| **前提条件** | 開発モードでゲームが起動している、所持金が100G以上 |
| **テスト手順** | 1. 現在のゴールドを記録する<br>2. `debug.addGold(-50)`を実行する<br>3. ゴールドを確認する |
| **期待結果** | - ゴールドが50減少する |
| **優先度** | 推奨 |

#### TC-DBG-012: ゴールド減少で0未満にならない

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-012 |
| **テスト名** | ゴールドが0未満にならないことの確認 |
| **対応要件** | REQ-DBG-002 |
| **前提条件** | 開発モードでゲームが起動している、所持金が100G |
| **テスト手順** | 1. `debug.addGold(-200)`を実行する<br>2. ゴールドを確認する |
| **期待結果** | - ゴールドが0になる（負にならない） |
| **優先度** | 任意 |

---

### 3.3 skipToDay

#### TC-DBG-020: 指定日にスキップ

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-020 |
| **テスト名** | skipToDayで残り日数を設定 |
| **対応要件** | REQ-DBG-003 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.skipToDay(1)`を実行する<br>2. 残り日数を確認する |
| **期待結果** | - 残り日数が1になる |
| **優先度** | 推奨 |

#### TC-DBG-021: 最大日数に設定

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-021 |
| **テスト名** | skipToDayで最大日数を設定 |
| **対応要件** | REQ-DBG-003 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.skipToDay(30)`を実行する<br>2. 残り日数を確認する |
| **期待結果** | - 残り日数が30になる |
| **優先度** | 推奨 |

#### TC-DBG-022: 無効な日数指定時のエラー処理

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-022 |
| **テスト名** | 無効な日数指定時の動作 |
| **対応要件** | REQ-DBG-003 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.skipToDay(0)`を実行する<br>2. `debug.skipToDay(-5)`を実行する |
| **期待結果** | - エラーがスローされる or 警告ログが出力される<br>- 日数は無効な値にならない |
| **優先度** | 任意 |

---

### 3.4 unlockAllCards

#### TC-DBG-030: 全カード解放

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-030 |
| **テスト名** | unlockAllCardsで全カード解放 |
| **対応要件** | REQ-DBG-004 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. 初期デッキ枚数を記録する<br>2. `debug.unlockAllCards()`を実行する<br>3. デッキを確認する |
| **期待結果** | - 全種類のカードがデッキに追加される<br>- 重複なく追加される |
| **優先度** | 推奨 |

#### TC-DBG-031: 解放後の手札確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-031 |
| **テスト名** | 全カード解放後の手札補充確認 |
| **対応要件** | REQ-DBG-004 |
| **前提条件** | 全カードが解放されている |
| **テスト手順** | 1. 手札枚数を確認する |
| **期待結果** | - 手札が適切に補充される |
| **優先度** | 任意 |

---

### 3.5 logState

#### TC-DBG-040: 状態ログ出力

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-040 |
| **テスト名** | logStateでコンソール出力 |
| **対応要件** | REQ-DBG-005 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.logState()`を実行する<br>2. コンソールを確認する |
| **期待結果** | - ゲーム状態（ランク、日数、ゴールド等）が出力される<br>- デッキ状態が出力される<br>- インベントリ状態が出力される |
| **優先度** | 推奨 |

#### TC-DBG-041: 出力フォーマットの確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-041 |
| **テスト名** | logStateの出力フォーマット確認 |
| **対応要件** | REQ-DBG-005 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.logState()`を実行する<br>2. 出力フォーマットを確認する |
| **期待結果** | - 読みやすい形式で出力される<br>- JSON形式 or 整形された文字列 |
| **優先度** | 任意 |

---

### 3.6 setActionPoints

#### TC-DBG-050: 行動ポイント設定

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-050 |
| **テスト名** | setActionPointsで行動ポイント設定 |
| **対応要件** | REQ-DBG-006 |
| **前提条件** | 開発モードでゲームが起動している |
| **テスト手順** | 1. `debug.setActionPoints(10)`を実行する<br>2. 行動ポイントを確認する |
| **期待結果** | - 行動ポイントが10に設定される |
| **優先度** | 任意 |

---

### 3.7 clearSaveData

#### TC-DBG-060: セーブデータ削除

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-060 |
| **テスト名** | clearSaveDataでセーブデータ削除 |
| **対応要件** | REQ-DBG-007 |
| **前提条件** | 開発モードでゲームが起動している、セーブデータが存在する |
| **テスト手順** | 1. セーブを実行する<br>2. `debug.clearSaveData()`を実行する<br>3. localStorageを確認する |
| **期待結果** | - セーブデータが削除される<br>- localStorageから該当キーが消える |
| **優先度** | 任意 |

#### TC-DBG-061: セーブデータ削除後のコンティニュー無効化

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-061 |
| **テスト名** | セーブデータ削除後のタイトル画面確認 |
| **対応要件** | REQ-DBG-007 |
| **前提条件** | セーブデータが削除されている |
| **テスト手順** | 1. ページをリロードする<br>2. タイトル画面を確認する |
| **期待結果** | - コンティニューボタンが無効になっている |
| **優先度** | 任意 |

---

### 3.8 本番環境での無効化

#### TC-DBG-070: 本番モードでデバッグツール無効

| 項目 | 内容 |
|------|------|
| **テストID** | TC-DBG-070 |
| **テスト名** | 本番モードでのdebugオブジェクト確認 |
| **対応要件** | REQ-DBG-001 |
| **前提条件** | 本番ビルド（import.meta.env.DEV === false） |
| **テスト手順** | 1. 本番ビルドを実行する<br>2. `window.debug`を確認する |
| **期待結果** | - `window.debug`が`undefined`である |
| **優先度** | 必須 |

---

## 4. テストヘルパーのテストケース

### 4.1 GamePage（ページオブジェクト）

#### TC-TH-001: waitForGameLoad動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-001 |
| **テスト名** | waitForGameLoadの動作確認 |
| **対応要件** | REQ-TH-001 |
| **前提条件** | ゲームページにアクセスしている |
| **テスト手順** | 1. `gamePage.waitForGameLoad()`を呼び出す |
| **期待結果** | - キャンバスが表示されるまで待機する<br>- タイムアウトしない |
| **優先度** | 推奨 |

#### TC-TH-002: getCanvasSize動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-002 |
| **テスト名** | getCanvasSizeの動作確認 |
| **対応要件** | REQ-TH-001 |
| **前提条件** | ゲームがロードされている |
| **テスト手順** | 1. `gamePage.getCanvasSize()`を呼び出す |
| **期待結果** | - 幅と高さが返される<br>- 正の値である |
| **優先度** | 推奨 |

#### TC-TH-003: clickCanvas動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-003 |
| **テスト名** | clickCanvasの動作確認 |
| **対応要件** | REQ-TH-001 |
| **前提条件** | ゲームがロードされている |
| **テスト手順** | 1. `gamePage.clickCanvas(100, 100)`を呼び出す |
| **期待結果** | - 指定座標がクリックされる<br>- エラーが発生しない |
| **優先度** | 推奨 |

#### TC-TH-004: takeScreenshot動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-004 |
| **テスト名** | takeScreenshotの動作確認 |
| **対応要件** | REQ-TH-001 |
| **前提条件** | ゲームがロードされている |
| **テスト手順** | 1. `gamePage.takeScreenshot('test')`を呼び出す |
| **期待結果** | - スクリーンショットがファイルに保存される |
| **優先度** | 任意 |

---

### 4.2 TitlePage（ページオブジェクト）

#### TC-TH-010: waitForTitleLoad動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-010 |
| **テスト名** | waitForTitleLoadの動作確認 |
| **対応要件** | REQ-TH-002 |
| **前提条件** | ゲームページにアクセスしている |
| **テスト手順** | 1. `titlePage.waitForTitleLoad()`を呼び出す |
| **期待結果** | - タイトル画面が表示されるまで待機する |
| **優先度** | 推奨 |

#### TC-TH-011: clickNewGame動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-011 |
| **テスト名** | clickNewGameの動作確認 |
| **対応要件** | REQ-TH-002 |
| **前提条件** | タイトル画面が表示されている |
| **テスト手順** | 1. `titlePage.clickNewGame()`を呼び出す |
| **期待結果** | - 新規ゲームが開始される<br>- MainSceneに遷移する |
| **優先度** | 推奨 |

#### TC-TH-012: clickContinue動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-012 |
| **テスト名** | clickContinueの動作確認 |
| **対応要件** | REQ-TH-002 |
| **前提条件** | タイトル画面が表示されている、セーブデータが存在する |
| **テスト手順** | 1. `titlePage.clickContinue()`を呼び出す |
| **期待結果** | - ゲームがロードされる<br>- MainSceneに遷移する |
| **優先度** | 推奨 |

#### TC-TH-013: isContinueEnabled動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-013 |
| **テスト名** | isContinueEnabledの動作確認 |
| **対応要件** | REQ-TH-002 |
| **前提条件** | タイトル画面が表示されている |
| **テスト手順** | 1. セーブデータがない状態で`titlePage.isContinueEnabled()`を呼び出す<br>2. セーブデータがある状態で同メソッドを呼び出す |
| **期待結果** | - セーブなし: `false`<br>- セーブあり: `true` |
| **優先度** | 推奨 |

---

### 4.3 MainPage（ページオブジェクト）

#### TC-TH-020: getCurrentPhase動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-020 |
| **テスト名** | getCurrentPhaseの動作確認 |
| **対応要件** | REQ-TH-003 |
| **前提条件** | MainSceneが表示されている |
| **テスト手順** | 1. `mainPage.getCurrentPhase()`を呼び出す |
| **期待結果** | - 現在のフェーズ名が返される<br>- 有効なフェーズ名である |
| **優先度** | 推奨 |

#### TC-TH-021: getRemainingDays動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-021 |
| **テスト名** | getRemainingDaysの動作確認 |
| **対応要件** | REQ-TH-003 |
| **前提条件** | MainSceneが表示されている |
| **テスト手順** | 1. `mainPage.getRemainingDays()`を呼び出す |
| **期待結果** | - 残り日数が数値で返される<br>- 1〜30の範囲である |
| **優先度** | 推奨 |

#### TC-TH-022: getGold動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-022 |
| **テスト名** | getGoldの動作確認 |
| **対応要件** | REQ-TH-003 |
| **前提条件** | MainSceneが表示されている |
| **テスト手順** | 1. `mainPage.getGold()`を呼び出す |
| **期待結果** | - 所持金が数値で返される<br>- 0以上の値である |
| **優先度** | 推奨 |

#### TC-TH-023: getCurrentRank動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-023 |
| **テスト名** | getCurrentRankの動作確認 |
| **対応要件** | REQ-TH-003 |
| **前提条件** | MainSceneが表示されている |
| **テスト手順** | 1. `mainPage.getCurrentRank()`を呼び出す |
| **期待結果** | - 現在のランクが返される<br>- 有効なランク値（G〜S）である |
| **優先度** | 推奨 |

#### TC-TH-024: skipPhase動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-024 |
| **テスト名** | skipPhaseの動作確認 |
| **対応要件** | REQ-TH-003 |
| **前提条件** | MainSceneが表示されている |
| **テスト手順** | 1. 現在のフェーズを記録する<br>2. `mainPage.skipPhase()`を呼び出す<br>3. フェーズを確認する |
| **期待結果** | - 次のフェーズに遷移する |
| **優先度** | 推奨 |

---

### 4.4 ResultPage（ページオブジェクト）

#### TC-TH-030: waitForResultScreen動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-030 |
| **テスト名** | waitForResultScreenの動作確認 |
| **対応要件** | REQ-TH-004 |
| **前提条件** | ゲームクリア or ゲームオーバー状態 |
| **テスト手順** | 1. `resultPage.waitForResultScreen()`を呼び出す |
| **期待結果** | - リザルト画面が表示されるまで待機する |
| **優先度** | 推奨 |

#### TC-TH-031: isGameClear動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-031 |
| **テスト名** | isGameClearの動作確認 |
| **対応要件** | REQ-TH-004 |
| **前提条件** | リザルト画面が表示されている |
| **テスト手順** | 1. ゲームクリア状態で`resultPage.isGameClear()`を呼び出す<br>2. ゲームオーバー状態で同メソッドを呼び出す |
| **期待結果** | - クリア: `true`<br>- オーバー: `false` |
| **優先度** | 推奨 |

#### TC-TH-032: returnToTitle動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-032 |
| **テスト名** | returnToTitleの動作確認 |
| **対応要件** | REQ-TH-004 |
| **前提条件** | リザルト画面が表示されている |
| **テスト手順** | 1. `resultPage.returnToTitle()`を呼び出す |
| **期待結果** | - タイトル画面に遷移する |
| **優先度** | 推奨 |

---

### 4.5 GameStateHelper（状態セットアップ）

#### TC-TH-040: setGameState動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-040 |
| **テスト名** | setGameStateの動作確認 |
| **対応要件** | REQ-TH-005 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. `gameStateHelper.setGameState({ gold: 5000 })`を呼び出す<br>2. ゴールドを確認する |
| **期待結果** | - 指定した状態が適用される |
| **優先度** | 推奨 |

#### TC-TH-041: setupSRankState動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-041 |
| **テスト名** | setupSRankStateの動作確認 |
| **対応要件** | REQ-TH-005 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. `gameStateHelper.setupSRankState()`を呼び出す<br>2. ランクを確認する |
| **期待結果** | - ランクがSになっている<br>- 昇格ゲージが100%になっている |
| **優先度** | 推奨 |

#### TC-TH-042: setupGameOverState動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-042 |
| **テスト名** | setupGameOverStateの動作確認 |
| **対応要件** | REQ-TH-005 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. `gameStateHelper.setupGameOverState()`を呼び出す<br>2. 状態を確認する |
| **期待結果** | - 残り日数が1になっている<br>- ランクがGになっている |
| **優先度** | 推奨 |

#### TC-TH-043: setupRichState動作確認

| 項目 | 内容 |
|------|------|
| **テストID** | TC-TH-043 |
| **テスト名** | setupRichStateの動作確認 |
| **対応要件** | REQ-TH-005 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. `gameStateHelper.setupRichState()`を呼び出す<br>2. ゴールドと行動ポイントを確認する |
| **期待結果** | - ゴールドが10000になっている<br>- 行動ポイントが10になっている |
| **優先度** | 推奨 |

---

## 5. パフォーマンステストケース

### 5.1 フレームレート

#### TC-PERF-001: アイドル時のフレームレート

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-001 |
| **テスト名** | アイドル時のフレームレート計測 |
| **対応要件** | REQ-PERF-001 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. MainSceneを表示する<br>2. 操作せずに5秒間待機する<br>3. FPSを計測する |
| **期待結果** | - 平均60fps以上を維持する |
| **目標値** | 60fps安定 |
| **優先度** | 推奨 |

#### TC-PERF-002: フェーズ遷移中のフレームレート

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-002 |
| **テスト名** | フェーズ遷移中のフレームレート計測 |
| **対応要件** | REQ-PERF-001 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. フェーズを遷移させる<br>2. 遷移中のFPSを計測する |
| **期待結果** | - フレームレートが大幅に低下しない<br>- 30fps以上を維持する |
| **目標値** | 30fps以上 |
| **優先度** | 推奨 |

#### TC-PERF-003: アニメーション中のフレームレート

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-003 |
| **テスト名** | アニメーション中のフレームレート計測 |
| **対応要件** | REQ-PERF-001 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. カード使用などのアニメーションを発生させる<br>2. アニメーション中のFPSを計測する |
| **期待結果** | - アニメーション中も60fps近くを維持する |
| **目標値** | 55fps以上 |
| **優先度** | 任意 |

---

### 5.2 メモリ使用量

#### TC-PERF-010: 起動直後のメモリ使用量

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-010 |
| **テスト名** | 起動直後のメモリ使用量計測 |
| **対応要件** | REQ-PERF-002 |
| **前提条件** | ゲームが起動直後 |
| **テスト手順** | 1. ゲームを起動する<br>2. MainSceneに遷移する<br>3. メモリ使用量を計測する |
| **期待結果** | - 100MB以下である |
| **目標値** | 100MB以下 |
| **優先度** | 推奨 |

#### TC-PERF-011: 長時間プレイ後のメモリ使用量

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-011 |
| **テスト名** | 長時間プレイ後のメモリ使用量計測 |
| **対応要件** | REQ-PERF-002 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. 10日サイクルを実行する<br>2. メモリ使用量を計測する |
| **期待結果** | - メモリリークがない<br>- 起動時から大幅に増加しない（150MB以下） |
| **目標値** | 150MB以下 |
| **優先度** | 推奨 |

#### TC-PERF-012: シーン遷移後のメモリ使用量

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-012 |
| **テスト名** | シーン遷移後のメモリ使用量計測 |
| **対応要件** | REQ-PERF-002 |
| **前提条件** | ゲームが起動している |
| **テスト手順** | 1. メモリ使用量を記録する<br>2. タイトル→メイン→リザルト→タイトルと遷移する<br>3. メモリ使用量を計測する |
| **期待結果** | - シーン遷移でメモリが適切に解放される<br>- 最初の計測値に近い |
| **目標値** | 初期値の1.2倍以内 |
| **優先度** | 任意 |

---

### 5.3 ロード時間

#### TC-PERF-020: 初回起動時間

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-020 |
| **テスト名** | 初回起動時間計測 |
| **対応要件** | REQ-PERF-003 |
| **前提条件** | ブラウザキャッシュがクリアされている |
| **テスト手順** | 1. ページにアクセスする<br>2. ゲームが操作可能になるまでの時間を計測する |
| **期待結果** | - 2秒以内に起動する |
| **目標値** | 2秒以内 |
| **優先度** | 推奨 |

#### TC-PERF-021: キャッシュ有りの起動時間

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-021 |
| **テスト名** | キャッシュ有りの起動時間計測 |
| **対応要件** | REQ-PERF-003 |
| **前提条件** | アセットがキャッシュされている |
| **テスト手順** | 1. ページをリロードする<br>2. ゲームが操作可能になるまでの時間を計測する |
| **期待結果** | - 1秒以内に起動する |
| **目標値** | 1秒以内 |
| **優先度** | 任意 |

#### TC-PERF-022: シーン遷移時間（タイトル→メイン）

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-022 |
| **テスト名** | タイトルからメインへの遷移時間計測 |
| **対応要件** | REQ-PERF-004 |
| **前提条件** | タイトル画面が表示されている |
| **テスト手順** | 1. 新規ゲームボタンをクリックする<br>2. MainSceneが表示されるまでの時間を計測する |
| **期待結果** | - 500ms以内に遷移する |
| **目標値** | 500ms以内 |
| **優先度** | 推奨 |

#### TC-PERF-023: シーン遷移時間（メイン→リザルト）

| 項目 | 内容 |
|------|------|
| **テストID** | TC-PERF-023 |
| **テスト名** | メインからリザルトへの遷移時間計測 |
| **対応要件** | REQ-PERF-004 |
| **前提条件** | ゲームクリア or ゲームオーバー条件を満たしている |
| **テスト手順** | 1. ゲーム終了条件をトリガーする<br>2. リザルト画面が表示されるまでの時間を計測する |
| **期待結果** | - 500ms以内に遷移する |
| **目標値** | 500ms以内 |
| **優先度** | 推奨 |

---

## 6. テストケースサマリー

### 6.1 カテゴリ別テストケース数

| カテゴリ | 必須 | 推奨 | 任意 | 合計 |
|---------|------|------|------|------|
| E2Eテスト - 新規ゲーム開始 | 2 | 2 | 0 | 4 |
| E2Eテスト - 1日サイクル | 5 | 7 | 0 | 12 |
| E2Eテスト - セーブ/ロード | 4 | 3 | 0 | 7 |
| E2Eテスト - ゲームクリア | 2 | 1 | 0 | 3 |
| E2Eテスト - ゲームオーバー | 2 | 1 | 0 | 3 |
| E2Eテスト - エラー監視 | 2 | 0 | 0 | 2 |
| デバッグツール | 1 | 11 | 7 | 19 |
| テストヘルパー | 0 | 18 | 2 | 20 |
| パフォーマンス | 0 | 7 | 4 | 11 |
| **合計** | **18** | **50** | **13** | **81** |

### 6.2 優先度別実行順序

1. **必須テスト（18件）**: 最優先で実行。全て成功することが受け入れ基準
2. **推奨テスト（50件）**: 必須テスト後に実行。品質向上のため実施
3. **任意テスト（13件）**: 時間に余裕があれば実行

### 6.3 テストIDマッピング

| タスク定義のテストID | 対応テストケース |
|---------------------|-----------------|
| T-0030-01 | TC-E2E-001, TC-E2E-002, TC-E2E-003 |
| T-0030-02 | TC-E2E-010〜TC-E2E-021 |
| T-0030-03 | TC-E2E-030〜TC-E2E-036 |
| T-0030-04 | TC-E2E-040〜TC-E2E-042 |
| T-0030-05 | TC-E2E-050〜TC-E2E-052 |
| T-0030-06 | TC-DBG-001〜TC-DBG-070 |
| T-0030-07 | TC-PERF-001〜TC-PERF-023 |

---

## 7. テスト実行環境

### 7.1 必要な環境

- **Node.js**: 18.x以上
- **pnpm**: 9.x以上
- **Playwright**: 1.57以上
- **ブラウザ**: Chromium（Playwright付属）

### 7.2 テスト実行コマンド

```bash
# E2Eテスト実行（全て）
pnpm test:e2e

# E2Eテスト実行（UI付き）
pnpm test:e2e:ui

# E2Eテスト実行（ブラウザ表示）
pnpm test:e2e:headed

# テストレポート表示
pnpm test:e2e:report

# ユニットテスト実行
pnpm test
```

### 7.3 CI/CD設定

- **並列実行**: 本番環境では`workers: 1`で順次実行
- **リトライ**: 失敗時は2回までリトライ
- **タイムアウト**: 各テストは30秒以内に完了

---

## 関連文書

- **タスク詳細**: [../../tasks/atelier-guild-rank/phase-4/TASK-0030.md](../../tasks/atelier-guild-rank/phase-4/TASK-0030.md)
- **要件定義書**: [requirements.md](requirements.md)
- **タスクノート**: [note.md](note.md)
- **データフロー設計**: [../../design/atelier-guild-rank/dataflow.md](../../design/atelier-guild-rank/dataflow.md)

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2026-01-18 | 1.0.0 | 初版作成 |
