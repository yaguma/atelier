# TASK-0226: AlchemyPreviewPanel è¦ä»¶å®šç¾©æ›¸

**ã‚¿ã‚¹ã‚¯ID**: TASK-0226
**ä½œæˆæ—¥**: 2026-01-10
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0

## 1. æ¦‚è¦

### 1.1 ç›®çš„
èª¿åˆãƒ•ã‚§ãƒ¼ã‚ºã«ãŠã„ã¦ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒé¸æŠã—ãŸãƒ¬ã‚·ãƒ”ã¨ç´ æã‹ã‚‰èª¿åˆçµæœã‚’äº‹å‰ã«ç¢ºèªã§ãã‚‹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‘ãƒãƒ«ã‚’æä¾›ã™ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯èª¿åˆå®Ÿè¡Œå‰ã«çµæœã‚’æŠŠæ¡ã—ã€ã‚ˆã‚Šæˆ¦ç•¥çš„ãªç´ æé¸æŠãŒå¯èƒ½ã«ãªã‚‹ã€‚

### 1.2 ã‚¹ã‚³ãƒ¼ãƒ—
- èª¿åˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã®è¡¨ç¤º
- äºˆæ¸¬å“è³ªã®è¦–è¦šåŒ–
- é¸æŠç´ æãƒªã‚¹ãƒˆã®è¡¨ç¤º
- ç¶™æ‰¿ç‰¹æ€§ã®è¡¨ç¤º
- èª¿åˆå¯å¦ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°æ©Ÿèƒ½

## 2. æ©Ÿèƒ½è¦ä»¶ï¼ˆEARSè¨˜æ³•ï¼‰

### 2.1 ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆUbiquitousï¼‰

**REQ-226-001**: [Ubiquitous] ã‚·ã‚¹ãƒ†ãƒ ã¯ã€AlchemyPreviewPanelã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é€šã˜ã¦èª¿åˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã‚’è¡¨ç¤ºã§ãã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-002**: [Ubiquitous] ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‘ãƒãƒ«ã¯ã€ãƒ¬ã‚·ãƒ”åã€äºˆæ¸¬å“è³ªã€é¸æŠç´ æãƒªã‚¹ãƒˆã€ç¶™æ‰¿ç‰¹æ€§ã€èª¿åˆå¯å¦ã‚’è¡¨ç¤ºã™ã‚‹é ˜åŸŸã‚’æŒã¤ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-003**: [Ubiquitous] ãƒ‘ãƒãƒ«ã‚µã‚¤ã‚ºã¯å¹…250pxã€é«˜ã•350pxã‚’æ¨™æº–ã¨ã—ã€Phaserã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦å®Ÿè£…ã•ã‚Œã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.2 ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¨­å®šï¼ˆEvent-drivenï¼‰

**REQ-226-004**: [Event-driven] `setPreview(preview)` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã‚’è§£æã—ã€å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é©åˆ‡ãªå†…å®¹ã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-005**: [Event-driven] `setPreview(null)` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ç©ºã®åˆæœŸçŠ¶æ…‹ï¼ˆã€Œãƒ¬ã‚·ãƒ”ã‚’é¸æŠã—ã¦ãã ã•ã„ã€ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-006**: [Event-driven] ãƒ¬ã‚·ãƒ”åãŒè¨­å®šã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ‘ãƒãƒ«ä¸Šéƒ¨ã«ãƒ¬ã‚·ãƒ”åã‚’é‡‘è‰²ï¼ˆ#ffd700ï¼‰ã§è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.3 å“è³ªè¡¨ç¤ºï¼ˆState-drivenï¼‰

**REQ-226-007**: [State-driven] äºˆæ¸¬å“è³ªãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯å“è³ªåã‚’ãƒ†ã‚­ã‚¹ãƒˆã§è¡¨ç¤ºã—ã€å“è³ªãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸè‰²ã§è£…é£¾ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-008**: [State-driven] å“è³ªã‚²ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯6æ®µéšã®å“è³ªãƒ¬ãƒ™ãƒ«ï¼ˆpoor, normal, good, rare, epic, legendaryï¼‰ã«å¿œã˜ãŸå¡—ã‚Šã¤ã¶ã—å¹…ã§ã‚²ãƒ¼ã‚¸ã‚’æç”»ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

å“è³ªã‚«ãƒ©ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°:
| å“è³ª | ã‚«ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ | èª¬æ˜ |
|------|--------------|------|
| legendary | #ffd700 | é‡‘è‰² |
| epic | #a335ee | ç´«è‰² |
| rare | #0070dd | é’è‰² |
| good | #1eff00 | ç·‘è‰² |
| normal | #ffffff | ç™½è‰² |
| poor | #9d9d9d | ç°è‰² |

### 2.4 ç´ æãƒªã‚¹ãƒˆè¡¨ç¤ºï¼ˆState-drivenï¼‰

**REQ-226-009**: [State-driven] ç´ æãŒé¸æŠã•ã‚Œã¦ã„ã‚‹é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯MaterialViewã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ä½¿ç”¨ã—ã¦ç´ æã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-010**: [State-driven] ç´ æãŒ5ã¤ä»¥ä¸Šé¸æŠã•ã‚Œã¦ã„ã‚‹é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯æœ€åˆã®4ã¤ã‚’ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤ºã—ã€æ®‹ã‚Šã‚’ã€Œ+N moreã€å½¢å¼ã§è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-011**: [State-driven] ç´ æãŒé¸æŠã•ã‚Œã¦ã„ãªã„é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œç´ æã‚’é¸æŠã—ã¦ãã ã•ã„ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.5 ç‰¹æ€§è¡¨ç¤ºï¼ˆState-drivenï¼‰

**REQ-226-012**: [State-driven] ç¶™æ‰¿ç‰¹æ€§ãŒå­˜åœ¨ã™ã‚‹é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯æœ€å¤§3ã¤ã®ç‰¹æ€§ã‚’ãƒªã‚¹ãƒˆå½¢å¼ã§è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-013**: [State-driven] ç¶™æ‰¿ç‰¹æ€§ãŒå­˜åœ¨ã—ãªã„é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œç¶™æ‰¿ç‰¹æ€§ãªã—ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.6 èª¿åˆå¯å¦ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆState-drivenï¼‰

**REQ-226-014**: [State-driven] `canCraft`ãŒtrueã®é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œèª¿åˆå¯èƒ½ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç·‘è‰²ã§è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-015**: [State-driven] `missingMaterials`é…åˆ—ã«è¦ç´ ãŒå­˜åœ¨ã™ã‚‹é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œç´ æä¸è¶³ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’èµ¤è‰²ã§è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-016**: [State-driven] ãƒ¬ã‚·ãƒ”ãŒæœªé¸æŠã¾ãŸã¯åˆ¤å®šå¾…ã¡ã®é–“ã€ã‚·ã‚¹ãƒ†ãƒ ã¯ã€Œå¾…æ©Ÿä¸­ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç°è‰²ã§è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.7 ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ï¼ˆEvent-drivenï¼‰

**REQ-226-017**: [Event-driven] `addMaterial(material)` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç´ æãƒªã‚¹ãƒˆã«æ–°ã—ã„ç´ æã‚’è¿½åŠ ã—ã€è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-018**: [Event-driven] `removeMaterial(material)` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç´ æãƒªã‚¹ãƒˆã‹ã‚‰è©²å½“ç´ æã‚’å‰Šé™¤ã—ã€è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-019**: [Event-driven] `clearMaterials()` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç´ æãƒªã‚¹ãƒˆã‚’ã™ã¹ã¦ã‚¯ãƒªã‚¢ã—ã€ç©ºçŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.8 è¡¨ç¤ºåˆ¶å¾¡ï¼ˆEvent-drivenï¼‰

**REQ-226-020**: [Event-driven] `setVisible(visible)` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ‘ãƒãƒ«å…¨ä½“ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**REQ-226-021**: [Event-driven] `setEnabled(enabled)` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ‘ãƒãƒ«ã®æœ‰åŠ¹/ç„¡åŠ¹çŠ¶æ…‹ã‚’åˆ‡ã‚Šæ›¿ãˆã€ç„¡åŠ¹æ™‚ã¯é€æ˜åº¦ã‚’0.5ã«è¨­å®šã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 2.9 ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆEvent-drivenï¼‰

**REQ-226-022**: [Event-driven] `destroy()` ãŒå‘¼ã³å‡ºã•ã‚ŒãŸã¨ãã€ã‚·ã‚¹ãƒ†ãƒ ã¯ã™ã¹ã¦ã®MaterialViewã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨Phaserã‚³ãƒ³ãƒ†ãƒŠã‚’é©åˆ‡ã«ç ´æ£„ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

## 3. éæ©Ÿèƒ½è¦ä»¶

### 3.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

**NFR-226-001**: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°å‡¦ç†ã¯16msä»¥å†…ã«å®Œäº†ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ï¼ˆ60FPSç¶­æŒï¼‰ã€‚

**NFR-226-002**: MaterialViewã®ç”Ÿæˆãƒ»ç ´æ£„ã¯å¿…è¦æœ€å°é™ã«æŠ‘ãˆã€å¯èƒ½ãªå ´åˆã¯å†åˆ©ç”¨ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**NFR-226-003**: ç´ æå¤‰æ›´æ™‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé…å»¶ã‚’æ„Ÿã˜ãªã„ç¨‹åº¦ï¼ˆ100msä»¥å†…ï¼‰ã«å®Œäº†ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 3.2 ä¿å®ˆæ€§

**NFR-226-004**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯IAlchemyPreviewPanelã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«æº–æ‹ ã—ã€ãƒ†ã‚¹ãƒˆå¯èƒ½ãªè¨­è¨ˆã¨ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**NFR-226-005**: å“è³ªã‚«ãƒ©ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°ã¯å®šæ•°ã¨ã—ã¦å¤–éƒ¨åŒ–ã—ã€å¤‰æ›´ãŒå®¹æ˜“ãªæ§‹é€ ã¨ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**NFR-226-006**: å„UIã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ç‹¬ç«‹ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã§æ§‹ç¯‰ã—ã€å¤‰æ›´å½±éŸ¿ç¯„å›²ã‚’é™å®šã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

### 3.3 ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£

**NFR-226-007**: å“è³ªæƒ…å ±ã¯è‰²ã¨æ–‡å­—ã®ä¸¡æ–¹ã§è¡¨ç¾ã—ã€è‰²è¦šç‰¹æ€§ã«é…æ…®ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**NFR-226-008**: ç©ºçŠ¶æ…‹ã‚„æœªé¸æŠçŠ¶æ…‹ã§ã‚‚é©åˆ‡ãªã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

**NFR-226-009**: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã¯çµµæ–‡å­—ã¨ãƒ†ã‚­ã‚¹ãƒˆã®çµ„ã¿åˆã‚ã›ã§ç›´æ„Ÿçš„ã«çŠ¶æ…‹ã‚’ä¼ãˆã‚‹ã‚‚ã®ã¨ã™ã‚‹ã€‚

## 4. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

### 4.1 AlchemyPreviewå‹

```typescript
/**
 * èª¿åˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±
 *
 * èª¿åˆçµæœã®äºˆæ¸¬æƒ…å ±ã‚’ä¿æŒã™ã‚‹ã€‚
 * ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‘ãƒãƒ«ã®è¡¨ç¤ºã«ä½¿ç”¨ã•ã‚Œã‚‹ã€‚
 */
export interface AlchemyPreview {
  /** é¸æŠä¸­ã®ãƒ¬ã‚·ãƒ”ã‚«ãƒ¼ãƒ‰ */
  recipe: IRecipeCard;

  /** é¸æŠã•ã‚ŒãŸç´ æãƒªã‚¹ãƒˆ */
  materials: Material[];

  /**
   * äºˆæ¸¬å“è³ª
   * 'legendary' | 'epic' | 'rare' | 'good' | 'normal' | 'poor'
   */
  predictedQuality: string;

  /** ç¶™æ‰¿ã•ã‚Œã‚‹ç‰¹æ€§ãƒªã‚¹ãƒˆ */
  predictedTraits: string[];

  /** èª¿åˆå¯èƒ½ãƒ•ãƒ©ã‚° */
  canCraft: boolean;

  /** ä¸è¶³ã—ã¦ã„ã‚‹ç´ æåãƒªã‚¹ãƒˆ */
  missingMaterials: string[];
}
```

### 4.2 AlchemyPreviewPanelOptionså‹

```typescript
/**
 * AlchemyPreviewPanelä½œæˆã‚ªãƒ—ã‚·ãƒ§ãƒ³
 */
export interface AlchemyPreviewPanelOptions {
  /** Xåº§æ¨™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0ï¼‰ */
  x?: number;

  /** Yåº§æ¨™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0ï¼‰ */
  y?: number;

  /** å¹…ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 250ï¼‰ */
  width?: number;

  /** é«˜ã•ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 350ï¼‰ */
  height?: number;
}
```

### 4.3 IAlchemyPreviewPanelã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
import Phaser from 'phaser';
import { Material } from '@domain/material/MaterialEntity';

/**
 * èª¿åˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‘ãƒãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 *
 * èª¿åˆçµæœã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã‚’æ‹…å½“ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€‚
 * é¸æŠä¸­ã®ãƒ¬ã‚·ãƒ”ã¨ç´ æã‹ã‚‰äºˆæ¸¬çµæœã‚’è¡¨ç¤ºã™ã‚‹ã€‚
 */
export interface IAlchemyPreviewPanel {
  /** Phaserã‚³ãƒ³ãƒ†ãƒŠã¸ã®å‚ç…§ï¼ˆèª­ã¿å–ã‚Šå°‚ç”¨ï¼‰ */
  readonly container: Phaser.GameObjects.Container;

  // ========================================
  // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¨­å®š
  // ========================================

  /**
   * ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã‚’è¨­å®šã™ã‚‹
   * @param preview ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ï¼ˆnullã§åˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹ï¼‰
   */
  setPreview(preview: AlchemyPreview | null): void;

  /**
   * ç¾åœ¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±ã‚’å–å¾—ã™ã‚‹
   * @returns ç¾åœ¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æƒ…å ±
   */
  getPreview(): AlchemyPreview | null;

  // ========================================
  // ç´ ææ“ä½œï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ç”¨ï¼‰
  // ========================================

  /**
   * ç´ æã‚’è¿½åŠ ã™ã‚‹
   * ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç´ æãƒªã‚¹ãƒˆã«ç´ æã‚’è¿½åŠ ã—ã€è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã€‚
   * @param material è¿½åŠ ã™ã‚‹ç´ æ
   */
  addMaterial(material: Material): void;

  /**
   * ç´ æã‚’å‰Šé™¤ã™ã‚‹
   * ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç´ æãƒªã‚¹ãƒˆã‹ã‚‰ç´ æã‚’å‰Šé™¤ã—ã€è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã€‚
   * @param material å‰Šé™¤ã™ã‚‹ç´ æ
   */
  removeMaterial(material: Material): void;

  /**
   * ã™ã¹ã¦ã®ç´ æã‚’ã‚¯ãƒªã‚¢ã™ã‚‹
   * ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç´ æãƒªã‚¹ãƒˆã‚’ç©ºã«ã—ã€è¡¨ç¤ºã‚’æ›´æ–°ã™ã‚‹ã€‚
   */
  clearMaterials(): void;

  // ========================================
  // è¡¨ç¤ºåˆ¶å¾¡
  // ========================================

  /**
   * è¡¨ç¤ºãƒ»éè¡¨ç¤ºã‚’è¨­å®šã™ã‚‹
   * @param visible true: è¡¨ç¤ºã€false: éè¡¨ç¤º
   */
  setVisible(visible: boolean): void;

  /**
   * æœ‰åŠ¹ãƒ»ç„¡åŠ¹çŠ¶æ…‹ã‚’è¨­å®šã™ã‚‹
   * @param enabled true: æœ‰åŠ¹ã€false: ç„¡åŠ¹ï¼ˆã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆï¼‰
   */
  setEnabled(enabled: boolean): void;

  // ========================================
  // ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
  // ========================================

  /**
   * ãƒªã‚½ãƒ¼ã‚¹ã‚’ç ´æ£„ã™ã‚‹
   * ã™ã¹ã¦ã®å­è¦ç´ ã¨MaterialViewã‚’é©åˆ‡ã«ç ´æ£„ã™ã‚‹ã€‚
   */
  destroy(): void;
}
```

## 5. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

### 5.1 ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/game/ui/alchemy/
â”œâ”€â”€ IAlchemyPreviewPanel.ts      # ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
â”œâ”€â”€ AlchemyPreviewPanel.ts       # å®Ÿè£…
â””â”€â”€ AlchemyPreviewPanelConstants.ts  # å®šæ•°å®šç¾©ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

tests/unit/game/ui/alchemy/
â””â”€â”€ AlchemyPreviewPanel.test.ts  # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
```

### 5.2 ãƒ‘ãƒãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ğŸ”® èª¿åˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼              â”‚  ã‚¿ã‚¤ãƒˆãƒ« (15px from top)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        [ãƒ¬ã‚·ãƒ”å]                 â”‚  ãƒ¬ã‚·ãƒ”å (45px from top, é‡‘è‰²)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  äºˆæ¸¬å“è³ª                         â”‚  ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ãƒ™ãƒ« (80px)
â”‚  [RARE]                          â”‚  å“è³ªãƒ†ã‚­ã‚¹ãƒˆ (è‰²åˆ†ã‘)
â”‚  [â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”]          â”‚  å“è³ªã‚²ãƒ¼ã‚¸ (200pxå¹…)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä½¿ç”¨ç´ æ                         â”‚  ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ãƒ™ãƒ« (150px)
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ç´ æ1â”‚ â”‚ç´ æ2â”‚                   â”‚  MaterialView (compact)
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜                   â”‚  2åˆ—ã‚°ãƒªãƒƒãƒ‰
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ç´ æ3â”‚ â”‚ç´ æ4â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜                   â”‚
â”‚  +N more                         â”‚  è¶…éè¡¨ç¤º (5ã¤ä»¥ä¸Šã®å ´åˆ)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¶™æ‰¿ç‰¹æ€§                         â”‚  ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ãƒ™ãƒ« (260px)
â”‚  â€¢ ç‰¹æ€§1                         â”‚
â”‚  â€¢ ç‰¹æ€§2                         â”‚  ãƒªã‚¹ãƒˆå½¢å¼ (æœ€å¤§3ã¤)
â”‚  â€¢ ç‰¹æ€§3                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      âœ… èª¿åˆå¯èƒ½                  â”‚  ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
â”‚      âŒ ç´ æä¸è¶³                  â”‚  (é«˜ã•-30pxã€ä¸­å¤®é…ç½®)
â”‚      â³ å¾…æ©Ÿä¸­                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 ä¾å­˜é–¢ä¿‚

```mermaid
graph TD
    A[AlchemyPreviewPanel] --> B[IAlchemyPreviewPanel]
    A --> C[MaterialView]
    A --> D[Phaser.GameObjects.Container]
    A --> E[AlchemyPreview]
    E --> F[IRecipeCard]
    E --> G[Material]
    C --> H[IMaterialView]
    C --> G
```

### 5.4 å†…éƒ¨æ§‹é€ 

```typescript
class AlchemyPreviewPanel implements IAlchemyPreviewPanel {
  // ãƒ‘ãƒ–ãƒªãƒƒã‚¯
  readonly container: Phaser.GameObjects.Container;

  // ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ - çŠ¶æ…‹
  private scene: Phaser.Scene;
  private preview: AlchemyPreview | null;

  // ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ - UIè¦ç´ 
  private background: Phaser.GameObjects.Graphics;
  private titleText: Phaser.GameObjects.Text;
  private recipeNameText: Phaser.GameObjects.Text;
  private qualitySection: Phaser.GameObjects.Container;
  private materialsSection: Phaser.GameObjects.Container;
  private traitsSection: Phaser.GameObjects.Container;
  private statusIndicator: Phaser.GameObjects.Container;
  private materialViews: MaterialView[];

  // ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ - æ§‹ç¯‰ãƒ¡ã‚½ãƒƒãƒ‰
  private create(): void;
  private createQualitySection(): void;
  private createMaterialsSection(): void;
  private createTraitsSection(): void;
  private createStatusIndicator(): void;

  // ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ - æ›´æ–°ãƒ¡ã‚½ãƒƒãƒ‰
  private showEmptyState(): void;
  private updateQualityDisplay(quality: string): void;
  private updateMaterialsList(materials: Material[]): void;
  private updateTraitsList(traits: string[]): void;
  private updateStatusIndicator(canCraft: boolean, missing: string[]): void;
  private clearSection(section: Container, keepFirst: number): void;
}
```

## 6. å—ã‘å…¥ã‚ŒåŸºæº–

### 6.1 æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆåŸºæº–

| ID | ãƒ†ã‚¹ãƒˆé …ç›® | æœŸå¾…çµæœ |
|----|-----------|----------|
| AC-001 | `setPreview(preview)` ã‚’å‘¼ã³å‡ºã™ | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-002 | `setPreview(null)` ã‚’å‘¼ã³å‡ºã™ | ç©ºçŠ¶æ…‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-003 | `getPreview()` ã‚’å‘¼ã³å‡ºã™ | ç¾åœ¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¿”ã•ã‚Œã‚‹ |
| AC-004 | å“è³ªãŒ'rare'ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | é’è‰²(#0070dd)ã§å“è³ªãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-005 | å“è³ªãŒ'legendary'ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | é‡‘è‰²(#ffd700)ã§å“è³ªãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-006 | 3ã¤ã®ç´ æã‚’å«ã‚€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | 3ã¤ã®MaterialViewãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-007 | 6ã¤ã®ç´ æã‚’å«ã‚€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | 4ã¤ã®MaterialViewã¨ã€Œ+2 moreã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-008 | 2ã¤ã®ç‰¹æ€§ã‚’å«ã‚€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | 2ã¤ã®ç‰¹æ€§ãŒãƒªã‚¹ãƒˆè¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-009 | `canCraft=true` ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | ã€Œèª¿åˆå¯èƒ½ã€ãŒç·‘è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-010 | `missingMaterials=['ç´ æA']` ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¨­å®š | ã€Œç´ æä¸è¶³ã€ãŒèµ¤è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹ |
| AC-011 | `addMaterial(material)` ã‚’å‘¼ã³å‡ºã™ | ç´ æãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œè¡¨ç¤ºæ›´æ–°ã•ã‚Œã‚‹ |
| AC-012 | `removeMaterial(material)` ã‚’å‘¼ã³å‡ºã™ | ç´ æãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤ã•ã‚Œè¡¨ç¤ºæ›´æ–°ã•ã‚Œã‚‹ |
| AC-013 | `clearMaterials()` ã‚’å‘¼ã³å‡ºã™ | ç´ æãƒªã‚¹ãƒˆãŒã‚¯ãƒªã‚¢ã•ã‚Œç©ºçŠ¶æ…‹ã«ãªã‚‹ |
| AC-014 | `setVisible(false)` ã‚’å‘¼ã³å‡ºã™ | ãƒ‘ãƒãƒ«ãŒéè¡¨ç¤ºã«ãªã‚‹ |
| AC-015 | `setEnabled(false)` ã‚’å‘¼ã³å‡ºã™ | ãƒ‘ãƒãƒ«ãŒã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹ |
| AC-016 | `destroy()` ã‚’å‘¼ã³å‡ºã™ | ã™ã¹ã¦ã®ãƒªã‚½ãƒ¼ã‚¹ãŒç ´æ£„ã•ã‚Œã‚‹ |

### 6.2 çµ±åˆãƒ†ã‚¹ãƒˆåŸºæº–

| ID | ãƒ†ã‚¹ãƒˆé …ç›® | æœŸå¾…çµæœ |
|----|-----------|----------|
| IT-001 | MaterialViewã¨ã®é€£æº | MaterialViewãŒã‚³ãƒ³ãƒ‘ã‚¯ãƒˆãƒ¢ãƒ¼ãƒ‰ã§æ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ |
| IT-002 | ç´ æè¿½åŠ ãƒ»å‰Šé™¤ã®é€£ç¶šæ“ä½œ | é«˜é€Ÿãªæ“ä½œã§ã‚‚è¡¨ç¤ºãŒæ­£ã—ãæ›´æ–°ã•ã‚Œã‚‹ |
| IT-003 | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆ | ç•°ãªã‚‹ãƒ¬ã‚·ãƒ”ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒæ­£ã—ãåˆ‡ã‚Šæ›¿ã‚ã‚‹ |

### 6.3 éæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆåŸºæº–

| ID | ãƒ†ã‚¹ãƒˆé …ç›® | æœŸå¾…çµæœ |
|----|-----------|----------|
| NFT-001 | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | 16msä»¥å†…ã«å‡¦ç†å®Œäº† |
| NFT-002 | ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ç¢ºèª | destroyå¾Œã«ãƒªã‚½ãƒ¼ã‚¹ãŒè§£æ”¾ã•ã‚Œã‚‹ |
| NFT-003 | ç©ºçŠ¶æ…‹ã®è¡¨ç¤º | ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ |

## 7. å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- ã‚¿ã‚¹ã‚¯å®šç¾©: `docs/tasks/atelier-guild-rank-phaser/TASK-0226.md`
- ã‚¿ã‚¹ã‚¯ãƒãƒ¼ãƒˆ: `docs/implements/atelier-guild-rank-phaser/TASK-0226/note.md`
- UIè¨­è¨ˆæ¦‚è¦: `docs/design/atelier-guild-rank-phaser/ui-design/overview.md`
- MaterialViewè¨­è¨ˆ: `docs/tasks/atelier-guild-rank-phaser/TASK-0199.md`
- QuestPanelå®Ÿè£…ï¼ˆå‚è€ƒï¼‰: `src/game/ui/quest/QuestPanel.ts`

## 8. å¤‰æ›´å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|-----------|------|----------|
| 1.0 | 2026-01-10 | åˆç‰ˆä½œæˆ |
