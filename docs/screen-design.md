# ATELIER GUILD - 画面設計書

## 概要

| 項目 | 内容 |
|------|------|
| プロジェクト名 | ATELIER GUILD (錬金術師ギルド) |
| 解像度 | 1280 x 720 |
| フレームワーク | Phaser 3 |
| レターボックス | 上下にダークネイビー (#2C3E50) |

---

## 画面遷移図

```
[タイトル画面] --新規ゲーム--> [メインゲーム画面]
                                    |
                    フェーズ自由遷移（タブUI切り替え）
                    +------+------+------+------+
                    |      |      |      |      |
                  [依頼] [採取] [調合] [納品]
                    ^  ↔  ^  ↔  ^  ↔  ^
                    |      |      |      |
                    +------+------+------+
                              |
                    [日終了] ←── 明示的ボタン or AP超過自動進行
                       |
                    翌日開始 → いずれかのフェーズで続行
```

### フェーズ遷移ルール
- 全フェーズ間で自由に遷移可能（タブクリックで即座に切り替え）
- 採取セッション中のフェーズ切り替え時は中断確認ダイアログを表示
- 日終了は「日終了」ボタンによる明示的操作、またはAP超過による自動進行

---

## 1. タイトル画面 (TitleScene)

### レイアウト

```
+--------------------------------------------------+
|           (ダークネイビー レターボックス)            |
+--------------------------------------------------+
|                                                    |
|              ATELIER GUILD                         |
|              錬金術師ギルド                          |
|                                                    |
|              [  新規ゲーム  ]                       |
|              [コンティニュー]  (無効時グレーアウト)    |
|              [    設定     ]                       |
|                                                    |
|                              Version 1.0.0         |
+--------------------------------------------------+
|           (ダークネイビー レターボックス)            |
+--------------------------------------------------+
```

### 要素仕様

| 要素 | 仕様 |
|------|------|
| タイトル (メイン) | "ATELIER GUILD", フォント色: #8B4513, 太字, 中央揃え |
| タイトル (サブ) | "錬金術師ギルド", フォント色: #A0522D, 中央揃え |
| 新規ゲームボタン | 背景: #8B4513, テキスト: 白, 角丸8px, クリック→MainScene遷移 |
| コンティニューボタン | セーブなし時: 背景 #C0A882, 不透明度60%, クリック不可 |
| 設定ボタン | 背景: #E07020 (オレンジ), テキスト: 白, クリック→設定ダイアログ |
| バージョン | "Version 1.0.0", 右下, フォント色: #999999, 8px |

---

## 2. メインゲーム画面 共通レイアウト (MainScene)

### レイアウト構成

```
+--------------------------------------------------+
|  (レターボックス)                                   |
+--------------------------------------------------+
| [A] ヘッダーバー                                    |
| ランク: E [ゲージ] | 残り: 30日 | G 100G | AP: 3/3  |
+------+-------------------------------------------+
| [B]  | [C] メインコンテンツエリア                    |
| サイド|     (フェーズ別に内容が変化)                  |
| バー  |                                            |
|      |                                            |
| 受注  |                                            |
| 依頼  |                                            |
| 素材  |                                            |
| (0)  |                                            |
| 完成品|                                            |
| (0)  |                                            |
| 保管  |                                            |
| 0/99 |                                            |
|[ショップ]|                                          |
+------+-------------------------------------------+
| [D] フッターバー                                    |
| [依頼|採取|調合|納品](タブ) [手札カード] [日終了]     |
+--------------------------------------------------+
```

### A. ヘッダーバー

| 要素 | 仕様 |
|------|------|
| 背景色 | #37474F |
| ランク | "ランク: E" + ゲージバー, 白文字 |
| 残り日数 | "残り: 30日", 白文字 |
| ゴールド | "G 100G", 黄色 (#FFD700) |
| AP | "3/3 AP", 青色 (#64B5F6) |
| AP超過表示 | AP超過による自動日進行発生時、残り日数を赤色で警告表示 |

### B. 左サイドバー

| 要素 | 仕様 |
|------|------|
| 背景色 | #37474F |
| 幅 | 約140px |
| 受注依頼 | 折りたたみセクション |
| 素材 | 折りたたみセクション, 数量表示 |
| 完成品 | 折りたたみセクション, 数量表示 |
| 保管 | "保管: 0/99" |
| ショップ | ボタン, 紫色 (#5C6BC0) |

### C. メインコンテンツエリア

| 要素 | 仕様 |
|------|------|
| 背景色 | #FFF8E1 (クリーム) |
| 内容 | フェーズごとに変化（タブ切り替えで即座に表示切替） |

### D. フッターバー（PhaseTabUI統合）

| 要素 | 仕様 |
|------|------|
| 背景色 | #455A64 |
| フェーズタブ | 4つのタブ（依頼・採取・調合・納品）をクリックで切り替え |
| タブ（アクティブ） | 対応フェーズカラーで背景を強調、白テキスト、太字 |
| タブ（非アクティブ） | ダークグレー背景 (#546E7A), 灰白テキスト |
| 手札カードスロット | 6枠, カード枠表示 |
| 日終了ボタン | 紫色 (#5C6BC0), 白テキスト "日終了", 残APを破棄して翌日へ |

#### フェーズタブ配色

| フェーズ | タブアクティブ色 | ラベル |
|---------|----------------|-------|
| 依頼 | #FFB300 (アンバー) | 依頼 |
| 採取 | #66BB6A (グリーン) | 採取 |
| 調合 | #AB47BC (パープル) | 調合 |
| 納品 | #42A5F5 (ブルー) | 納品 |

---

## 3. 依頼受注フェーズ (QUEST_ACCEPT)

### メインコンテンツ

依頼は「掲示板」と「訪問者」の2種類から受注可能。

```
+-------------------------------------------+
|  依頼受注                                  |
|  [掲示板タブ] [訪問者タブ]                  |
|                                            |
|  --- 掲示板表示時 ---                       |
|  +----------+ +----------+ +----------+   |
|  | 冒険者    | | 村人      | | 商人     |   |
|  | 冒険者から| | 村人から  | | 商人から  |   |
|  | の依頼    | | の依頼    | | の依頼    |   |
|  |          | |          | |          |   |
|  | 条件:1個 | | 条件:1個 | | 条件:2個 |   |
|  | 84貢/48G | | 95貢/57G | | 50貢/32G |   |
|  | 期限:6日 | | 期限:5日 | | 期限:3日 |   |
|  +----------+ +----------+ +----------+   |
|                                            |
|  受注済み: 1/3                              |
+-------------------------------------------+
```

### 掲示板と訪問者の仕様

| 要素 | 仕様 |
|------|------|
| 掲示板タブ | 掲示板依頼を一覧表示（累積型、期限切れで自動削除） |
| 訪問者タブ | 訪問依頼を一覧表示（数日ごとに更新・入れ替え） |
| 受注上限 | 同時受注3件まで。上限時は受注不可メッセージを表示 |

### 依頼カード仕様

| 要素 | 仕様 |
|------|------|
| サイズ | 約220 x 180px |
| 背景色 | 白 (#FFFFFF) |
| 枠線 | 金色 (#FFD700), 2px |
| 角丸 | 8px |
| 依頼主名 | 太字, 16px, #333333 |
| 依頼元バッジ | 掲示板: "掲示板" (#795548), 訪問者: "訪問" (#FF7043) |
| 説明文 | 12px, #777777 |
| 条件 | 黄色太字 (#FFB300), 12px |
| 報酬 | "貢献度 / ゴールド", 12px |
| 期限 | 灰色 (#666666), 12px |
| インタラクション | クリックで詳細表示→受注/閉じる, ホバーでハイライト |

---

## 4. 採取フェーズ (GATHERING) - 2段階構成

採取フェーズは「場所選択」→「ドラフト採取」の2段階で構成される。

### 4.1 場所選択ステージ (LocationSelect)

```
+-------------------------------------------+
|  採取 - 場所選択                            |
|                                            |
|  +------------------+ +------------------+ |
|  | 近くの森          | | 清流の泉         | |
|  |                  | |                  | |
|  | 移動AP: 1        | | 移動AP: 2        | |
|  | 素材:            | | 素材:            | |
|  |  薬草(高)        | |  清水(高)        | |
|  |  毒キノコ(中)    | |  蛍石(低)        | |
|  |  木の実(中)      | |  苔(中)          | |
|  |                  | |                  | |
|  | [採取開始]       | | [採取開始]       | |
|  +------------------+ +------------------+ |
|                                            |
|  +------------------+                      |
|  | 霧の洞窟          |                      |
|  |  (カード未所持)   |                      |
|  |  グレーアウト      |                      |
|  +------------------+                      |
+-------------------------------------------+
```

#### 場所カード仕様

| 要素 | 仕様 |
|------|------|
| サイズ | 約240 x 220px |
| 背景色 | 白 (#FFFFFF) |
| 枠線 | 緑色 (#66BB6A), 2px |
| 角丸 | 8px |
| 場所名 | 太字, 16px, #333333 |
| 移動APコスト | "移動AP: N", 青色 (#64B5F6), 太字 |
| 素材プレビュー | 採取可能素材リスト + 出現率（高/中/低） |
| 出現率表示 | 高: 緑(#66BB6A), 中: 黄(#FFB300), 低: 赤(#EF5350) |
| 採取開始ボタン | 背景: #66BB6A, テキスト: 白 |
| 未所持カード | 背景: グレー (#9E9E9E), 不透明度40%, クリック不可 |
| カードなし時 | "採取地カードがありません" + ショップへの誘導メッセージ |

### 4.2 ドラフト採取ステージ (DraftSession)

```
+-------------------------------------------+
|  採取 - 近くの森                            |
|  残り選択回数: 2/2                          |
|                                            |
|    +------+  +------+  +------+            |
|    |[D]   |  |[D]   |  |[D]   |           |
|    | 薬草  |  | 清水  |  | 木の実 |         |
|    +------+  +------+  +------+            |
|                                            |
|    +------+  +------+  +------+            |
|    |      |  |      |  |      |            |
|    | (空) |  | (空) |  | (空) |            |
|    +------+  +------+  +------+            |
|                                            |
|  獲得素材:                                  |
|  [← 場所選択に戻る]                         |
+-------------------------------------------+
```

#### 素材カード仕様

| 要素 | 仕様 |
|------|------|
| サイズ | 約110 x 110px |
| 背景色 | 白 (#FFFFFF) |
| 枠線 | グレー (#BDBDBD), 1px |
| ランクバッジ | 右上, ダークグレー (#616161), 白文字 |
| アイコン | 中央, 素材に応じた画像 |
| 素材名 | 下部テキスト, 9px, #555555 |
| インタラクション | クリックで選択→下段スロットに移動 |

#### 選択ルール
- 残り選択回数: デッキ構成に依存 (初期値2)
- 素材選択で1減少
- 0で選択不可

#### 採取セッション中断

| 要素 | 仕様 |
|------|------|
| トリガー | ドラフト中にフェーズタブをクリック |
| ダイアログ | "採取を中断しますか？ 選択中の素材は破棄されます。" |
| 中断する | セッション破棄、場所選択に戻る、フェーズ切り替え実行 |
| キャンセル | フェーズ切り替えを中止、ドラフト続行 |

---

## 5. 調合フェーズ (ALCHEMY)

### メインコンテンツ

```
+-------------------------------------------+
|  調合                                      |
|                                            |
|  +---------------------------+             |
|  | 回復薬              AP: 1 |             |
|  |   薬草: 2                  |             |
|  |   清水: 1                  |             |
|  |          [調合する]        |             |
|  +---------------------------+             |
|                                            |
|  +---------------------------+             |
|  | 解毒剤              AP: 1 |             |
|  |   毒キノコ: 1              |             |
|  |   清水: 2                  |             |
|  |          [調合する]        |             |
|  +---------------------------+             |
+-------------------------------------------+
```

### レシピカード仕様

| 要素 | 仕様 |
|------|------|
| サイズ | 約280 x 100px |
| 背景色 | #37474F (ダークグレー) |
| 枠線 | 金色 (#FFD700), 2px |
| 角丸 | 8px |
| レシピ名 | 白文字, 太字, 14px |
| APコスト | 右上 "AP: N", 青色 (#64B5F6), 太字 |
| 素材リスト | 黄色 (#FFB300): 草系, 青色 (#64B5F6): 水系 |
| 調合ボタン | 背景: #AB47BC (パープル), テキスト: 白 |
| インタラクション | クリックで調合実行（AP超過時は確認ダイアログ） |
| 無効状態 | 素材不足時グレーアウト |

### 調合ロジック
- 所持素材を消費して完成品を生成
- 品質 = 素材品質の平均値 + ボーナス
- 調合にはAPを消費する（AP超過時は自動日進行が発生）

---

## 6. 納品フェーズ (DELIVERY)

### メインコンテンツ

```
+-------------------------------------------+
|  納品                                      |
|                                            |
|  (受注済み依頼一覧エリア)                    |
|                                            |
|                                            |
|  納品する依頼を選択してください               |
|  [ 納品する ]                               |
|                                            |
|  所持アイテム:                               |
+-------------------------------------------+
```

### 要素仕様

| 要素 | 仕様 |
|------|------|
| 依頼一覧 | 受注済み依頼カードを表示 |
| 指示テキスト | "納品する依頼を選択してください", 灰色 |
| 納品ボタン | 背景: #E65100, テキスト: 白, 太字 |
| 所持アイテム | 現在所持しているアイテム一覧 |

### 納品ロジック
1. 依頼を選択
2. 必要アイテムが揃っているか確認
3. 納品実行 → ゴールド + 貢献度獲得
4. アイテム消費

---

## 7. AP超過プレビューダイアログ

AP超過が発生する行動の確定後、実行前に表示される確認ダイアログ。

### レイアウト

```
+----------------------------------+
|     AP超過確認                    |
|                                  |
|  「近くの森で採取」を実行すると    |
|  APが超過し、日が進みます。       |
|                                  |
|  消費AP:   2                     |
|  現在AP:   1                     |
|  超過AP:   1                     |
|  ─────────────────               |
|  消費日数: 1日                    |
|  翌日AP:   2/3                   |
|                                  |
|  [ キャンセル ]  [ 実行する ]     |
+----------------------------------+
```

### 要素仕様

| 要素 | 仕様 |
|------|------|
| 背景 | 半透明黒オーバーレイ (alpha: 0.6) |
| ダイアログ背景 | 白 (#FFFFFF), 角丸 12px, 影付き |
| タイトル | "AP超過確認", 太字, 18px, #333333 |
| 説明文 | 14px, #555555 |
| 消費AP | 赤色 (#EF5350), 太字 |
| 翌日AP | 青色 (#64B5F6), 太字 |
| 消費日数 | オレンジ (#FF9800), 太字。2日以上の場合は赤色で強調 |
| キャンセルボタン | 背景: #9E9E9E, テキスト: 白 |
| 実行ボタン | 背景: #E65100, テキスト: 白, 太字 |

---

## 8. 日進行通知トースト

AP超過による自動日進行、または明示的な日終了時に表示される通知。

### レイアウト

```
+-----------------------------+
|  Day 2 → Day 3              |
|  残り: 28日  AP: 2/3        |
+-----------------------------+
```

### 要素仕様

| 要素 | 仕様 |
|------|------|
| 位置 | 画面上部中央 |
| 背景色 | #37474F, 角丸 8px, 影付き |
| テキスト | 白文字, 14px |
| AP表示 | 青色 (#64B5F6) |
| 表示時間 | 2秒間表示後フェードアウト |
| 複数日進行時 | "Day 2 → Day 4 (2日経過)" のように表示 |

---

## カラーパレット

| 用途 | 色コード | 説明 |
|------|---------|------|
| レターボックス | #2C3E50 | ダークネイビー |
| ヘッダー/サイドバー | #37474F | ダークグレー |
| フッター | #455A64 | ミディアムグレー |
| メインBG | #FFF8E1 | クリーム |
| ボタン (主) | #5C6BC0 | インディゴ |
| ゴールド | #FFD700 | 黄色 |
| AP | #64B5F6 | 青色 |
| 条件テキスト | #FFB300 | アンバー |
| カード枠 | #FFD700 | 金色 |
| タイトルブラウン | #8B4513 | ダークブラウン |
| 設定ボタン | #E07020 | オレンジ |
| 納品ボタン | #E65100 | ディープオレンジ |
| タブ (依頼) | #FFB300 | アンバー |
| タブ (採取) | #66BB6A | グリーン |
| タブ (調合) | #AB47BC | パープル |
| タブ (納品) | #42A5F5 | ブルー |
| 掲示板バッジ | #795548 | ブラウン |
| 訪問者バッジ | #FF7043 | ディープオレンジ |
| AP超過警告 | #EF5350 | レッド |
| 非アクティブタブ | #546E7A | ブルーグレー |

---

## ゲームフロー

### 基本フロー
- 各フェーズはタブUIで自由に遷移可能（固定順序なし）
- 採取・調合はAPを消費する行動
- AP超過時は自動的に日が進行する
- 明示的な「日終了」ボタンでも日を進められる

### 1日の流れ（例）
1. 依頼タブで掲示板・訪問者から依頼を受注
2. 採取タブで場所を選択し素材をドラフト採取（AP消費）
3. 調合タブでレシピに従い完成品を生成（AP消費）
4. 納品タブで依頼を完了し報酬を獲得
5. 「日終了」ボタンで翌日へ（またはAP超過で自動進行）

### AP超過自動日進行
- 採取・調合の行動でAPが0を超えて消費された場合
- 超過APに応じて1日以上が自動的に消費される
- 翌日のAPは MAX_AP - (超過分 % MAX_AP) に設定
- 各日の日終了処理（依頼期限更新、手札補充等）が順次実行される
- 残り日数が0以下になった場合はゲームオーバー

30日間でギルドランクアップを目指す。

作成日: 2026-02-20
更新日: 2026-02-20 (フェーズ自由遷移システム仕様を反映)
