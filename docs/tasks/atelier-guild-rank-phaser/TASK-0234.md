# TASK-0234: DeliveryContainerãƒ†ã‚¹ãƒˆ

**ã‚¿ã‚¹ã‚¯ID**: TASK-0234
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 3 - ãƒ•ã‚§ãƒ¼ã‚ºã‚³ãƒ³ãƒ†ãƒŠãƒ»ãƒ¡ã‚¤ãƒ³ç”»é¢å®Ÿè£…
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸ”µ *è¨­è¨ˆæ›¸ã«è¨˜è¼‰*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [overview.md](./overview.md)
- **UIè¨­è¨ˆ**: [ui-design/overview.md](../../design/atelier-guild-rank-phaser/ui-design/overview.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

DeliveryContaineré–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: TASK-0233
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0235

## å®Œäº†æ¡ä»¶

- [ ] ä¾é ¼ãƒªã‚¹ãƒˆè¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [ ] ç´å“å¯å¦åˆ¤å®šã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [ ] ç´å“æ“ä½œã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [ ] å ±é…¬è¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

---

## å®Ÿè£…è©³ç´°

### 1. RewardCardSelectorãƒ†ã‚¹ãƒˆ ğŸ”µ

**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `tests/unit/presentation/ui/reward/RewardCardSelector.test.ts`

```typescript
import { describe, it, expect, beforeEach, vi } from 'vitest';

describe('RewardCardSelector', () => {
  describe('åˆæœŸåŒ–', () => {
    it.skip('ã‚«ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆã‚’æ¸¡ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ãã‚‹', () => {
      // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆç¢ºèª
    });

    it.skip('ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¨ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // UIè¦ç´ ç¢ºèª
    });

    it.skip('ã‚¿ã‚¤ãƒˆãƒ«ãŒã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹', () => {
      // ã‚¿ã‚¤ãƒˆãƒ«è¨­å®šç¢ºèª
    });
  });

  describe('ã‚«ãƒ¼ãƒ‰è¡¨ç¤º', () => {
    it.skip('setCardsã§ã‚«ãƒ¼ãƒ‰ãŒæ›´æ–°ã•ã‚Œã‚‹', () => {
      // ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºç¢ºèª
    });

    it.skip('getCardsã§è¨­å®šã—ãŸã‚«ãƒ¼ãƒ‰ãŒå–å¾—ã§ãã‚‹', () => {
      // ã‚²ãƒƒã‚¿ãƒ¼ç¢ºèª
    });

    it.skip('ã‚«ãƒ¼ãƒ‰ãŒé †æ¬¡ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã§è¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª
    });
  });

  describe('ã‚«ãƒ¼ãƒ‰é¸æŠ', () => {
    it.skip('ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯ã§é¸æŠã•ã‚Œã‚‹', () => {
      // ã‚¯ãƒªãƒƒã‚¯é¸æŠç¢ºèª
    });

    it.skip('selectCardã§æŒ‡å®šã‚«ãƒ¼ãƒ‰ãŒé¸æŠã•ã‚Œã‚‹', () => {
      // ãƒ—ãƒ­ã‚°ãƒ©ãƒ é¸æŠç¢ºèª
    });

    it.skip('getSelectedCardã§é¸æŠä¸­ã®ã‚«ãƒ¼ãƒ‰ãŒå–å¾—ã§ãã‚‹', () => {
      // ã‚²ãƒƒã‚¿ãƒ¼ç¢ºèª
    });

    it.skip('é¸æŠã•ã‚ŒãŸã‚«ãƒ¼ãƒ‰ãŒãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã‚‹', () => {
      // ãƒã‚¤ãƒ©ã‚¤ãƒˆç¢ºèª
    });

    it.skip('åˆ¥ã®ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ã¨å‰ã®é¸æŠãŒè§£é™¤ã•ã‚Œã‚‹', () => {
      // é¸æŠåˆ‡ã‚Šæ›¿ãˆç¢ºèª
    });
  });

  describe('ç¢ºå®šãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«', () => {
    it.skip('confirmã§onSelectã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã‚‹', () => {
      // ç¢ºå®šã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¢ºèª
    });

    it.skip('ã‚«ãƒ¼ãƒ‰æœªé¸æŠæ™‚ã¯confirmãŒç„¡åŠ¹', () => {
      // æ¡ä»¶ãƒã‚§ãƒƒã‚¯ç¢ºèª
    });

    it.skip('cancelã§onCancelã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã‚‹', () => {
      // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¢ºèª
    });
  });

  describe('è¡¨ç¤ºåˆ¶å¾¡', () => {
    it.skip('show/hideã§è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆã§ãã‚‹', () => {
      // è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆç¢ºèª
    });

    it.skip('destroyã§ãƒªã‚½ãƒ¼ã‚¹ãŒè§£æ”¾ã•ã‚Œã‚‹', () => {
      // ç ´æ£„ç¢ºèª
    });
  });
});
```

### 2. DeliveryContainerãƒ†ã‚¹ãƒˆ ğŸ”µ

**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `tests/unit/presentation/ui/phase/DeliveryContainer.test.ts`

```typescript
import { describe, it, expect, beforeEach, vi } from 'vitest';

describe('DeliveryContainer', () => {
  describe('åˆæœŸåŒ–', () => {
    it.skip('ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ãã‚‹', () => {
      // ã‚³ãƒ³ãƒ†ãƒŠä½œæˆç¢ºèª
    });

    it.skip('èƒŒæ™¯ã¨ã‚¿ã‚¤ãƒˆãƒ«ãŒä½œæˆã•ã‚Œã‚‹', () => {
      // UIè¦ç´ ç¢ºèª
    });
  });

  describe('ä¾é ¼ãƒªã‚¹ãƒˆè¨­å®š', () => {
    it.skip('setAcceptedQuestsã§ä¾é ¼ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // ä¾é ¼ãƒªã‚¹ãƒˆè¡¨ç¤ºç¢ºèª
    });

    it.skip('getAcceptedQuestsã§è¨­å®šã—ãŸä¾é ¼ãŒå–å¾—ã§ãã‚‹', () => {
      // ã‚²ãƒƒã‚¿ãƒ¼ç¢ºèª
    });

    it.skip('ç©ºã®ãƒªã‚¹ãƒˆã§ç©ºçŠ¶æ…‹ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // ç©ºçŠ¶æ…‹ç¢ºèª
    });
  });

  describe('ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªè¨­å®š', () => {
    it.skip('setInventoryã§ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªãŒè¨­å®šã•ã‚Œã‚‹', () => {
      // ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªè¨­å®šç¢ºèª
    });

    it.skip('ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªå¤‰æ›´ã§ç´å“å¯å¦ãŒå†è¨ˆç®—ã•ã‚Œã‚‹', () => {
      // å†è¨ˆç®—ç¢ºèª
    });
  });

  describe('ä¾é ¼é¸æŠ', () => {
    it.skip('selectQuestã§ä¾é ¼ãŒé¸æŠã•ã‚Œã‚‹', () => {
      // é¸æŠçŠ¶æ…‹ç¢ºèª
    });

    it.skip('getSelectedQuestã§é¸æŠä¸­ã®ä¾é ¼ãŒå–å¾—ã§ãã‚‹', () => {
      // ã‚²ãƒƒã‚¿ãƒ¼ç¢ºèª
    });

    it.skip('é¸æŠã—ãŸä¾é ¼ã®è©³ç´°ãŒãƒ‘ãƒãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // è©³ç´°è¡¨ç¤ºç¢ºèª
    });

    it.skip('delivery:quest:selectedã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹', () => {
      // ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª
    });
  });

  describe('ç´å“å¯å¦åˆ¤å®š', () => {
    it.skip('è¦æ±‚ã‚¢ã‚¤ãƒ†ãƒ ãŒæƒã£ã¦ã„ã‚‹ä¾é ¼ã¯canDeliverãŒtrue', () => {
      // ç´å“å¯èƒ½ç¢ºèª
    });

    it.skip('è¦æ±‚ã‚¢ã‚¤ãƒ†ãƒ ãŒä¸è¶³ã—ã¦ã„ã‚‹ä¾é ¼ã¯canDeliverãŒfalse', () => {
      // ç´å“ä¸å¯ç¢ºèª
    });

    it.skip('getDeliverableQuestsã§ç´å“å¯èƒ½ãªä¾é ¼ã®ã¿å–å¾—ã§ãã‚‹', () => {
      // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ç¢ºèª
    });

    it.skip('ç´å“å¯èƒ½ãªä¾é ¼ã¯ç·‘è‰²ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆã•ã‚Œã‚‹', () => {
      // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç¢ºèª
    });
  });

  describe('ç´å“æ“ä½œ', () => {
    it.skip('deliverã§ç´å“ãŒå®Ÿè¡Œã•ã‚Œã‚‹', () => {
      // ç´å“å®Ÿè¡Œç¢ºèª
    });

    it.skip('ç´å“ä¸å¯ã®å ´åˆã¯deliverãŒå®Ÿè¡Œã•ã‚Œãªã„', () => {
      // æ¡ä»¶ãƒã‚§ãƒƒã‚¯ç¢ºèª
    });

    it.skip('delivery:completeã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹', () => {
      // ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª
    });

    it.skip('onDeliveryCompleteã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã‚‹', () => {
      // ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¢ºèª
    });

    it.skip('ç´å“å¾Œã«ä¾é ¼ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤ã•ã‚Œã‚‹', () => {
      // ãƒªã‚¹ãƒˆæ›´æ–°ç¢ºèª
    });
  });

  describe('å ±é…¬è¡¨ç¤º', () => {
    it.skip('ç´å“æˆåŠŸæ™‚ã«å ±é…¬ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // å ±é…¬è¡¨ç¤ºç¢ºèª
    });

    it.skip('ã‚´ãƒ¼ãƒ«ãƒ‰ã¨çµŒé¨“å€¤ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // å ±é…¬å€¤ç¢ºèª
    });

    it.skip('å ±é…¬ã‚«ãƒ¼ãƒ‰ãŒã‚ã‚Œã°é¸æŠUIãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // ã‚«ãƒ¼ãƒ‰é¸æŠUIç¢ºèª
    });
  });

  describe('ã‚¹ã‚­ãƒƒãƒ—', () => {
    it.skip('ã‚¹ã‚­ãƒƒãƒ—ãƒœã‚¿ãƒ³ã§onSkipãŒå‘¼ã°ã‚Œã‚‹', () => {
      // ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ç¢ºèª
    });

    it.skip('delivery:skipã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹', () => {
      // ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª
    });
  });

  describe('ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«', () => {
    it.skip('enteræ™‚ã«é¸æŠãŒã‚¯ãƒªã‚¢ã•ã‚Œã‚‹', () => {
      // enterå‡¦ç†ç¢ºèª
    });

    it.skip('destroyã§å…¨ãƒªã‚½ãƒ¼ã‚¹ãŒè§£æ”¾ã•ã‚Œã‚‹', () => {
      // ç ´æ£„ç¢ºèª
    });
  });
});
```

### 3. ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ†ã‚¹ãƒˆç”¨ã‚·ãƒ¼ãƒ³ ğŸ”µ

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/scenes/DeliveryTestScene.ts`

```typescript
import { BaseGameScene, SceneInitData } from './BaseGameScene';
import { DeliveryContainer } from '../ui/phase/DeliveryContainer';
import { EventBus } from '../core/EventBus';
import { Quest } from '../../../domain/quest/Quest';
import { Item } from '../../../domain/item/Item';

export class DeliveryTestScene extends BaseGameScene {
  private deliveryContainer!: DeliveryContainer;
  private eventBus!: EventBus;

  constructor() {
    super('DeliveryTestScene' as any);
  }

  protected onInit(data?: SceneInitData): void {}
  protected onPreload(): void {}

  protected onCreate(data?: SceneInitData): void {
    this.eventBus = new EventBus();

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    this.eventBus.on('delivery:complete', (result) => {
      console.log('Delivery complete:', result);
    });
    this.eventBus.on('delivery:skip', () => {
      console.log('Delivery skipped');
    });
    this.eventBus.on('delivery:quest:selected', (data) => {
      console.log('Quest selected:', data);
    });

    // ã‚³ãƒ³ãƒ†ãƒŠä½œæˆ
    this.deliveryContainer = new DeliveryContainer({
      scene: this,
      eventBus: this.eventBus,
      x: 20,
      y: 20,
      onDeliveryComplete: (result) => {
        console.log('Delivery callback:', result);
      },
      onSkip: () => {
        console.log('Skip callback');
      },
    });

    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿è¨­å®š
    this.deliveryContainer.setAcceptedQuests(this.createTestQuests());
    this.deliveryContainer.setInventory(this.createTestInventory());
    this.deliveryContainer.enter();

    // ãƒ†ã‚¹ãƒˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
    this.createTestControls();
  }

  private createTestQuests(): Quest[] {
    return [
      {
        id: 'q1',
        name: 'è–¬è‰ç´å“ã®ä¾é ¼',
        remainingDays: 5,
        difficulty: 'easy',
        reward: { gold: 150, exp: 30 },
        requiredItems: [{ name: 'å›å¾©è–¬', quantity: 2 }],
      } as Quest,
      {
        id: 'q2',
        name: 'çˆ†å¼¾è£½ä½œã®ä¾é ¼',
        remainingDays: 3,
        difficulty: 'normal',
        reward: { gold: 300, exp: 50, cards: ['card1', 'card2', 'card3'] },
        requiredItems: [{ name: 'çˆ†å¼¾', quantity: 1 }],
      } as Quest,
      {
        id: 'q3',
        name: 'é«˜ç´šã‚¢ã‚¤ãƒ†ãƒ ã®ä¾é ¼',
        remainingDays: 10,
        difficulty: 'hard',
        reward: { gold: 500, exp: 100 },
        requiredItems: [
          { name: 'ã‚¨ãƒªã‚¯ã‚µãƒ¼', quantity: 1 },
          { name: 'è³¢è€…ã®çŸ³', quantity: 1 },
        ],
      } as Quest,
    ];
  }

  private createTestInventory(): Item[] {
    return [
      { id: 'i1', name: 'å›å¾©è–¬', quality: 'normal' } as Item,
      { id: 'i2', name: 'å›å¾©è–¬', quality: 'good' } as Item,
      { id: 'i3', name: 'çˆ†å¼¾', quality: 'normal' } as Item,
      { id: 'i4', name: 'è–¬è‰', quality: 'normal' } as Item,
    ];
  }

  private createTestControls(): void {
    const buttonY = 560;

    // ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
    this.createTestButton(50, buttonY, 'ã‚¨ãƒªã‚¯ã‚µãƒ¼è¿½åŠ ', () => {
      const newItem = { id: `i-${Date.now()}`, name: 'ã‚¨ãƒªã‚¯ã‚µãƒ¼', quality: 'rare' } as Item;
      // å®Ÿéš›ã«ã¯getterãŒãªã„ã®ã§ãƒ­ãƒ¼ã‚«ãƒ«ã§ç®¡ç†
      console.log('Added Elixir');
    });

    // ä¾é ¼è¿½åŠ 
    this.createTestButton(180, buttonY, 'ä¾é ¼è¿½åŠ ', () => {
      const newQuest = {
        id: `q-${Date.now()}`,
        name: 'è¿½åŠ ã®ä¾é ¼',
        remainingDays: 7,
        difficulty: 'easy',
        reward: { gold: 100, exp: 20 },
        requiredItems: [{ name: 'è–¬è‰', quantity: 1 }],
      } as Quest;
      const current = this.deliveryContainer.getAcceptedQuests();
      this.deliveryContainer.setAcceptedQuests([...current, newQuest]);
    });
  }

  private createTestButton(x: number, y: number, label: string, onClick: () => void): void {
    const btn = this.add.text(x, y, label, {
      fontSize: '12px',
      backgroundColor: '#333333',
      padding: { x: 10, y: 5 },
    }).setInteractive();

    btn.on('pointerdown', onClick);
  }

  protected setupEventListeners(): void {}
}
```

---

## å®Ÿè£…æ‰‹é †

1. `/tsumiki:tdd-requirements TASK-0234` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- Phaserã‚·ãƒ¼ãƒ³ã®ãƒ¢ãƒƒã‚¯
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å«ã‚€ãƒ†ã‚¹ãƒˆ
- ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªé€£æºã®ãƒ†ã‚¹ãƒˆ

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 3é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 3é …ç›® (100%)
- ğŸŸ¡ **é»„ä¿¡å·**: 0é …ç›® (0%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ª
