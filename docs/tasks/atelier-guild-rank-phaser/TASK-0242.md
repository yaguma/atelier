# TASK-0242: ShopSceneç´ æãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆè³¼å…¥å®Ÿè£…

**ã‚¿ã‚¹ã‚¯ID**: TASK-0242
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 4 - ã‚µãƒ–ã‚·ãƒ¼ãƒ³ãƒ»Applicationå±¤ä¿®æ­£
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸ”µ *è¨­è¨ˆæ›¸ã«è¨˜è¼‰*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [overview.md](./overview.md)
- **UIè¨­è¨ˆ**: [ui-design/overview.md](../../design/atelier-guild-rank-phaser/ui-design/overview.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

ã‚·ãƒ§ãƒƒãƒ—ã§ã®ç´ æãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆè³¼å…¥æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã€‚æ•°é‡æŒ‡å®šè³¼å…¥ã¨è³¼å…¥ç¢ºèªå‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: TASK-0241
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0243

## å®Œäº†æ¡ä»¶

- [ ] ç´ æä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] æ•°é‡æŒ‡å®šUIãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] è³¼å…¥å‡¦ç†ãŒæ­£ã—ãå‹•ä½œã™ã‚‹

---

## å®Ÿè£…è©³ç´°

### 1. ç´ æå•†å“è¡Œã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ç´ æè¡¨ç¤º*

```typescript
// ShopSceneã«è¿½åŠ 

private createMaterialItemRow(material: any): Phaser.GameObjects.Container {
  const container = this.add.container(0, 0);

  // èƒŒæ™¯
  const bg = this.add.graphics();
  bg.fillStyle(Colors.backgroundMedium, 1);
  bg.fillRoundedRect(0, 0, 560, 70, 8);
  bg.setName('bg');
  container.add(bg);

  // ç´ æã‚¢ã‚¤ã‚³ãƒ³ï¼ˆå“è³ªã‚«ãƒ©ãƒ¼ï¼‰
  const qualityColor = this.getQualityColor(material.quality);
  const iconBg = this.add.graphics();
  iconBg.fillStyle(qualityColor, 0.3);
  iconBg.fillRoundedRect(10, 10, 50, 50, 8);
  iconBg.lineStyle(2, qualityColor);
  iconBg.strokeRoundedRect(10, 10, 50, 50, 8);
  container.add(iconBg);

  // ç´ æå
  const name = this.add.text(75, 15, material.name, {
    ...TextStyles.body,
    fontSize: '16px',
    fontStyle: 'bold',
  });
  container.add(name);

  // ã‚«ãƒ†ã‚´ãƒª
  const category = this.add.text(75, 40, material.category ?? 'ç´ æ', {
    ...TextStyles.body,
    fontSize: '12px',
    color: '#888888',
  });
  container.add(category);

  // å˜ä¾¡
  const unitPrice = this.add.text(350, 25, `${material.price} G / å€‹`, {
    ...TextStyles.body,
    fontSize: '14px',
    color: '#ffcc00',
  });
  container.add(unitPrice);

  // åœ¨åº«ï¼ˆç„¡é™ã¾ãŸã¯æœ‰é™ï¼‰
  const stockText = material.stock === -1
    ? 'âˆ'
    : `æ®‹ ${material.stock}`;
  const stock = this.add.text(480, 25, stockText, {
    ...TextStyles.body,
    fontSize: '14px',
    color: material.stock === 0 ? '#ff4444' : '#aaaaaa',
  });
  container.add(stock);

  // ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
  container.setSize(560, 70);
  container.setInteractive({ useHandCursor: true });

  container.on('pointerover', () => {
    bg.clear();
    bg.fillStyle(Colors.buttonHover, 1);
    bg.fillRoundedRect(0, 0, 560, 70, 8);
  });

  container.on('pointerout', () => {
    bg.clear();
    bg.fillStyle(Colors.backgroundMedium, 1);
    bg.fillRoundedRect(0, 0, 560, 70, 8);
  });

  container.on('pointerdown', () => {
    this.selectMaterial(material);
  });

  return container;
}

private getQualityColor(quality: number): number {
  if (quality >= 80) return 0xffaa00; // é«˜å“è³ª
  if (quality >= 50) return 0x00aaff; // ä¸­å“è³ª
  return 0xaaaaaa; // ä½å“è³ª
}
```

### 2. ç´ æè©³ç´°ãƒ»æ•°é‡é¸æŠãƒ‘ãƒãƒ« ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *æ•°é‡æŒ‡å®š*

```typescript
// ShopSceneã«è¿½åŠ 

private quantitySelector: {
  container: Phaser.GameObjects.Container;
  quantity: number;
  minusButton: Phaser.GameObjects.Container;
  plusButton: Phaser.GameObjects.Container;
  quantityText: Phaser.GameObjects.Text;
  totalText: Phaser.GameObjects.Text;
} | null = null;

private selectMaterial(material: any): void {
  this.selectedItem = material;
  this.selectedItem._type = 'material';
  this.updateMaterialDetailPanel(material);
  this.purchaseButton.setVisible(true);
}

private updateMaterialDetailPanel(material: any): void {
  const { DETAIL_AREA } = ShopSceneLayout;

  this.clearDetailPanel();

  // ç´ æå
  const nameText = this.add.text(DETAIL_AREA.WIDTH / 2, 30, material.name, {
    ...TextStyles.heading,
  }).setOrigin(0.5);
  this.detailPanel.add(nameText);

  // å“è³ª
  const qualityColor = this.getQualityColor(material.quality);
  const qualityText = this.add.text(DETAIL_AREA.WIDTH / 2, 60, `å“è³ª: ${material.quality}`, {
    ...TextStyles.body,
    color: `#${qualityColor.toString(16).padStart(6, '0')}`,
  }).setOrigin(0.5);
  this.detailPanel.add(qualityText);

  // ã‚«ãƒ†ã‚´ãƒª
  const categoryText = this.add.text(DETAIL_AREA.WIDTH / 2, 85, material.category ?? 'ç´ æ', {
    ...TextStyles.body,
    fontSize: '14px',
    color: '#888888',
  }).setOrigin(0.5);
  this.detailPanel.add(categoryText);

  // èª¬æ˜
  if (material.description) {
    const descText = this.add.text(20, 120, material.description, {
      ...TextStyles.body,
      fontSize: '13px',
      wordWrap: { width: DETAIL_AREA.WIDTH - 40 },
    });
    this.detailPanel.add(descText);
  }

  // æ•°é‡é¸æŠUI
  this.createQuantitySelector(material, DETAIL_AREA.WIDTH / 2, 220);

  // åˆè¨ˆé‡‘é¡
  const totalContainer = this.add.container(DETAIL_AREA.WIDTH / 2, 300);

  const totalLabel = this.add.text(-50, 0, 'åˆè¨ˆ:', {
    ...TextStyles.body,
    fontSize: '16px',
  });
  totalContainer.add(totalLabel);

  const totalValue = this.add.text(50, 0, `${material.price} G`, {
    ...TextStyles.heading,
    fontSize: '20px',
    color: '#ffcc00',
  }).setOrigin(0.5);
  totalValue.setName('totalValue');
  totalContainer.add(totalValue);

  this.detailPanel.add(totalContainer);
}

private createQuantitySelector(material: any, x: number, y: number): void {
  const container = this.add.container(x, y);
  this.detailPanel.add(container);

  // ãƒ©ãƒ™ãƒ«
  const label = this.add.text(0, -30, 'è³¼å…¥æ•°é‡', {
    ...TextStyles.body,
    fontSize: '14px',
  }).setOrigin(0.5);
  container.add(label);

  // ãƒã‚¤ãƒŠã‚¹ãƒœã‚¿ãƒ³
  const minusBtn = this.createQuantityButton('-', -60, 0, () => {
    this.changeQuantity(-1, material);
  });
  container.add(minusBtn);

  // æ•°é‡ãƒ†ã‚­ã‚¹ãƒˆ
  const quantityText = this.add.text(0, 0, '1', {
    ...TextStyles.heading,
    fontSize: '24px',
  }).setOrigin(0.5);
  container.add(quantityText);

  // ãƒ—ãƒ©ã‚¹ãƒœã‚¿ãƒ³
  const plusBtn = this.createQuantityButton('+', 60, 0, () => {
    this.changeQuantity(1, material);
  });
  container.add(plusBtn);

  // æœ€å¤§è³¼å…¥ãƒœã‚¿ãƒ³
  const maxBtn = UIFactory.createButton(this, {
    x: 0,
    y: 50,
    width: 80,
    height: 30,
    text: 'MAX',
    onClick: () => this.setMaxQuantity(material),
  });
  container.add(maxBtn);

  this.quantitySelector = {
    container,
    quantity: 1,
    minusButton: minusBtn,
    plusButton: plusBtn,
    quantityText,
    totalText: this.detailPanel.getByName('totalValue') as Phaser.GameObjects.Text,
  };
}

private createQuantityButton(
  label: string,
  x: number,
  y: number,
  onClick: () => void
): Phaser.GameObjects.Container {
  const btn = this.add.container(x, y);

  const bg = this.add.graphics();
  bg.fillStyle(Colors.buttonNormal, 1);
  bg.fillCircle(0, 0, 20);
  btn.add(bg);

  const text = this.add.text(0, 0, label, {
    fontSize: '20px',
    fontStyle: 'bold',
  }).setOrigin(0.5);
  btn.add(text);

  btn.setSize(40, 40);
  btn.setInteractive({ useHandCursor: true });

  btn.on('pointerover', () => {
    bg.clear();
    bg.fillStyle(Colors.buttonHover, 1);
    bg.fillCircle(0, 0, 20);
  });

  btn.on('pointerout', () => {
    bg.clear();
    bg.fillStyle(Colors.buttonNormal, 1);
    bg.fillCircle(0, 0, 20);
  });

  btn.on('pointerdown', onClick);

  return btn;
}

private changeQuantity(delta: number, material: any): void {
  if (!this.quantitySelector) return;

  const maxQuantity = this.calculateMaxQuantity(material);
  let newQuantity = this.quantitySelector.quantity + delta;
  newQuantity = Phaser.Math.Clamp(newQuantity, 1, maxQuantity);

  this.quantitySelector.quantity = newQuantity;
  this.quantitySelector.quantityText.setText(newQuantity.toString());

  // åˆè¨ˆé‡‘é¡æ›´æ–°
  const total = newQuantity * material.price;
  const canAfford = total <= this.playerGold;
  this.quantitySelector.totalText.setText(`${total} G`);
  this.quantitySelector.totalText.setColor(canAfford ? '#ffcc00' : '#ff4444');
}

private setMaxQuantity(material: any): void {
  if (!this.quantitySelector) return;

  const maxQuantity = this.calculateMaxQuantity(material);
  this.quantitySelector.quantity = maxQuantity;
  this.quantitySelector.quantityText.setText(maxQuantity.toString());

  const total = maxQuantity * material.price;
  this.quantitySelector.totalText.setText(`${total} G`);
}

private calculateMaxQuantity(material: any): number {
  // æ‰€æŒé‡‘ã§è²·ãˆã‚‹æœ€å¤§æ•°
  const maxByGold = Math.floor(this.playerGold / material.price);

  // åœ¨åº«åˆ¶é™
  const maxByStock = material.stock === -1 ? 999 : material.stock;

  return Math.min(maxByGold, maxByStock, 99);
}
```

### 3. ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆå•†å“è¡¨ç¤º ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆè¡¨ç¤º*

```typescript
// ShopSceneã«è¿½åŠ 

private createArtifactItemRow(artifact: any): Phaser.GameObjects.Container {
  const container = this.add.container(0, 0);

  // èƒŒæ™¯ï¼ˆãƒ¬ã‚¢åº¦ã«å¿œã˜ãŸè£…é£¾ï¼‰
  const rarityColor = this.getRarityColor(artifact.rarity);
  const bg = this.add.graphics();
  bg.fillStyle(Colors.backgroundMedium, 1);
  bg.fillRoundedRect(0, 0, 560, 90, 8);
  bg.lineStyle(2, rarityColor, 0.5);
  bg.strokeRoundedRect(0, 0, 560, 90, 8);
  bg.setName('bg');
  container.add(bg);

  // ã‚¢ã‚¤ã‚³ãƒ³
  const iconBg = this.add.graphics();
  iconBg.fillStyle(rarityColor, 0.3);
  iconBg.fillRoundedRect(10, 10, 70, 70, 8);
  container.add(iconBg);

  const icon = this.add.text(45, 45, 'ğŸ†', { fontSize: '32px' }).setOrigin(0.5);
  container.add(icon);

  // åå‰
  const name = this.add.text(95, 15, artifact.name, {
    ...TextStyles.body,
    fontSize: '16px',
    fontStyle: 'bold',
  });
  container.add(name);

  // ãƒ¬ã‚¢ãƒªãƒ†ã‚£
  const rarityLabel = this.getRarityLabel(artifact.rarity);
  const rarity = this.add.text(95, 40, rarityLabel, {
    ...TextStyles.body,
    fontSize: '12px',
    color: `#${rarityColor.toString(16).padStart(6, '0')}`,
  });
  container.add(rarity);

  // åŠ¹æœæ¦‚è¦
  const effectSummary = artifact.effects?.[0]?.description ?? 'ç‰¹æ®ŠåŠ¹æœ';
  const effect = this.add.text(95, 60, effectSummary, {
    ...TextStyles.body,
    fontSize: '11px',
    color: '#aaaaaa',
  });
  container.add(effect);

  // ä¾¡æ ¼
  const canAfford = artifact.price <= this.playerGold;
  const price = this.add.text(480, 35, `${artifact.price} G`, {
    ...TextStyles.body,
    fontSize: '18px',
    fontStyle: 'bold',
    color: canAfford ? '#ffcc00' : '#ff4444',
  });
  container.add(price);

  // ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
  container.setSize(560, 90);
  container.setInteractive({ useHandCursor: true });

  container.on('pointerdown', () => {
    this.selectArtifact(artifact);
  });

  return container;
}

private getRarityLabel(rarity: string): string {
  switch (rarity) {
    case 'common': return 'â˜… ã‚³ãƒ¢ãƒ³';
    case 'uncommon': return 'â˜…â˜… ã‚¢ãƒ³ã‚³ãƒ¢ãƒ³';
    case 'rare': return 'â˜…â˜…â˜… ãƒ¬ã‚¢';
    case 'epic': return 'â˜…â˜…â˜…â˜… ã‚¨ãƒ”ãƒƒã‚¯';
    case 'legendary': return 'â˜…â˜…â˜…â˜…â˜… ãƒ¬ã‚¸ã‚§ãƒ³ãƒ€ãƒªãƒ¼';
    default: return 'â˜… ã‚³ãƒ¢ãƒ³';
  }
}

private selectArtifact(artifact: any): void {
  this.selectedItem = artifact;
  this.selectedItem._type = 'artifact';
  this.updateArtifactDetailPanel(artifact);
  this.purchaseButton.setVisible(true);
}

private updateArtifactDetailPanel(artifact: any): void {
  const { DETAIL_AREA } = ShopSceneLayout;

  this.clearDetailPanel();

  // åå‰
  const nameText = this.add.text(DETAIL_AREA.WIDTH / 2, 30, artifact.name, {
    ...TextStyles.heading,
  }).setOrigin(0.5);
  this.detailPanel.add(nameText);

  // ãƒ¬ã‚¢ãƒªãƒ†ã‚£
  const rarityColor = this.getRarityColor(artifact.rarity);
  const rarityText = this.add.text(DETAIL_AREA.WIDTH / 2, 60, this.getRarityLabel(artifact.rarity), {
    ...TextStyles.body,
    color: `#${rarityColor.toString(16).padStart(6, '0')}`,
  }).setOrigin(0.5);
  this.detailPanel.add(rarityText);

  // åŠ¹æœä¸€è¦§
  let y = 100;
  const effectsLabel = this.add.text(20, y, 'ã€åŠ¹æœã€‘', {
    ...TextStyles.body,
    fontStyle: 'bold',
  });
  this.detailPanel.add(effectsLabel);
  y += 25;

  artifact.effects?.forEach((effect: any) => {
    const effectText = this.add.text(30, y, `â€¢ ${effect.description}`, {
      ...TextStyles.body,
      fontSize: '13px',
      wordWrap: { width: DETAIL_AREA.WIDTH - 60 },
    });
    this.detailPanel.add(effectText);
    y += effectText.height + 5;
  });

  // è£…å‚™æ¡ä»¶ï¼ˆã‚ã‚Œã°ï¼‰
  if (artifact.requirement) {
    y += 10;
    const reqLabel = this.add.text(20, y, 'ã€è£…å‚™æ¡ä»¶ã€‘', {
      ...TextStyles.body,
      fontStyle: 'bold',
    });
    this.detailPanel.add(reqLabel);
    y += 25;

    const reqText = this.add.text(30, y, artifact.requirement, {
      ...TextStyles.body,
      fontSize: '13px',
    });
    this.detailPanel.add(reqText);
  }

  // ä¾¡æ ¼
  const canAfford = artifact.price <= this.playerGold;
  const priceText = this.add.text(DETAIL_AREA.WIDTH / 2, 350, `${artifact.price} G`, {
    ...TextStyles.heading,
    fontSize: '24px',
    color: canAfford ? '#ffcc00' : '#ff4444',
  }).setOrigin(0.5);
  this.detailPanel.add(priceText);
}
```

### 4. è³¼å…¥å‡¦ç†çµ±åˆ ğŸ”µ

**ä¿¡é ¼æ€§**: ğŸ”µ *è³¼å…¥ãƒ•ãƒ­ãƒ¼*

```typescript
// ShopSceneã®handlePurchaseã‚’æ›´æ–°

private handlePurchase(): void {
  if (!this.selectedItem) return;

  const itemType = this.selectedItem._type ?? this.currentCategory;

  switch (itemType) {
    case 'cards':
      this.showPurchaseConfirmDialog(this.selectedItem);
      break;

    case 'material':
    case 'materials':
      this.handleMaterialPurchase();
      break;

    case 'artifact':
    case 'artifacts':
      this.handleArtifactPurchase();
      break;
  }
}

private handleMaterialPurchase(): void {
  if (!this.selectedItem || !this.quantitySelector) return;

  const quantity = this.quantitySelector.quantity;
  const totalPrice = this.selectedItem.price * quantity;

  if (totalPrice > this.playerGold) {
    this.showToast('ã‚´ãƒ¼ãƒ«ãƒ‰ãŒè¶³ã‚Šã¾ã›ã‚“', 'error');
    return;
  }

  this.dialogManager.showConfirmDialog({
    title: 'è³¼å…¥ç¢ºèª',
    message: `ã€Œ${this.selectedItem.name}ã€Ã— ${quantity}\nåˆè¨ˆ ${totalPrice} G ã§è³¼å…¥ã—ã¾ã™ã‹ï¼Ÿ`,
    confirmText: 'è³¼å…¥',
    cancelText: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
    onConfirm: () => {
      this.eventBus.emit('shop:material:purchase', {
        material: this.selectedItem,
        quantity,
        totalPrice,
      });
    },
  });
}

private handleArtifactPurchase(): void {
  if (!this.selectedItem) return;

  if (this.selectedItem.price > this.playerGold) {
    this.showToast('ã‚´ãƒ¼ãƒ«ãƒ‰ãŒè¶³ã‚Šã¾ã›ã‚“', 'error');
    return;
  }

  this.dialogManager.showConfirmDialog({
    title: 'è³¼å…¥ç¢ºèª',
    message: `ã€Œ${this.selectedItem.name}ã€ã‚’\n${this.selectedItem.price} G ã§è³¼å…¥ã—ã¾ã™ã‹ï¼Ÿ`,
    confirmText: 'è³¼å…¥',
    cancelText: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
    onConfirm: () => {
      this.eventBus.emit('shop:artifact:purchase', {
        artifact: this.selectedItem,
        price: this.selectedItem.price,
      });
    },
  });
}

// Applicationå±¤ã‹ã‚‰ã®å®Œäº†é€šçŸ¥
onMaterialPurchaseComplete(result: { material: any; quantity: number; newGold: number }): void {
  this.updateGold(result.newGold);

  // åœ¨åº«æ›´æ–°
  if (this.selectedItem.stock !== -1) {
    this.selectedItem.stock -= result.quantity;
  }

  this.updateItemList();
  this.showToast(`${result.material.name} Ã— ${result.quantity} ã‚’è³¼å…¥ã—ã¾ã—ãŸï¼`, 'success');
}

onArtifactPurchaseComplete(result: { artifact: any; newGold: number }): void {
  this.updateGold(result.newGold);

  // è³¼å…¥æ¸ˆã¿ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’é™¤å¤–
  this.shopData.availableArtifacts = this.shopData.availableArtifacts?.filter(
    a => a.id !== result.artifact.id
  );

  this.updateItemList();
  this.selectedItem = null;
  this.clearDetailPanel();
  this.purchaseButton.setVisible(false);

  this.showToast(`${result.artifact.name} ã‚’è³¼å…¥ã—ã¾ã—ãŸï¼`, 'success');
}
```

---

## å˜ä½“ãƒ†ã‚¹ãƒˆè¦ä»¶

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ç´ ææ•°é‡é¸æŠ ğŸ”µ

**Given**: ç´ æã‚’é¸æŠã—ã¦ã„ã‚‹
**When**: ãƒ—ãƒ©ã‚¹ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
**Then**: æ•°é‡ãŒå¢—åŠ ã—ã€åˆè¨ˆé‡‘é¡ãŒæ›´æ–°ã•ã‚Œã‚‹

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: æœ€å¤§æ•°é‡åˆ¶é™ ğŸ”µ

**Given**: æ‰€æŒé‡‘1000Gã€ç´ æä¾¡æ ¼100G
**When**: MAXãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
**Then**: æ•°é‡ãŒ10ã«è¨­å®šã•ã‚Œã‚‹

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆè³¼å…¥ ğŸ”µ

**Given**: ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã‚’é¸æŠã—ã¦ã„ã‚‹
**When**: è³¼å…¥ã‚’ç¢ºå®š
**Then**: ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆãŒè³¼å…¥ã•ã‚Œã€ãƒªã‚¹ãƒˆã‹ã‚‰æ¶ˆãˆã‚‹

---

## å®Ÿè£…æ‰‹é †

1. `/tsumiki:tdd-requirements TASK-0242` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- åœ¨åº«ç®¡ç†ï¼ˆç„¡é™ vs æœ‰é™ï¼‰
- æ•°é‡å…¥åŠ›ã®ä¸Šé™è¨­å®š
- ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®1å›é™ã‚Šè³¼å…¥

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 4é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 4é …ç›® (100%)
- ğŸŸ¡ **é»„ä¿¡å·**: 0é …ç›® (0%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ª
