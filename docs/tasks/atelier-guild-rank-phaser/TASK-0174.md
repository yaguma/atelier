# TASK-0174: UIFactoryãƒ©ãƒ™ãƒ«ç”Ÿæˆå®Ÿè£…

**ã‚¿ã‚¹ã‚¯ID**: TASK-0174
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 1 - PhaseråŸºç›¤ãƒ»ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ *å¦¥å½“ãªæ¨æ¸¬ã«åŸºã¥ã*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [overview.md](./overview.md)
- **ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ **: [core-systems.md](../../design/atelier-guild-rank-phaser/core-systems.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

UIFactoryã®createLabel()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã€ã‚¢ã‚¤ã‚³ãƒ³ä»˜ããƒ©ãƒ™ãƒ«ã‚„ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ã‚’ç”Ÿæˆã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: TASK-0173
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0175, TASK-0176, TASK-0177, TASK-0178, TASK-0180

## å®Œäº†æ¡ä»¶

- [x] createLabel()ãƒ¡ã‚½ãƒƒãƒ‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹
- [x] ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ã®ãƒ©ãƒ™ãƒ«ãŒç”Ÿæˆã§ãã‚‹
- [x] ã‚¢ã‚¤ã‚³ãƒ³ä»˜ããƒ©ãƒ™ãƒ«ãŒç”Ÿæˆã§ãã‚‹
- [x] æ°´å¹³/å‚ç›´é…ç½®ãŒé¸æŠã§ãã‚‹
- [x] ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ãŒã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹

---

## å®Ÿè£…è©³ç´°

### 1. createLabelå®Ÿè£… ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *rexUI.Labelã‚’ä½¿ç”¨*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/ui/UIFactory.ts`ã«è¿½åŠ 

```typescript
createLabel(options: LabelOptions): Label {
  const {
    x, y, text, icon, iconSize,
    textStyle, orientation, space
  } = options;

  const labelConfig: any = {
    x, y,
    orientation: orientation ?? 'horizontal',
    space: { icon: space ?? 8 },
  };

  // ã‚¢ã‚¤ã‚³ãƒ³
  if (icon) {
    const iconObj = this.scene.add.image(0, 0, icon);
    if (iconSize) {
      iconObj.setDisplaySize(iconSize, iconSize);
    }
    labelConfig.icon = iconObj;
  }

  // ãƒ†ã‚­ã‚¹ãƒˆ
  labelConfig.text = this.scene.add.text(
    0, 0,
    text,
    textStyle ?? TextStyles.body
  );

  const label = this.rexUI.add.label(labelConfig).layout();

  return label;
}

// å€¤è¡¨ç¤ºç”¨ãƒ©ãƒ™ãƒ«ï¼ˆã‚¢ã‚¤ã‚³ãƒ³ + å€¤ï¼‰
createValueLabel(options: {
  x: number;
  y: number;
  icon: string;
  value: number | string;
  iconSize?: number;
  valueStyle?: Phaser.Types.GameObjects.Text.TextStyle;
}): Label {
  const { x, y, icon, value, iconSize, valueStyle } = options;

  return this.createLabel({
    x, y,
    icon,
    iconSize: iconSize ?? 24,
    text: String(value),
    textStyle: valueStyle ?? TextStyles.number,
    orientation: 'horizontal',
    space: 8,
  });
}

// ã‚¿ã‚¤ãƒˆãƒ«ãƒ©ãƒ™ãƒ«
createTitleLabel(options: {
  x: number;
  y: number;
  text: string;
  size?: 'large' | 'medium' | 'small';
}): Phaser.GameObjects.Text {
  const { x, y, text, size } = options;

  const styleKey = size === 'large' ? 'titleLarge' :
                   size === 'small' ? 'titleSmall' : 'titleMedium';

  return this.scene.add.text(x, y, text, TextStyles[styleKey])
    .setOrigin(0.5);
}

// èª¬æ˜ãƒ©ãƒ™ãƒ«
createDescriptionLabel(options: {
  x: number;
  y: number;
  text: string;
  width?: number;
}): Phaser.GameObjects.Text {
  const { x, y, text, width } = options;

  const style = {
    ...TextStyles.body,
    wordWrap: width ? { width } : undefined,
  };

  return this.scene.add.text(x, y, text, style);
}
```

### 2. ãƒ©ãƒ™ãƒ«æ›´æ–°ãƒ¡ã‚½ãƒƒãƒ‰ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *å‹•çš„æ›´æ–°ç”¨*

```typescript
// ãƒ©ãƒ™ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
updateLabelText(label: Label, text: string): void {
  const textObj = (label as any).getElement('text');
  if (textObj) {
    textObj.setText(text);
    label.layout();
  }
}

// ãƒ©ãƒ™ãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’æ›´æ–°
updateLabelIcon(label: Label, iconKey: string): void {
  const iconObj = (label as any).getElement('icon');
  if (iconObj && iconObj instanceof Phaser.GameObjects.Image) {
    iconObj.setTexture(iconKey);
    label.layout();
  }
}
```

---

## å˜ä½“ãƒ†ã‚¹ãƒˆè¦ä»¶

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ç”Ÿæˆ ğŸŸ¡

**Given**: UIFactoryã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚ã‚‹
**When**: createLabel({ text: 'Hello' })ã‚’å‘¼ã¶
**Then**: ãƒ†ã‚­ã‚¹ãƒˆãƒ©ãƒ™ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: ã‚¢ã‚¤ã‚³ãƒ³ä»˜ããƒ©ãƒ™ãƒ«ç”Ÿæˆ ğŸŸ¡

**Given**: UIFactoryã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚ã‚‹
**When**: createLabel({ text: 'Gold', icon: 'icon-gold' })ã‚’å‘¼ã¶
**Then**: ã‚¢ã‚¤ã‚³ãƒ³ä»˜ããƒ©ãƒ™ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: ãƒ©ãƒ™ãƒ«æ›´æ–° ğŸŸ¡

**Given**: ãƒ©ãƒ™ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
**When**: updateLabelText()ã‚’å‘¼ã¶
**Then**: ãƒ†ã‚­ã‚¹ãƒˆãŒæ›´æ–°ã•ã‚Œã‚‹

---

## å®Ÿè£…æ‰‹é †

1. `/tsumiki:tdd-requirements TASK-0174` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã¯ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹
- é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ¯ãƒ¼ãƒ‰ãƒ©ãƒƒãƒ—å‡¦ç†
- layout()ã‚’å‘¼ã°ãªã„ã¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒæ›´æ–°ã•ã‚Œãªã„

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 2é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 0é …ç›® (0%)
- ğŸŸ¡ **é»„ä¿¡å·**: 2é …ç›® (100%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: ä¸­å“è³ª
