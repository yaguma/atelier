# TASK-0189: CardViewè¨­è¨ˆï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ï¼‰

**ã‚¿ã‚¹ã‚¯ID**: TASK-0189
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 2 - åŸºæœ¬ã‚·ãƒ¼ãƒ³ãƒ»å…±é€šUIå®Ÿè£…
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ *å¦¥å½“ãªæ¨æ¸¬ã«åŸºã¥ã*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [overview.md](./overview.md)
- **UIè¨­è¨ˆ**: [ui-design/overview.md](../../design/atelier-guild-rank-phaser/ui-design/overview.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

ã‚«ãƒ¼ãƒ‰ã®è¦–è¦šçš„è¡¨ç¾ã‚’æ‹…å½“ã™ã‚‹CardViewã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¨­è¨ˆã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: TASK-0162, TASK-0163
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0190

## å®Œäº†æ¡ä»¶

- [ ] ICardViewã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚«ãƒ¼ãƒ‰ç¨®åˆ¥ã”ã¨ã®è¡¨ç¤ºã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚«ãƒ¼ãƒ‰çŠ¶æ…‹ï¼ˆé¸æŠã€ç„¡åŠ¹ã€ãƒ›ãƒãƒ¼ï¼‰ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- [ ] ã‚«ãƒ¼ãƒ‰ã‚µã‚¤ã‚ºå®šæ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹

---

## å®Ÿè£…è©³ç´°

### 1. ã‚«ãƒ¼ãƒ‰ã‚µã‚¤ã‚ºãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®šæ•° ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *ui-design/overview.mdã‚’å‚è€ƒ*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/ui/card/CardConstants.ts`

```typescript
export const CardSize = {
  STANDARD: { width: 120, height: 160 },
  SMALL: { width: 90, height: 120 },
  LARGE: { width: 150, height: 200 },
} as const;

export const CardLayout = {
  // ã‚«ãƒ¼ãƒ‰å†…ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆSTANDARDåŸºæº–ï¼‰
  ICON_Y: 45,
  ICON_SIZE: 48,
  NAME_Y: 85,
  COST_X: 100,
  COST_Y: 15,
  DESCRIPTION_Y: 110,
  DESCRIPTION_WIDTH: 100,
} as const;

export type CardSizeType = keyof typeof CardSize;
```

### 2. ã‚«ãƒ¼ãƒ‰çŠ¶æ…‹å®šç¾© ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *æ¨™æº–çš„ãªUIã‚¹ãƒ†ãƒ¼ãƒˆ*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/ui/card/CardState.ts`

```typescript
export type CardState = 'normal' | 'selected' | 'disabled' | 'hover' | 'used';

export interface CardStateStyle {
  backgroundColor: number;
  borderColor: number;
  borderWidth: number;
  alpha: number;
  scale: number;
}

export const CardStateStyles: Record<CardState, CardStateStyle> = {
  normal: {
    backgroundColor: 0x2a2a4e,
    borderColor: 0x4a4a7e,
    borderWidth: 2,
    alpha: 1,
    scale: 1,
  },
  selected: {
    backgroundColor: 0x3a3a6e,
    borderColor: 0x4a90d9,
    borderWidth: 3,
    alpha: 1,
    scale: 1.05,
  },
  disabled: {
    backgroundColor: 0x1a1a2e,
    borderColor: 0x3a3a5e,
    borderWidth: 2,
    alpha: 0.5,
    scale: 1,
  },
  hover: {
    backgroundColor: 0x3a3a5e,
    borderColor: 0x5a5a8e,
    borderWidth: 2,
    alpha: 1,
    scale: 1.02,
  },
  used: {
    backgroundColor: 0x1a1a2e,
    borderColor: 0x2a2a3e,
    borderWidth: 2,
    alpha: 0.6,
    scale: 0.95,
  },
};
```

### 3. ICardViewã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/ui/card/ICardView.ts`

```typescript
import Phaser from 'phaser';
import { Card } from '../../../../domain/card/Card';
import { CardState } from './CardState';
import { CardSizeType } from './CardConstants';

export interface CardViewOptions {
  x: number;
  y: number;
  card: Card;
  size?: CardSizeType;
  state?: CardState;
  interactive?: boolean;
  onClick?: (card: Card) => void;
  onHover?: (card: Card, isHovering: boolean) => void;
}

export interface ICardView {
  // ã‚³ãƒ³ãƒ†ãƒŠå‚ç…§
  readonly container: Phaser.GameObjects.Container;

  // ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿
  readonly card: Card;

  // çŠ¶æ…‹ç®¡ç†
  getState(): CardState;
  setState(state: CardState): void;

  // è¡¨ç¤ºæ›´æ–°
  update(card: Card): void;
  setPosition(x: number, y: number): void;
  setScale(scale: number): void;
  setAlpha(alpha: number): void;

  // ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
  setInteractive(enabled: boolean): void;
  setSelected(selected: boolean): void;

  // ç ´æ£„
  destroy(): void;
}
```

### 4. ã‚«ãƒ¼ãƒ‰ç¨®åˆ¥åˆ¥ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ã*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/ui/card/CardTypeOptions.ts`

```typescript
import { CardType } from '../../../../domain/card/CardType';
import { CardTypeColors } from '../../config/ColorPalette';

export interface CardTypeDisplayOption {
  backgroundColor: number;
  borderColor: number;
  iconKey: string;
  labelColor: string;
}

export const getCardTypeDisplayOption = (type: CardType): CardTypeDisplayOption => {
  switch (type) {
    case 'gathering':
      return {
        backgroundColor: CardTypeColors.gathering.background,
        borderColor: CardTypeColors.gathering.border,
        iconKey: 'card-gathering',
        labelColor: CardTypeColors.gathering.text,
      };
    case 'recipe':
      return {
        backgroundColor: CardTypeColors.recipe.background,
        borderColor: CardTypeColors.recipe.border,
        iconKey: 'card-recipe',
        labelColor: CardTypeColors.recipe.text,
      };
    case 'enhancement':
      return {
        backgroundColor: CardTypeColors.enhancement.background,
        borderColor: CardTypeColors.enhancement.border,
        iconKey: 'card-enhancement',
        labelColor: CardTypeColors.enhancement.text,
      };
  }
};
```

---

## å˜ä½“ãƒ†ã‚¹ãƒˆè¦ä»¶

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å‹ãƒã‚§ãƒƒã‚¯ ğŸŸ¡

**Given**: ICardViewã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
**When**: å‹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹
**Then**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒãªã„

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: ã‚«ãƒ¼ãƒ‰ç¨®åˆ¥ã‚ªãƒ—ã‚·ãƒ§ãƒ³ ğŸŸ¡

**Given**: CardTypeå€¤ãŒã‚ã‚‹
**When**: getCardTypeDisplayOption()ã‚’å‘¼ã¶
**Then**: å¯¾å¿œã™ã‚‹è¡¨ç¤ºã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒè¿”ã•ã‚Œã‚‹

---

## å®Ÿè£…æ‰‹é †

1. `/tsumiki:tdd-requirements TASK-0189` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®Cardå‹ã¨é€£æº
- è¡¨ç¤ºã‚µã‚¤ã‚ºã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆ

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 4é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 0é …ç›® (0%)
- ğŸŸ¡ **é»„ä¿¡å·**: 4é …ç›® (100%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: ä¸­å“è³ª
