# TASK-0183: BootSceneãƒ—ãƒªãƒ­ãƒ¼ãƒ‰å®Ÿè£…

**ã‚¿ã‚¹ã‚¯ID**: TASK-0183
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 2 - åŸºæœ¬ã‚·ãƒ¼ãƒ³ãƒ»å…±é€šUIå®Ÿè£…
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸ”´ *Phaserå›ºæœ‰ã®èª¿æŸ»ãŒå¿…è¦*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [overview.md](./overview.md)
- **è¨­è¨ˆæ–‡æ›¸**: [architecture.md](../../design/atelier-guild-rank-phaser/architecture.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

BootSceneã§ã‚¢ã‚»ãƒƒãƒˆã‚’ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: TASK-0182
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0184, TASK-0256

## å®Œäº†æ¡ä»¶

- [ ] BootSceneãŒBaseGameSceneã‚’ç¶™æ‰¿ã—ã¦ã„ã‚‹
- [ ] preload()ã§å…¨ã‚¢ã‚»ãƒƒãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹
- [ ] èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«TitleSceneã«é·ç§»ã™ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹

---

## å®Ÿè£…è©³ç´°

### 1. BootSceneå®Ÿè£… ğŸ”´

**ä¿¡é ¼æ€§**: ğŸ”´ *Phaserã®ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰æ©Ÿæ§‹ã‚’ä½¿ç”¨*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/scenes/BootScene.ts`

```typescript
import { BaseGameScene, SceneInitData } from './BaseGameScene';
import { SceneKeys } from '../config/SceneKeys';
import { AllAssets, getTotalAssetCount } from '../boot/AssetList';
import { SceneManager } from '../managers/SceneManager';

export class BootScene extends BaseGameScene {
  private loadedCount = 0;
  private totalCount = 0;
  private loadingText!: Phaser.GameObjects.Text;
  private progressCallback?: (progress: number) => void;

  constructor() {
    super(SceneKeys.BOOT);
  }

  protected onInit(data?: SceneInitData): void {
    this.loadedCount = 0;
    this.totalCount = getTotalAssetCount();
  }

  protected onPreload(): void {
    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ†ã‚­ã‚¹ãƒˆï¼ˆãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã¯TASK-0184ã§å®Ÿè£…ï¼‰
    this.loadingText = this.add.text(
      this.cameras.main.centerX,
      this.cameras.main.centerY,
      'Loading...',
      { fontSize: '24px', color: '#ffffff' }
    ).setOrigin(0.5);

    // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆ
    this.load.on('progress', (value: number) => {
      this.loadingText.setText(`Loading... ${Math.round(value * 100)}%`);
      if (this.progressCallback) {
        this.progressCallback(value);
      }
    });

    // å®Œäº†ã‚¤ãƒ™ãƒ³ãƒˆ
    this.load.on('complete', () => {
      console.log('All assets loaded');
    });

    // ã‚¨ãƒ©ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
    this.load.on('loaderror', (file: Phaser.Loader.File) => {
      console.error('Load error:', file.key, file.url);
    });

    // ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿
    this.loadAllAssets();
  }

  protected onCreate(data?: SceneInitData): void {
    // èª­ã¿è¾¼ã¿å®Œäº†ã€TitleSceneã¸é·ç§»
    this.time.delayedCall(500, () => {
      SceneManager.getInstance().goTo(SceneKeys.TITLE);
    });
  }

  protected setupEventListeners(): void {
    // BootSceneã§ã¯ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã¯ä¸è¦
  }

  /**
   * ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¨­å®šï¼ˆTASK-0184ã§ä½¿ç”¨ï¼‰
   */
  public setProgressCallback(callback: (progress: number) => void): void {
    this.progressCallback = callback;
  }

  private loadAllAssets(): void {
    AllAssets.forEach(asset => {
      switch (asset.type) {
        case 'image':
          this.load.image(asset.key, asset.path);
          break;
        case 'audio':
          this.load.audio(asset.key, asset.path);
          break;
        case 'json':
          this.load.json(asset.key, asset.path);
          break;
        case 'spritesheet':
          if (asset.frameConfig) {
            this.load.spritesheet(asset.key, asset.path, asset.frameConfig);
          }
          break;
      }
    });
  }
}
```

### 2. ã‚·ãƒ¼ãƒ³ç™»éŒ² ğŸ”´

**ä¿¡é ¼æ€§**: ğŸ”´ *ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã§ç™»éŒ²*

```typescript
// src/presentation/phaser/scenes/index.ts ã«è¿½åŠ 
export { BootScene } from './BootScene';
```

---

## å˜ä½“ãƒ†ã‚¹ãƒˆè¦ä»¶

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿é–‹å§‹ ğŸ”´

**Given**: BootSceneãŒä½œæˆã•ã‚Œã‚‹
**When**: preload()ãŒå‘¼ã°ã‚Œã‚‹
**Then**: å…¨ã‚¢ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿ãŒé–‹å§‹ã•ã‚Œã‚‹

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: èª­ã¿è¾¼ã¿å®Œäº†å¾Œã®é·ç§» ğŸ”´

**Given**: å…¨ã‚¢ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ãŸ
**When**: create()ãŒå‘¼ã°ã‚Œã‚‹
**Then**: TitleSceneã«é·ç§»ã™ã‚‹

---

## å®Ÿè£…æ‰‹é †

1. `/tsumiki:tdd-requirements TASK-0183` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- ã‚¢ã‚»ãƒƒãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
- å¤§é‡ã‚¢ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿æ™‚ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ã®ãƒ­ã‚°å‡ºåŠ›

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 2é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 0é …ç›® (0%)
- ğŸŸ¡ **é»„ä¿¡å·**: 0é …ç›® (0%)
- ğŸ”´ **èµ¤ä¿¡å·**: 2é …ç›® (100%)

**å“è³ªè©•ä¾¡**: è¦èª¿æŸ»
