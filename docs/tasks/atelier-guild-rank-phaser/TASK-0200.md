# TASK-0200: MaterialViewãƒ†ã‚¹ãƒˆ

**ã‚¿ã‚¹ã‚¯ID**: TASK-0200
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: TDD
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 2 - åŸºæœ¬ã‚·ãƒ¼ãƒ³ãƒ»å…±é€šUIå®Ÿè£…
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ *å¦¥å½“ãªæ¨æ¸¬ã«åŸºã¥ã*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [overview.md](./overview.md)
- **UIè¨­è¨ˆ**: [ui-design/overview.md](../../design/atelier-guild-rank-phaser/ui-design/overview.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

MaterialViewé–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã™ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: TASK-0199
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: TASK-0201

## å®Œäº†æ¡ä»¶

- [x] MaterialConstantsã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [x] å“è³ªè‰²ã®ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [x] MaterialViewã®åŸºæœ¬æ“ä½œãƒ†ã‚¹ãƒˆãŒé€šã‚‹
- [x] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

---

## å®Ÿè£…è©³ç´°

### 1. MaterialConstantsãƒ†ã‚¹ãƒˆ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *å®šæ•°ã®æ¤œè¨¼*

**ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: `tests/unit/presentation/ui/material/MaterialView.test.ts`

```typescript
import { describe, it, expect } from 'vitest';
import {
  MaterialLayout,
  MaterialQualityColors
} from '../../../../../src/presentation/phaser/ui/material/MaterialConstants';

describe('MaterialConstants', () => {
  describe('MaterialLayout', () => {
    it('ã‚¢ã‚¤ã‚³ãƒ³ã‚µã‚¤ã‚ºãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹', () => {
      expect(MaterialLayout.ICON_SIZE).toBeGreaterThan(0);
      expect(MaterialLayout.BADGE_SIZE).toBeGreaterThan(0);
    });

    it('ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤ºã‚µã‚¤ã‚ºãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹', () => {
      expect(MaterialLayout.COMPACT_WIDTH).toBeGreaterThan(0);
      expect(MaterialLayout.COMPACT_HEIGHT).toBeGreaterThan(0);
    });

    it('è©³ç´°è¡¨ç¤ºã‚µã‚¤ã‚ºãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹', () => {
      expect(MaterialLayout.DETAIL_WIDTH).toBeGreaterThan(0);
      expect(MaterialLayout.DETAIL_HEIGHT).toBeGreaterThan(0);
    });

    it('è©³ç´°è¡¨ç¤ºã¯ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤ºã‚ˆã‚Šå¤§ãã„', () => {
      expect(MaterialLayout.DETAIL_WIDTH).toBeGreaterThan(MaterialLayout.COMPACT_WIDTH);
    });
  });

  describe('MaterialQualityColors', () => {
    it('å“è³ª1ã€œ5ã®è‰²ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹', () => {
      for (let quality = 1; quality <= 5; quality++) {
        expect(MaterialQualityColors[quality]).toBeDefined();
        expect(MaterialQualityColors[quality]).toBeTypeOf('number');
      }
    });

    it('å„å“è³ªã§ç•°ãªã‚‹è‰²ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹', () => {
      const colors = Object.values(MaterialQualityColors);
      const uniqueColors = new Set(colors);
      expect(uniqueColors.size).toBe(colors.length);
    });

    it('å“è³ª5ã¯é‡‘è‰²(0xffd700)ã§ã‚ã‚‹', () => {
      expect(MaterialQualityColors[5]).toBe(0xffd700);
    });
  });
});

describe('MaterialView', () => {
  // Phaserã‚·ãƒ¼ãƒ³ã®ãƒ¢ãƒƒã‚¯ãŒå¿…è¦ãªãƒ†ã‚¹ãƒˆ

  describe('ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤º', () => {
    it.skip('ç´ æã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // Phaserã‚·ãƒ¼ãƒ³ãƒ¢ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ãŸãƒ†ã‚¹ãƒˆ
    });

    it.skip('å€‹æ•°ãŒ1ã‚ˆã‚Šå¤§ãã„å ´åˆãƒãƒƒã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // å€‹æ•°è¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆ
    });

    it.skip('å“è³ªã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒæ­£ã—ã„è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // å“è³ªè‰²ã®ãƒ†ã‚¹ãƒˆ
    });
  });

  describe('è©³ç´°è¡¨ç¤º', () => {
    it.skip('ç´ æåãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // åå‰è¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆ
    });

    it.skip('å“è³ªãƒ†ã‚­ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // å“è³ªãƒ†ã‚­ã‚¹ãƒˆã®ãƒ†ã‚¹ãƒˆ
    });

    it.skip('å€‹æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹', () => {
      // å€‹æ•°è¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆ
    });
  });

  describe('ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³', () => {
    it.skip('ã‚¯ãƒªãƒƒã‚¯ã§onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã‚‹', () => {
      // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ
    });

    it.skip('ãƒ›ãƒãƒ¼ã§onHoverã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã‚‹', () => {
      // ãƒ›ãƒãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ
    });

    it.skip('setEnabledã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹åŒ–ã§ãã‚‹', () => {
      // ç„¡åŠ¹åŒ–ã®ãƒ†ã‚¹ãƒˆ
    });
  });

  describe('çŠ¶æ…‹ç®¡ç†', () => {
    it.skip('setCountã§å€‹æ•°ã‚’æ›´æ–°ã§ãã‚‹', () => {
      // å€‹æ•°æ›´æ–°ã®ãƒ†ã‚¹ãƒˆ
    });

    it.skip('setSelectedã§é¸æŠçŠ¶æ…‹ã‚’å¤‰æ›´ã§ãã‚‹', () => {
      // é¸æŠçŠ¶æ…‹ã®ãƒ†ã‚¹ãƒˆ
    });
  });
});
```

### 2. ç´ æã‚«ãƒ†ã‚´ãƒªçµµæ–‡å­—ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤º*

```typescript
describe('ç´ æã‚«ãƒ†ã‚´ãƒªçµµæ–‡å­—', () => {
  const categoryEmojis: Record<string, string> = {
    'plant': 'ğŸŒ¿',
    'mineral': 'ğŸ’',
    'liquid': 'ğŸ’§',
    'powder': 'âœ¨',
    'monster': 'ğŸ¦´',
  };

  it('å„ã‚«ãƒ†ã‚´ãƒªã«å¯¾å¿œã™ã‚‹çµµæ–‡å­—ãŒã‚ã‚‹', () => {
    Object.entries(categoryEmojis).forEach(([category, emoji]) => {
      expect(emoji).toBeDefined();
      expect(emoji.length).toBeGreaterThan(0);
    });
  });

  it('æœªå®šç¾©ã‚«ãƒ†ã‚´ãƒªã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçµµæ–‡å­—ã‚’è¿”ã™', () => {
    // å®Ÿéš›ã®MaterialViewå®Ÿè£…ã§ãƒ†ã‚¹ãƒˆ
    const defaultEmoji = 'ğŸ“¦';
    expect(defaultEmoji).toBeDefined();
  });
});
```

### 3. ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ†ã‚¹ãƒˆç”¨ã‚·ãƒ¼ãƒ³ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *æ‰‹å‹•ç¢ºèªç”¨*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/phaser/scenes/MaterialViewTestScene.ts`

```typescript
import { BaseGameScene, SceneInitData } from './BaseGameScene';
import { MaterialView } from '../ui/material/MaterialView';
import { Material } from '../../../domain/material/Material';

export class MaterialViewTestScene extends BaseGameScene {
  constructor() {
    super('MaterialViewTestScene' as any);
  }

  protected onInit(data?: SceneInitData): void {}
  protected onPreload(): void {}

  protected onCreate(data?: SceneInitData): void {
    // å„å“è³ªã®ç´ æã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤ºã§ä¸¦ã¹ã‚‹
    const materials = this.createTestMaterials();
    let x = 100;
    let y = 100;

    materials.forEach((material, index) => {
      // ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤º
      new MaterialView(this, {
        material,
        x,
        y,
        mode: 'compact',
        count: index + 1,
        showQuality: true,
        interactive: true,
        onClick: (m) => console.log(`Clicked: ${m.name}`),
      });

      // è©³ç´°è¡¨ç¤º
      new MaterialView(this, {
        material,
        x: 300,
        y,
        mode: 'detail',
        count: index + 1,
        showQuality: true,
        interactive: true,
      });

      y += 80;
    });
  }

  private createTestMaterials(): Material[] {
    // å„å“è³ªã®ãƒ†ã‚¹ãƒˆç´ æã‚’ç”Ÿæˆ
    return [
      // Material.create(...) ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
    ];
  }

  protected setupEventListeners(): void {}
}
```

---

## å®Ÿè£…æ‰‹é †

1. `/tsumiki:tdd-requirements TASK-0200` - è©³ç´°è¦ä»¶å®šç¾©
2. `/tsumiki:tdd-testcases` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä½œæˆ
3. `/tsumiki:tdd-red` - ãƒ†ã‚¹ãƒˆå®Ÿè£…ï¼ˆå¤±æ•—ï¼‰
4. `/tsumiki:tdd-green` - æœ€å°å®Ÿè£…
5. `/tsumiki:tdd-refactor` - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
6. `/tsumiki:tdd-verify-complete` - å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- Phaserã«ä¾å­˜ã—ãªã„éƒ¨åˆ†ã®ãƒ†ã‚¹ãƒˆã‚’å„ªå…ˆ
- å“è³ªè‰²ã®ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£
- ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ†ã‚¹ãƒˆã®é‡è¦æ€§

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 3é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 0é …ç›® (0%)
- ğŸŸ¡ **é»„ä¿¡å·**: 3é …ç›® (100%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: ä¸­å“è³ª
