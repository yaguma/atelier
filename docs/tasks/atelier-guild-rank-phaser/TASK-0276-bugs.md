# TASK-0276: 最終動作確認（後半機能）- 不具合リスト

**確認日**: 2026-01-14
**確認者**: Claude

---

## 確認結果サマリー

### 1. 納品フェーズ確認

| No | 確認項目 | 結果 | 備考 |
|----|---------|------|------|
| 5-1〜5-10 | 全項目 | ❌ | フェーズ遷移不可のため未確認（BUG-0001依存） |

### 2. 日終了処理確認

| No | 確認項目 | 結果 | 備考 |
|----|---------|------|------|
| 6-1〜6-9 | 全項目 | ❌ | フェーズ遷移不可のため未確認（BUG-0001依存） |

### 3. ショップ確認

| No | 確認項目 | 結果 | 備考 |
|----|---------|------|------|
| 7-1 | ショップ表示 | ✅ | ショップ画面が表示される |
| 7-2 | カードタブ | ✅ | カード一覧が表示（2件） |
| 7-3 | 素材タブ | ⏭️ | タブなし（未実装） |
| 7-4 | アーティファクトタブ | ✅ | アーティファクト一覧が表示（1件） |
| 7-5 | 価格表示 | ✅ | 各アイテムの価格が表示 |
| 7-6 | 購入可能判定 | ✅ | ボタンは有効化されている |
| 7-7 | 購入不可表示 | ⏭️ | 未確認 |
| 7-8 | カード購入 | ❌ | **BUG-0003** - 購入処理が動作しない |
| 7-9 | 素材購入 | ❌ | 未実装 |
| 7-10 | ゴールド減少 | ❌ | 購入不可のため未確認 |
| 7-11 | 閉じるボタン | ✅ | メイン画面に戻れる |

### 4. 昇格試験確認

| No | 確認項目 | 結果 | 備考 |
|----|---------|------|------|
| 8-1〜8-9 | 全項目 | ❌ | フェーズ遷移・ゲーム進行不可のため未確認 |

### 5. ゲームクリア/ゲームオーバー確認

| No | 確認項目 | 結果 | 備考 |
|----|---------|------|------|
| 9-1〜9-6 | 全項目 | ❌ | ゲーム進行不可のため未確認 |

### 6. セーブ・ロード確認

| No | 確認項目 | 結果 | 備考 |
|----|---------|------|------|
| 10-1〜10-10 | 全項目 | ❌ | セーブUI未実装のため未確認 |

---

## 不具合詳細

### BUG-0003: ショップで購入処理が動作しない

**発生箇所**: ショップ画面
**確認項目No**: 7-8
**現象**: 商品を選択して「購入する」ボタンをクリックしても購入処理が実行されない
**再現手順**:
1. メイン画面でショップボタンをクリック
2. カードタブの「森の採取」をクリック
3. 「購入する」ボタンをクリック

**期待結果**: ゴールドが50G減少し、カードがデッキに追加される
**実際の結果**: ゴールドは100Gのまま、何も起こらない
**原因分析**:
- `ShopScreen.onPurchase()` コールバックが `index.ts` で設定されていない

**優先度**: 中
**修正方針**: `index.ts` で `shopScreen.onPurchase()` コールバックを設定し、購入処理を実装する

---

### BUG-0004: 画面遷移時にDOM要素が重複する（軽微）

**発生箇所**: 画面遷移時
**確認項目No**: -
**現象**: ショップ画面からメイン画面に戻った際、DOM上にヘッダーやナビゲーションが重複して存在する
**再現手順**:
1. メイン画面でショップボタンをクリック
2. ショップ画面で「← 戻る」ボタンをクリック
3. DOM構造を確認

**期待結果**: DOM要素が正しくクリーンアップされている
**実際の結果**: banner、navigationが2つずつ存在
**原因分析**:
- ScreenManagerの画面切り替え時にDOMのクリーンアップが不完全

**優先度**: 低
**修正方針**: ScreenManagerの画面切り替えロジックを見直し、古い要素を確実に削除する

---

## ブロッカー不具合（TASK-0275から継承）

以下の不具合が修正されるまで、後半機能の大半が確認不可：

- **BUG-0001**: 次のフェーズへボタンが動作しない（高優先度）
- **BUG-0002**: フェーズインジケーターのクリックが動作しない（中優先度）

---

## 確認環境

- **ブラウザ**: Chromium (Playwright)
- **開発サーバー**: Vite dev server (localhost:3001)
- **コンソールエラー**: なし

---

## 次のアクション

1. TASK-0277 でBUG-0001, BUG-0002を優先的に修正
2. フェーズ遷移が可能になったら、後半機能の確認を再実施
3. BUG-0003, BUG-0004も併せて修正
