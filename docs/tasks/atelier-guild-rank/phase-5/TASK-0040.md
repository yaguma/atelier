# TASK-0040: ã‚µã‚¤ãƒ‰ãƒãƒ¼æŠ˜ã‚ŠãŸãŸã¿ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

**ã‚¿ã‚¹ã‚¯ID**: TASK-0040
**ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—**: DIRECT
**æ¨å®šå·¥æ•°**: 4æ™‚é–“
**ãƒ•ã‚§ãƒ¼ã‚º**: Phase 5 - UIå¼·åŒ–ãƒ»ãƒãƒªãƒƒã‚·ãƒ¥
**ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«**: ğŸŸ¡ *TASK-0020ã®æ¨å¥¨æ¡ä»¶ã‚ˆã‚Š*

## é–¢é€£æ–‡æ›¸

- **æ¦‚è¦**: [ğŸ“‹ overview.md](../overview.md)
- **å…ƒã‚¿ã‚¹ã‚¯**: [ğŸ“‹ TASK-0020.md](../phase-3/TASK-0020.md) - MainSceneå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ¨å¥¨æ¡ä»¶
- **UIè¨­è¨ˆ**: [ğŸ“ ui-design/screens/main.md](../../design/atelier-guild-rank/ui-design/screens/main.md)

## ã‚¿ã‚¹ã‚¯æ¦‚è¦

MainSceneã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚ã‚‹å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå—æ³¨ä¾é ¼ã€ç´ æã€å®Œæˆå“ï¼‰ã®æŠ˜ã‚ŠãŸãŸã¿/å±•é–‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã™ã‚‹ã€‚ã‚¹ãƒ ãƒ¼ã‚ºãªé–‹é–‰å‹•ä½œã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚

## ä¾å­˜ã‚¿ã‚¹ã‚¯

- **å‰æã‚¿ã‚¹ã‚¯**: [TASK-0020: MainSceneå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ](../phase-3/TASK-0020.md) âœ…å®Œäº†
- **å¾Œç¶šã‚¿ã‚¹ã‚¯**: ãªã—ï¼ˆç‹¬ç«‹ã‚¿ã‚¹ã‚¯ï¼‰

## å®Œäº†æ¡ä»¶

- [x] ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¯ãƒªãƒƒã‚¯ã§æŠ˜ã‚ŠãŸãŸã¿/å±•é–‹
- [x] é«˜ã•å¤‰åŒ–ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè£…
- [x] ã‚¢ã‚¤ã‚³ãƒ³å›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆâ–¼/â–¶ï¼‰
- [x] æŠ˜ã‚ŠãŸãŸã¿çŠ¶æ…‹ã®ä¿æŒ
- [x] å‹•ä½œç¢ºèªå®Œäº†

---

## å®Ÿè£…è©³ç´°

### 1. æŠ˜ã‚ŠãŸãŸã¿/å±•é–‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *TASK-0020è¨­è¨ˆã‹ã‚‰æ¨æ¸¬*

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/presentation/ui/main/SidebarUI.ts`

```typescript
// æŠ˜ã‚ŠãŸãŸã¿ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
private toggleSection(section: SidebarSection): void {
  const isCollapsed = this.collapsedSections.has(section.id);

  if (isCollapsed) {
    this.expandSection(section);
  } else {
    this.collapseSection(section);
  }
}

private collapseSection(section: SidebarSection): void {
  this.scene.tweens.add({
    targets: section.content,
    height: 0,
    alpha: 0,
    duration: 200,
    ease: 'Power2',
    onComplete: () => {
      section.content.setVisible(false);
    },
  });

  // ã‚¢ã‚¤ã‚³ãƒ³å›è»¢
  this.scene.tweens.add({
    targets: section.icon,
    angle: -90,
    duration: 200,
  });

  this.collapsedSections.add(section.id);
}

private expandSection(section: SidebarSection): void {
  section.content.setVisible(true);

  this.scene.tweens.add({
    targets: section.content,
    height: section.originalHeight,
    alpha: 1,
    duration: 200,
    ease: 'Power2',
  });

  // ã‚¢ã‚¤ã‚³ãƒ³å›è»¢
  this.scene.tweens.add({
    targets: section.icon,
    angle: 0,
    duration: 200,
  });

  this.collapsedSections.delete(section.id);
}
```

### 2. ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼UI ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *æ—¢å­˜SidebarUIæ§‹é€ ã‹ã‚‰æ¨æ¸¬*

```typescript
interface SidebarSection {
  id: string;
  header: Phaser.GameObjects.Container;
  icon: Phaser.GameObjects.Text; // â–¼/â–¶ã‚¢ã‚¤ã‚³ãƒ³
  content: Phaser.GameObjects.Container;
  originalHeight: number;
}

private createSectionHeader(title: string, section: SidebarSection): void {
  const header = this.scene.add.container(0, 0);

  // ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆâ–¼ï¼‰
  section.icon = this.scene.add.text(0, 0, 'â–¼', {
    fontSize: '12px',
  });

  // ã‚¿ã‚¤ãƒˆãƒ«
  const titleText = this.scene.add.text(20, 0, title, {
    fontSize: '14px',
    color: '#333333',
  });

  header.add([section.icon, titleText]);
  header.setInteractive({ useHandCursor: true });
  header.on('pointerdown', () => this.toggleSection(section));

  section.header = header;
}
```

### 3. çŠ¶æ…‹ä¿æŒ ğŸŸ¡

**ä¿¡é ¼æ€§**: ğŸŸ¡ *æ¨™æº–çš„ãªUIãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰æ¨æ¸¬*

```typescript
private collapsedSections: Set<string> = new Set();

// çŠ¶æ…‹ã®ä¿å­˜
saveCollapsedState(): void {
  const state = Array.from(this.collapsedSections);
  localStorage.setItem('sidebar-collapsed', JSON.stringify(state));
}

// çŠ¶æ…‹ã®å¾©å…ƒ
loadCollapsedState(): void {
  const saved = localStorage.getItem('sidebar-collapsed');
  if (saved) {
    const state = JSON.parse(saved) as string[];
    this.collapsedSections = new Set(state);
  }
}
```

---

## å®Ÿè£…æ‰‹é †

### DIRECTã‚¿ã‚¹ã‚¯ã®å ´åˆ

1. `/tsumiki:direct-setup` - ç›´æ¥å®Ÿè£…ãƒ»è¨­å®š
2. `/tsumiki:direct-verify` - å‹•ä½œç¢ºèªãƒ»å“è³ªç¢ºèª

---

## æ³¨æ„äº‹é …

- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã®é€£ç¶šã‚¯ãƒªãƒƒã‚¯ã‚’é˜²æ­¢ã™ã‚‹
- æŠ˜ã‚ŠãŸãŸã¿çŠ¶æ…‹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã™ã‚‹
- ä»–ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨ã®é«˜ã•èª¿æ•´ã«æ³¨æ„

---

## ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«ã‚µãƒãƒªãƒ¼

- **ç·é …ç›®æ•°**: 3é …ç›®
- ğŸ”µ **é’ä¿¡å·**: 0é …ç›® (0%)
- ğŸŸ¡ **é»„ä¿¡å·**: 3é …ç›® (100%)
- ğŸ”´ **èµ¤ä¿¡å·**: 0é …ç›® (0%)

**å“è³ªè©•ä¾¡**: é«˜å“è³ª
