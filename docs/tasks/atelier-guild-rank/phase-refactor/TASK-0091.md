# TASK-0091: features/rank/types作成

## 基本情報

| 項目 | 値 |
|------|-----|
| **タスクID** | TASK-0091 |
| **タスク名** | features/rank/types作成 |
| **見積時間** | 4時間 |
| **依存タスク** | TASK-0064 |
| **開発タイプ** | TDD |
| **フェーズ** | Phase 9 - features/rank機能 |
| **状態** | 🔲 未着手 |

---

## 概要

### 背景

ランク機能はギルドランクの管理、昇格判定、特殊ルール適用を担当する重要な機能である。Feature-Based Architectureへの移行に伴い、ランク関連の型定義を`src/features/rank/types/`に集約する必要がある。

### 目的

ランク機能の型定義を作成し、IRankServiceインターフェース、GuildRank、SpecialRule関連の型を移動・整理する。

### 現状

- 型定義が複数の場所に分散している可能性
- ランク固有の型と汎用的な型が混在している可能性

---

## 要件

### 機能要件

| 要件ID | 要件 | 信頼性 |
|--------|------|--------|
| REQ-091-01 | IRankServiceインターフェースを`features/rank/types/`に移動する | 🔵 |
| REQ-091-02 | GuildRank型を定義・移動する | 🔵 |
| REQ-091-03 | SpecialRule型を定義・移動する | 🔵 |
| REQ-091-04 | RankProgress型を定義する | 🔵 |
| REQ-091-05 | 型エクスポートのindex.tsを作成する | 🔵 |

### 非機能要件

| 要件ID | 要件 |
|--------|------|
| NFR-091-01 | 既存のテストがすべてパスすること |
| NFR-091-02 | 型定義が正しくエクスポートされていること |
| NFR-091-03 | 循環参照が発生しないこと |

---

## テストケース

### 型エクスポートテスト

```typescript
describe('features/rank/types', () => {
  describe('GuildRank型', () => {
    it('GuildRank型が正しくエクスポートされること', () => {});
    it('ランクレベル（E〜S）が定義されていること', () => {});
  });

  describe('SpecialRule型', () => {
    it('SpecialRule型が正しくエクスポートされること', () => {});
    it('ルール種別が定義されていること', () => {});
  });

  describe('RankProgress型', () => {
    it('RankProgress型が正しくエクスポートされること', () => {});
    it('進捗率や必要ポイントが定義されていること', () => {});
  });

  describe('サービスインターフェース', () => {
    it('IRankServiceが正しくエクスポートされること', () => {});
    it('必要なメソッドシグネチャが定義されていること', () => {});
  });
});
```

---

## 実装計画

### ステップ1: 現状調査（1時間）

1. 既存のランク関連型定義を確認
2. 既存のサービスインターフェースを確認
3. 依存関係を調査

### ステップ2: 型定義作成（2時間）

1. `src/features/rank/types/`にファイルを作成
2. GuildRank.ts、SpecialRule.tsを作成
3. service-interfaces.tsを作成

### ステップ3: エクスポート整理（1時間）

1. index.tsを作成してエクスポートを集約
2. 既存のインポートパスを更新
3. テスト実行・確認

---

## 対象ファイル

- `src/features/rank/types/GuildRank.ts` - 新規作成
- `src/features/rank/types/SpecialRule.ts` - 新規作成
- `src/features/rank/types/RankProgress.ts` - 新規作成
- `src/features/rank/types/service-interfaces.ts` - 新規作成
- `src/features/rank/types/index.ts` - 新規作成

---

## 受け入れ条件

- [ ] IRankServiceインターフェースが`features/rank/types/`に存在する
- [ ] GuildRank型が定義されている
- [ ] SpecialRule型が定義されている
- [ ] RankProgress型が定義されている
- [ ] 型がindex.tsから正しくエクスポートされている
- [ ] 全テストがパスする
- [ ] `pnpm lint`がエラーなしで完了する

---

## 関連ドキュメント

- **TASK-0064**: shared/types移行と整理
- **TASK-0092**: features/rank/services作成
- **設計文書**: `.claude/rules/architecture.md`

---

## 信頼性レベルサマリー

### 項目別信頼性

| カテゴリ | 🔵 青 | 🟡 黄 | 🔴 赤 | 合計 |
|---------|-------|-------|-------|------|
| 機能要件 | 5 | 0 | 0 | 5 |
| テストケース | 0 | 0 | 0 | 0 |

### 全体評価

- **総項目数**: 5項目
- 🔵 **青信号**: 5項目 (100%) - 既存実装に基づく
- 🟡 **黄信号**: 0項目 (0%)
- 🔴 **赤信号**: 0項目 (0%)

**品質評価**: 良好（既存実装の移動が中心のため信頼性が高い）

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-02-09 | 初版作成 |
