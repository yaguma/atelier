# TASK-0071: features/deck/index.ts公開API作成

## 基本情報

| 項目 | 値 |
|------|-----|
| **タスクID** | TASK-0071 |
| **タスク名** | features/deck/index.ts公開API作成 |
| **見積時間** | 4時間 |
| **依存タスク** | TASK-0070 |
| **開発タイプ** | DIRECT |
| **フェーズ** | Phase 3 - features/deck機能 |
| **状態** | 🔲 未着手 |

---

## 概要

### 背景

features/deckモジュールの公開APIを明確に定義し、内部実装を隠蔽する必要がある。.claude/rules/architecture.mdに従い、feature単位でのモジュール境界を確立する。

### 目的

デッキ機能の公開APIを`src/features/deck/index.ts`で定義し、外部からのアクセスを制御する。

### 現状

- types/, services/, components/が作成されている（TASK-0068〜0070）
- 公開APIが未定義

---

## 要件

### 機能要件

| 要件ID | 要件 | 信頼性 |
|--------|------|--------|
| REQ-071-01 | 公開する型をindex.tsからexportする | 🔵 |
| REQ-071-02 | 公開する純粋関数をindex.tsからexportする | 🔵 |
| REQ-071-03 | 公開するコンポーネントをindex.tsからexportする | 🔵 |
| REQ-071-04 | 内部実装の詳細を隠蔽する | 🔵 |

### 非機能要件

| 要件ID | 要件 |
|--------|------|
| NFR-071-01 | 公開APIの一貫性が保たれていること |
| NFR-071-02 | 内部実装への直接アクセスが防止されていること |
| NFR-071-03 | ドキュメントで公開APIが明記されていること |

---

## 実装計画

### ステップ1: API設計（1時間）

1. 公開する型のリスト作成
2. 公開する関数のリスト作成
3. 公開するコンポーネントのリスト作成

### ステップ2: index.ts実装（1時間）

1. 型エクスポート追加
2. 関数エクスポート追加
3. コンポーネントエクスポート追加

### ステップ3: 内部隠蔽確認（1時間）

1. 内部実装への直接アクセス箇所を特定
2. 公開API経由に変更
3. lint設定で内部アクセス防止（可能であれば）

### ステップ4: ドキュメント・テスト（1時間）

1. APIドキュメント作成
2. エクスポートテスト作成
3. 全テストパスの確認

---

## 公開API設計

### Types

```typescript
// 公開する型
export type { Card, CardType, CardEffect } from './types';
export type { DeckState, DrawResult, PlayCardResult } from './types';
export type { IDeckService } from './types';
```

### Services

```typescript
// 公開する純粋関数
export { shuffle, draw, playCard } from './services';
export { createDeckState, resetDeck } from './services';
```

### Components

```typescript
// 公開するコンポーネント
export { CardUI } from './components';
export { HandDisplay } from './components';
export { DraggableCardUI } from './components';
```

---

## 移行後のファイル構造

```
src/features/deck/
├── types/
│   └── index.ts        # 内部エクスポート
├── services/
│   └── index.ts        # 内部エクスポート
├── components/
│   └── index.ts        # 内部エクスポート
└── index.ts            # 公開API（このタスクで作成）
```

---

## 対象ファイル

### 作成

- `src/features/deck/index.ts`

### 更新対象

- features/deckを使用している全ファイル（公開API経由に変更）
- tsconfig.jsonのパスエイリアス設定

---

## 受け入れ条件

- [ ] src/features/deck/index.tsが作成されている
- [ ] 公開する型がexportされている
- [ ] 公開する関数がexportされている
- [ ] 公開するコンポーネントがexportされている
- [ ] 内部実装への直接アクセスがないこと
- [ ] 全テストがパスする
- [ ] `pnpm lint`がエラーなしで完了する

---

## 関連ドキュメント

- **TASK-0070**: features/deck/components作成
- **設計文書**: `.claude/rules/architecture.md`

---

## 信頼性レベルサマリー

### 項目別信頼性

| カテゴリ | 🔵 青 | 🟡 黄 | 🔴 赤 | 合計 |
|---------|-------|-------|-------|------|
| 機能要件 | 4 | 0 | 0 | 4 |
| テストケース | 0 | 0 | 0 | 0 |

### 全体評価

- **総項目数**: 4項目
- 🔵 **青信号**: 4項目 (100%) - .claude/rules/architecture.mdに基づく
- 🟡 **黄信号**: 0項目 (0%)
- 🔴 **赤信号**: 0項目 (0%)

**品質評価**: 良好（設計文書に基づく明確なAPI定義）

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-02-09 | 初版作成 |
