# TASK-0065: shared/utils移行

## 基本情報

| 項目 | 値 |
|------|-----|
| **タスクID** | TASK-0065 |
| **タスク名** | shared/utils移行 |
| **見積時間** | 4時間 |
| **依存タスク** | TASK-0062 |
| **開発タイプ** | TDD |
| **フェーズ** | Phase 2 - shared移行 |
| **状態** | 🔲 未着手 |

---

## 概要

### 背景

共有ユーティリティ関数は複数の機能から使用される純粋関数であり、shared/utilsに配置されるべきである。現在のsrc/shared/utils/の内容を確認し、適切に整理する必要がある。

### 目的

既存のsrc/shared/utilsを確認・整理し、純粋関数として適切に実装されていることを確認する。

### 現状

- src/shared/utils/にid-generator.tsが存在
- 追加ユーティリティの必要性を確認する必要がある

---

## 要件

### 機能要件

| 要件ID | 要件 | 信頼性 |
|--------|------|--------|
| REQ-065-01 | id-generator.tsの動作を確認する | 🔵 |
| REQ-065-02 | 追加ユーティリティの必要性を確認する | 🔵 |
| REQ-065-03 | 純粋関数としての実装を確認する | 🔵 |
| REQ-065-04 | ユーティリティ関数のテストを確認・追加する | 🔵 |

### 非機能要件

| 要件ID | 要件 |
|--------|------|
| NFR-065-01 | 全ユーティリティ関数が純粋関数であること |
| NFR-065-02 | ユーティリティ関数のテストがパスすること |
| NFR-065-03 | 副作用がないこと |

---

## テストケース

### ユーティリティ関数テスト

```typescript
describe('shared/utils', () => {
  describe('id-generator', () => {
    it('一意のIDが生成されること', () => {});
    it('連続呼び出しで異なるIDが返されること', () => {});
    it('生成されたIDが期待フォーマットに従うこと', () => {});
  });

  describe('純粋関数の確認', () => {
    it('同じ入力に対して同じ出力が返されること', () => {});
    it('外部状態に依存しないこと', () => {});
  });
});
```

---

## 実装計画

### ステップ1: 現状調査（1時間）

1. src/shared/utils/内の全ファイルを確認
2. 各ユーティリティ関数の使用箇所を調査
3. 既存テストの確認

### ステップ2: 純粋関数検証（1時間）

1. 各関数の副作用有無を確認
2. 外部状態への依存を確認
3. 必要に応じてリファクタリング計画

### ステップ3: テスト確認・追加（2時間）

1. 既存テストの実行
2. カバレッジ不足箇所の特定
3. 追加テストの作成

---

## 対象ファイル

- `src/shared/utils/id-generator.ts` - 確認対象
- `src/shared/utils/index.ts` - エクスポート確認
- `tests/unit/shared/utils/` - テスト確認・追加

---

## 受け入れ条件

- [ ] id-generator.tsの動作が確認されている
- [ ] 純粋関数としての実装が確認されている
- [ ] ユーティリティ関数のテストがパスする
- [ ] 必要な追加ユーティリティが特定されている
- [ ] `pnpm lint`がエラーなしで完了する

---

## 関連ドキュメント

- **TASK-0062**: 共有レイヤー基盤作成
- **設計文書**: `.claude/rules/architecture.md`

---

## 信頼性レベルサマリー

### 項目別信頼性

| カテゴリ | 🔵 青 | 🟡 黄 | 🔴 赤 | 合計 |
|---------|-------|-------|-------|------|
| 機能要件 | 4 | 0 | 0 | 4 |
| テストケース | 0 | 0 | 0 | 0 |

### 全体評価

- **総項目数**: 4項目
- 🔵 **青信号**: 4項目 (100%) - 現在の実装に基づく
- 🟡 **黄信号**: 0項目 (0%)
- 🔴 **赤信号**: 0項目 (0%)

**品質評価**: 良好（既存実装の確認が中心のため信頼性が高い）

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2026-02-09 | 初版作成 |
