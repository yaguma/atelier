# TASK-0052: MainSceneãƒ•ã‚§ãƒ¼ã‚ºUIçµ±åˆå®Œæˆ

## åŸºæœ¬æƒ…å ±

| é …ç›® | å€¤ |
|------|-----|
| **ã‚¿ã‚¹ã‚¯ID** | TASK-0052 |
| **ã‚¿ã‚¹ã‚¯å** | MainSceneãƒ•ã‚§ãƒ¼ã‚ºUIçµ±åˆå®Œæˆ |
| **è¦‹ç©æ™‚é–“** | 6æ™‚é–“ |
| **ä¾å­˜ã‚¿ã‚¹ã‚¯** | TASK-0048, TASK-0049 |
| **é–‹ç™ºã‚¿ã‚¤ãƒ—** | TDD |
| **çŠ¶æ…‹** | ğŸ”² æœªç€æ‰‹ |

---

## æ¦‚è¦

### èƒŒæ™¯

MainSceneã«ã¯4åˆ†å‰²ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆHeaderã€Sidebarã€Footerã€Contentï¼‰ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŒã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã¸ã®å„ãƒ•ã‚§ãƒ¼ã‚ºUIï¼ˆQuestAcceptPhaseUIã€GatheringPhaseUIã€AlchemyPhaseUIã€DeliveryPhaseUIï¼‰ã®çµ±åˆãŒä¸å®Œå…¨ã§ã‚ã‚‹ã€‚ãƒ•ã‚§ãƒ¼ã‚ºå¯è¦–æ€§ç®¡ç†ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯å­˜åœ¨ã™ã‚‹ãŒã€å®Ÿéš›ã®ãƒ•ã‚§ãƒ¼ã‚ºUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆãƒ»è¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã€‚

### ç›®çš„

MainSceneã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã«å„ãƒ•ã‚§ãƒ¼ã‚ºUIã‚’çµ±åˆã—ã€ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»æ™‚ã«é©åˆ‡ãªUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

### ç¾çŠ¶

- `showPhase()`ãƒ¡ã‚½ãƒƒãƒ‰: ãƒ•ãƒ©ã‚°ç®¡ç†ã®ã¿ã€å®Ÿéš›ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆãªã—
- `_phaseUIVisibility`: å¯è¦–æ€§ãƒ•ãƒ©ã‚°ã®ã¿
- `_contentContainer`: ç©ºã®ã‚³ãƒ³ãƒ†ãƒŠ

---

## è¦ä»¶

### æ©Ÿèƒ½è¦ä»¶

| è¦ä»¶ID | è¦ä»¶ | ä¿¡é ¼æ€§ |
|--------|------|--------|
| REQ-052-01 | å„ãƒ•ã‚§ãƒ¼ã‚ºUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒMainSceneå†…ã§ä½œæˆã•ã‚Œã‚‹ã“ã¨ | ğŸ”µ |
| REQ-052-02 | QUEST_ACCEPTãƒ•ã‚§ãƒ¼ã‚ºã§QuestAcceptPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ğŸ”µ |
| REQ-052-03 | GATHERINGãƒ•ã‚§ãƒ¼ã‚ºã§GatheringPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ğŸ”µ |
| REQ-052-04 | ALCHEMYãƒ•ã‚§ãƒ¼ã‚ºã§AlchemyPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ğŸ”µ |
| REQ-052-05 | DELIVERYãƒ•ã‚§ãƒ¼ã‚ºã§DeliveryPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ | ğŸ”µ |
| REQ-052-06 | ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»æ™‚ã«å‰ã®UIãŒéè¡¨ç¤ºã«ãªã‚‹ã“ã¨ | ğŸ”µ |
| REQ-052-07 | Footerã®ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã§ãƒ•ã‚§ãƒ¼ã‚ºãŒé·ç§»ã™ã‚‹ã“ã¨ | ğŸ”µ |

### éæ©Ÿèƒ½è¦ä»¶

| è¦ä»¶ID | è¦ä»¶ |
|--------|------|
| NFR-052-01 | ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»æ™‚ã®ã¡ã‚‰ã¤ããŒãªã„ã“ã¨ |
| NFR-052-02 | æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãŒã™ã¹ã¦ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ |
| NFR-052-03 | ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š |

---

## ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### MainSceneãƒ•ã‚§ãƒ¼ã‚ºUIçµ±åˆãƒ†ã‚¹ãƒˆ

```typescript
describe('MainScene ãƒ•ã‚§ãƒ¼ã‚ºUIçµ±åˆ', () => {
  describe('create()', () => {
    it('QuestAcceptPhaseUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {});
    it('GatheringPhaseUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {});
    it('AlchemyPhaseUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {});
    it('DeliveryPhaseUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚Œã‚‹ã“ã¨', () => {});
    it('åˆæœŸãƒ•ã‚§ãƒ¼ã‚ºã®UIã®ã¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {});
  });

  describe('showPhase()', () => {
    it('QUEST_ACCEPTæŒ‡å®šã§QuestAcceptPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {});
    it('GATHERINGæŒ‡å®šã§GatheringPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {});
    it('ALCHEMYæŒ‡å®šã§AlchemyPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {});
    it('DELIVERYæŒ‡å®šã§DeliveryPhaseUIãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨', () => {});
    it('ãƒ•ã‚§ãƒ¼ã‚ºå¤‰æ›´æ™‚ã«å‰ã®UIãŒéè¡¨ç¤ºã«ãªã‚‹ã“ã¨', () => {});
  });

  describe('ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»', () => {
    it('Footerã®ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ã‚§ãƒ¼ã‚ºãŒé·ç§»ã™ã‚‹ã“ã¨', () => {});
    it('PHASE_CHANGEDã‚¤ãƒ™ãƒ³ãƒˆãŒæ­£ã—ãç™ºç«ã™ã‚‹ã“ã¨', () => {});
    it('æœ€çµ‚ãƒ•ã‚§ãƒ¼ã‚ºå¾Œã«æ—¥ãŒçµ‚äº†ã™ã‚‹ã“ã¨', () => {});
  });
});
```

---

## å®Ÿè£…è¨ˆç”»

### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ•ã‚§ãƒ¼ã‚ºUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆï¼ˆ2æ™‚é–“ï¼‰

1. å„ãƒ•ã‚§ãƒ¼ã‚ºUIã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¿½åŠ 
2. create()å†…ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
3. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚³ãƒ³ãƒ†ãƒŠã¸ã®è¿½åŠ 

### ã‚¹ãƒ†ãƒƒãƒ—2: è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…ï¼ˆ2æ™‚é–“ï¼‰

1. showPhase()ãƒ¡ã‚½ãƒƒãƒ‰ã®æ‹¡å¼µ
2. setVisible()ã‚’ä½¿ã£ãŸå®Ÿéš›ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
3. éè¡¨ç¤ºæ™‚ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ç„¡åŠ¹åŒ–

### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»é€£æºï¼ˆ2æ™‚é–“ï¼‰

1. Footerã®ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã¸ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­å®š
2. GameFlowManagerã¨ã®é€£æº
3. EventBusçµŒç”±ã®é€šçŸ¥ç¢ºèª

---

## è¨­è¨ˆä»•æ§˜

### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã®ã‚µã‚¤ã‚º

```typescript
const contentBounds = {
  x: LAYOUT.SIDEBAR_WIDTH,          // 200
  y: LAYOUT.HEADER_HEIGHT,          // 60
  width: screenWidth - LAYOUT.SIDEBAR_WIDTH,
  height: screenHeight - LAYOUT.HEADER_HEIGHT - LAYOUT.FOOTER_HEIGHT,
};
```

### ãƒ•ã‚§ãƒ¼ã‚ºUIã®é…ç½®

å„ãƒ•ã‚§ãƒ¼ã‚ºUIã¯`_contentContainer`ã®å­è¦ç´ ã¨ã—ã¦è¿½åŠ ã•ã‚Œã€åº§æ¨™ã¯(0, 0)ã‹ã‚‰é–‹å§‹ï¼ˆã‚³ãƒ³ãƒ†ãƒŠè‡ªä½“ãŒã‚ªãƒ•ã‚»ãƒƒãƒˆæ¸ˆã¿ï¼‰ã€‚

### è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆã®å®Ÿè£…

```typescript
private phaseUIs: Map<GamePhase, BasePhaseUI> = new Map();

showPhase(phase: GamePhase): void {
  // ã™ã¹ã¦ã®ãƒ•ã‚§ãƒ¼ã‚ºUIã‚’éè¡¨ç¤º
  for (const ui of this.phaseUIs.values()) {
    ui.setVisible(false);
  }

  // æŒ‡å®šãƒ•ã‚§ãƒ¼ã‚ºã®UIã‚’è¡¨ç¤º
  const targetUI = this.phaseUIs.get(phase);
  if (targetUI) {
    targetUI.setVisible(true);
  }

  this._currentVisiblePhase = phase;
}
```

---

## å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

- `src/presentation/scenes/MainScene.ts` - ãƒ¡ã‚¤ãƒ³ä¿®æ­£å¯¾è±¡
- `src/presentation/ui/phases/QuestAcceptPhaseUI.ts`
- `src/presentation/ui/phases/GatheringPhaseUI.ts`
- `src/presentation/ui/phases/AlchemyPhaseUI.ts`
- `src/presentation/ui/phases/DeliveryPhaseUI.ts`

---

## å—ã‘å…¥ã‚Œæ¡ä»¶

- [ ] å„ãƒ•ã‚§ãƒ¼ã‚ºUIã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒMainSceneå†…ã§ä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»æ™‚ã«æ­£ã—ã„UIãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] å‰ã®ãƒ•ã‚§ãƒ¼ã‚ºUIãŒç¢ºå®Ÿã«éè¡¨ç¤ºã«ãªã‚‹
- [ ] ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã§ãƒ•ã‚§ãƒ¼ã‚ºé·ç§»ãŒå‹•ä½œã™ã‚‹
- [ ] å…¨ãƒ•ã‚§ãƒ¼ã‚ºã‚’é€šã—ã¦ã‚²ãƒ¼ãƒ ãŒæ­£å¸¸ã«é€²è¡Œã™ã‚‹
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š
- [ ] `pnpm lint`ãŒã‚¨ãƒ©ãƒ¼ãªã—ã§å®Œäº†ã™ã‚‹

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **MainScene**: `src/presentation/scenes/MainScene.ts`
- **TASK-0046**: MainSceneå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå®Ÿè£…
- **TASK-0047**: å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¦–è¦šå®Ÿè£…
- **ãƒ•ã‚§ãƒ¼ã‚ºUIè¨­è¨ˆ**: `docs/design/atelier-guild-rank/ui-design/screens/phases/`

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|------|---------|
| 2026-01-22 | åˆç‰ˆä½œæˆ |
