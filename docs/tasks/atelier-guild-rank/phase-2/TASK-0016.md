# TASK-0016: ShopServiceãƒ»ArtifactServiceå®Ÿè£…

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆæ—¥**: 2026-01-16
**ãƒ•ã‚§ãƒ¼ã‚º**: 2 - ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ãƒ»ã‚³ã‚¢ã‚µãƒ¼ãƒ“ã‚¹
**è¦‹ç©æ™‚é–“**: 4æ™‚é–“ï¼ˆåŠæ—¥ï¼‰
**ä¾å­˜ã‚¿ã‚¹ã‚¯**: TASK-0005, TASK-0015

---

## 1. ã‚¿ã‚¹ã‚¯æ¦‚è¦

| é …ç›® | å€¤ |
|------|-----|
| **ã‚¿ã‚¹ã‚¯ID** | TASK-0016 |
| **ã‚¿ã‚¹ã‚¯å** | ShopServiceãƒ»ArtifactServiceå®Ÿè£… |
| **ã‚«ãƒ†ã‚´ãƒª** | ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ |
| **å„ªå…ˆåº¦** | ä¸­ |
| **æ‹…å½“ãƒ¬ã‚¤ãƒ¤ãƒ¼** | Application |

### ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«

- ğŸ”µ **é’ä¿¡å·**: è¨­è¨ˆæ–‡æ›¸ã«è¨˜è¼‰
- ğŸŸ¡ **é»„ä¿¡å·**: è¨­è¨ˆæ–‡æ›¸ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬
- ğŸ”´ **èµ¤ä¿¡å·**: è¨­è¨ˆæ–‡æ›¸ã«ãªã„æ¨æ¸¬

---

## 2. å®Ÿè£…å†…å®¹

### 2.1 ShopServiceã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ğŸ”µ

`src/domain/interfaces/shop-service.interface.ts`:

```typescript
export interface IShopService {
  // ã‚«ãƒ¼ãƒ‰è³¼å…¥
  getAvailableCards(rank: GuildRank): CardMaster[];
  purchaseCard(cardId: CardId): PurchaseResult;
  canAfford(cardId: CardId): boolean;

  // ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆè³¼å…¥
  getAvailableArtifacts(rank: GuildRank): ArtifactMaster[];
  purchaseArtifact(artifactId: ArtifactId): PurchaseResult;

  // ã‚¢ã‚¤ãƒ†ãƒ è²©å£²
  sellItem(itemInstanceId: string): SellResult;
  getSellPrice(item: ItemInstance): number;

  // ç´ æè²©å£²
  sellMaterial(materialInstanceId: string): SellResult;
  getMaterialSellPrice(material: MaterialInstance): number;
}

export interface PurchaseResult {
  success: boolean;
  remainingGold: number;
}

export interface SellResult {
  success: boolean;
  earnedGold: number;
}
```

### 2.2 ShopServiceå®Ÿè£… ğŸ”µ

`src/application/services/shop-service.ts`:

- ãƒ©ãƒ³ã‚¯ã«å¿œã˜ãŸå•†å“ã‚¢ãƒ³ãƒ­ãƒƒã‚¯
- è³¼å…¥å‡¦ç†ï¼ˆã‚´ãƒ¼ãƒ«ãƒ‰æ¶ˆè²»ã€ãƒ‡ãƒƒã‚­è¿½åŠ ï¼‰
- è²©å£²å‡¦ç†ï¼ˆã‚´ãƒ¼ãƒ«ãƒ‰ç²å¾—ã€ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªå‰Šé™¤ï¼‰

### 2.3 ArtifactServiceã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ğŸ”µ

`src/domain/interfaces/artifact-service.interface.ts`:

```typescript
export interface IArtifactService {
  // ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆåŠ¹æœ
  getActiveEffects(): ArtifactEffect[];
  applyEffect(artifactId: ArtifactId, context: EffectContext): void;

  // åŠ¹æœè¨ˆç®—
  calculateGatheringBonus(): number;
  calculateAlchemyBonus(): number;
  calculateGoldBonus(): number;

  // è£…å‚™çŠ¶æ…‹
  isEquipped(artifactId: ArtifactId): boolean;
}

export interface ArtifactEffect {
  type: ArtifactEffectType;
  value: number;
}

export type ArtifactEffectType =
  | 'gathering_bonus'
  | 'alchemy_quality_bonus'
  | 'gold_bonus'
  | 'action_point_bonus'
  | 'contribution_bonus';
```

### 2.4 ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆåŠ¹æœä¸€è¦§ ğŸ”µ

| ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ | åŠ¹æœ |
|---------------|------|
| æ¡å–ã®è­·ç¬¦ | æ¡å–æ•°+1 |
| éŒ¬é‡‘ã®æŒ‡è¼ª | å“è³ªè£œæ­£+1æ®µéš |
| å•†äººã®ãŠå®ˆã‚Š | å£²å´ä¾¡æ ¼+20% |
| ä½“åŠ›ã®è…•è¼ª | AP+1 |
| åå£°ã®ãƒšãƒ³ãƒ€ãƒ³ãƒˆ | è²¢çŒ®åº¦+10% |

---

## 3. å—ã‘å…¥ã‚ŒåŸºæº–

### 3.1 å¿…é ˆæ¡ä»¶ ğŸ”µ

- [ ] ã‚«ãƒ¼ãƒ‰ã®è³¼å…¥ãŒã§ãã‚‹
- [ ] ã‚´ãƒ¼ãƒ«ãƒ‰ä¸è¶³æ™‚ã¯è³¼å…¥ä¸å¯
- [ ] ã‚¢ã‚¤ãƒ†ãƒ ãƒ»ç´ æã®è²©å£²ãŒã§ãã‚‹
- [ ] ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆåŠ¹æœãŒé©ç”¨ã•ã‚Œã‚‹

### 3.2 æ¨å¥¨æ¡ä»¶ ğŸŸ¡

- [ ] ãƒ©ãƒ³ã‚¯ã«å¿œã˜ãŸå•†å“è§£æ”¾
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

---

## 4. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### 4.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

| ãƒ†ã‚¹ãƒˆID | ãƒ†ã‚¹ãƒˆå†…å®¹ | æœŸå¾…çµæœ |
|---------|----------|----------|
| T-0016-01 | ã‚«ãƒ¼ãƒ‰è³¼å…¥ï¼ˆè³‡é‡‘ååˆ†ï¼‰ | è³¼å…¥æˆåŠŸã€ã‚´ãƒ¼ãƒ«ãƒ‰æ¸›å°‘ |
| T-0016-02 | ã‚«ãƒ¼ãƒ‰è³¼å…¥ï¼ˆè³‡é‡‘ä¸è¶³ï¼‰ | è³¼å…¥å¤±æ•— |
| T-0016-03 | ã‚¢ã‚¤ãƒ†ãƒ è²©å£² | ã‚´ãƒ¼ãƒ«ãƒ‰å¢—åŠ ã€ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã‹ã‚‰å‰Šé™¤ |
| T-0016-04 | ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆåŠ¹æœ | ãƒœãƒ¼ãƒŠã‚¹è¨ˆç®—ãŒæ­£ã—ã„ |
| T-0016-05 | ãƒ©ãƒ³ã‚¯åˆ¶é™å•†å“ | ä½ãƒ©ãƒ³ã‚¯ã§ã¯è¡¨ç¤ºã•ã‚Œãªã„ |

---

## 5. æˆæœç‰©

| æˆæœç‰© | ãƒ‘ã‚¹ |
|--------|------|
| Shopã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | `/src/domain/interfaces/shop-service.interface.ts` |
| Shopå®Ÿè£… | `/src/application/services/shop-service.ts` |
| Artifactã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | `/src/domain/interfaces/artifact-service.interface.ts` |
| Artifactå®Ÿè£… | `/src/application/services/artifact-service.ts` |
| ãƒ†ã‚¹ãƒˆ | `/tests/unit/application/services/shop-service.test.ts` |
| ãƒ†ã‚¹ãƒˆ | `/tests/unit/application/services/artifact-service.test.ts` |

---

## é–¢é€£æ–‡æ›¸

- **ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ**: [../../design/atelier-guild-rank/data-schema-master-game.md](../../design/atelier-guild-rank/data-schema-master-game.md)
- **ã‚³ã‚¢ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆ**: [../../design/atelier-guild-rank/core-systems-core-services.md](../../design/atelier-guild-rank/core-systems-core-services.md)

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|----------|---------|
| 2026-01-16 | 1.0.0 | åˆç‰ˆä½œæˆ |
