# TASK-0015: InventoryServiceå®Ÿè£…

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆæ—¥**: 2026-01-16
**ãƒ•ã‚§ãƒ¼ã‚º**: 2 - ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ãƒ»ã‚³ã‚¢ã‚µãƒ¼ãƒ“ã‚¹
**è¦‹ç©æ™‚é–“**: 4æ™‚é–“ï¼ˆåŠæ—¥ï¼‰
**ä¾å­˜ã‚¿ã‚¹ã‚¯**: TASK-0010, TASK-0012

---

## 1. ã‚¿ã‚¹ã‚¯æ¦‚è¦

| é …ç›® | å€¤ |
|------|-----|
| **ã‚¿ã‚¹ã‚¯ID** | TASK-0015 |
| **ã‚¿ã‚¹ã‚¯å** | InventoryServiceå®Ÿè£… |
| **ã‚«ãƒ†ã‚´ãƒª** | ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ |
| **å„ªå…ˆåº¦** | é«˜ |
| **æ‹…å½“ãƒ¬ã‚¤ãƒ¤ãƒ¼** | Application |

### ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«

- ğŸ”µ **é’ä¿¡å·**: è¨­è¨ˆæ–‡æ›¸ã«è¨˜è¼‰
- ğŸŸ¡ **é»„ä¿¡å·**: è¨­è¨ˆæ–‡æ›¸ã‹ã‚‰å¦¥å½“ãªæ¨æ¸¬
- ğŸ”´ **èµ¤ä¿¡å·**: è¨­è¨ˆæ–‡æ›¸ã«ãªã„æ¨æ¸¬

---

## 2. å®Ÿè£…å†…å®¹

### 2.1 InventoryServiceã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ ğŸ”µ

`src/domain/interfaces/inventory-service.interface.ts`:

```typescript
export interface IInventoryService {
  // ç´ æç®¡ç†
  addMaterial(material: MaterialInstance): void;
  removeMaterial(instanceId: string): MaterialInstance | null;
  getMaterials(): MaterialInstance[];
  getMaterialsByCategory(category: MaterialCategory): MaterialInstance[];
  getMaterialCount(): number;

  // ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†
  addItem(item: ItemInstance): void;
  removeItem(instanceId: string): ItemInstance | null;
  getItems(): ItemInstance[];
  getItemsByType(itemId: ItemId): ItemInstance[];
  getItemCount(): number;

  // ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆç®¡ç†
  addArtifact(artifactId: ArtifactId): void;
  removeArtifact(artifactId: ArtifactId): boolean;
  getArtifacts(): ArtifactId[];
  hasArtifact(artifactId: ArtifactId): boolean;

  // æ¤œç´¢
  findMaterialById(instanceId: string): MaterialInstance | null;
  findItemById(instanceId: string): ItemInstance | null;

  // ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªæ“ä½œ
  clear(): void;
  getCapacity(): number;
  getRemainingCapacity(): number;
}
```

### 2.2 InventoryServiceå®Ÿè£… ğŸ”µ

`src/application/services/inventory-service.ts`:

```typescript
export class InventoryService implements IInventoryService {
  private materials: Map<string, MaterialInstance> = new Map();
  private items: Map<string, ItemInstance> = new Map();
  private artifacts: Set<ArtifactId> = new Set();

  private readonly MAX_MATERIALS = 99;
  private readonly MAX_ITEMS = 99;
  private readonly MAX_ARTIFACTS = 10;

  constructor(private eventBus: IEventBus) {}

  addMaterial(material: MaterialInstance): void {
    if (this.materials.size >= this.MAX_MATERIALS) {
      throw new Error('Material inventory full');
    }
    this.materials.set(material.instanceId, material);
  }

  removeMaterial(instanceId: string): MaterialInstance | null {
    const material = this.materials.get(instanceId);
    if (material) {
      this.materials.delete(instanceId);
    }
    return material ?? null;
  }

  getMaterials(): MaterialInstance[] {
    return Array.from(this.materials.values());
  }

  // ... ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…
}
```

### 2.3 ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªå®¹é‡ç®¡ç† ğŸŸ¡

- ç´ æ: æœ€å¤§99å€‹
- ã‚¢ã‚¤ãƒ†ãƒ : æœ€å¤§99å€‹
- ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆ: æœ€å¤§10å€‹

---

## 3. å—ã‘å…¥ã‚ŒåŸºæº–

### 3.1 å¿…é ˆæ¡ä»¶ ğŸ”µ

- [ ] ç´ æã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»å–å¾—ãŒã§ãã‚‹
- [ ] ã‚¢ã‚¤ãƒ†ãƒ ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»å–å¾—ãŒã§ãã‚‹
- [ ] ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆã®ç®¡ç†ãŒã§ãã‚‹
- [ ] å®¹é‡åˆ¶é™ãŒæ©Ÿèƒ½ã™ã‚‹

### 3.2 æ¨å¥¨æ¡ä»¶ ğŸŸ¡

- [ ] ã‚«ãƒ†ã‚´ãƒªåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

---

## 4. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### 4.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

| ãƒ†ã‚¹ãƒˆID | ãƒ†ã‚¹ãƒˆå†…å®¹ | æœŸå¾…çµæœ |
|---------|----------|----------|
| T-0015-01 | ç´ æè¿½åŠ  | è¿½åŠ æˆåŠŸã€ã‚«ã‚¦ãƒ³ãƒˆå¢—åŠ  |
| T-0015-02 | ç´ æå‰Šé™¤ | å‰Šé™¤æˆåŠŸã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è¿”å´ |
| T-0015-03 | å®¹é‡è¶…é | ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ |
| T-0015-04 | ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ | è©²å½“ç´ æã®ã¿è¿”å´ |
| T-0015-05 | ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆè¿½åŠ  | è¿½åŠ æˆåŠŸ |
| T-0015-06 | ã‚¯ãƒªã‚¢ | å…¨ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤ |

---

## 5. æˆæœç‰©

| æˆæœç‰© | ãƒ‘ã‚¹ |
|--------|------|
| ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ | `/src/domain/interfaces/inventory-service.interface.ts` |
| å®Ÿè£… | `/src/application/services/inventory-service.ts` |
| ãƒ†ã‚¹ãƒˆ | `/tests/unit/application/services/inventory-service.test.ts` |

---

## é–¢é€£æ–‡æ›¸

- **ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ**: [../../design/atelier-guild-rank/data-schema-save.md](../../design/atelier-guild-rank/data-schema-save.md)

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|----------|---------|
| 2026-01-16 | 1.0.0 | åˆç‰ˆä½œæˆ |
