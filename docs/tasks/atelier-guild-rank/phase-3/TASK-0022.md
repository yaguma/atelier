# TASK-0022: 依頼受注フェーズUI

**バージョン**: 1.0.0
**作成日**: 2026-01-16
**フェーズ**: 3 - UI層
**見積時間**: 4時間（半日）
**依存タスク**: TASK-0020, TASK-0013

---

## 1. タスク概要

| 項目 | 値 |
|------|-----|
| **タスクID** | TASK-0022 |
| **タスク名** | 依頼受注フェーズUI |
| **カテゴリ** | UI層 |
| **優先度** | 高 |
| **担当レイヤー** | Presentation |

### 信頼性レベル

- 🔵 **青信号**: 設計文書に記載
- 🟡 **黄信号**: 設計文書から妥当な推測
- 🔴 **赤信号**: 設計文書にない推測

---

## 2. 実装内容

### 2.1 依頼カードUI 🔵

```
┌─────────────────────────────────────┐
│  👤 村人の依頼                      │
│                                     │
│  依頼内容: 回復薬 ×1（C品質以上）   │
│  期限: 3日                          │
│  報酬: 50G / 貢献度 +10             │
│                                     │
│  [受注する]                         │
└─────────────────────────────────────┘
```

### 2.2 QuestAcceptPhaseUI 🔵

`src/presentation/ui/phases/QuestAcceptPhaseUI.ts`:

```typescript
export class QuestAcceptPhaseUI extends BaseComponent {
  private questCards: QuestCardUI[] = [];
  private acceptedList!: ScrollablePanel;

  constructor(scene: Phaser.Scene) {
    super(scene, 160, 80);
  }

  create(): void {
    this.createTitle();
    this.createQuestList();
    this.createAcceptedList();
  }

  private createTitle(): void {
    this.scene.add.text(
      this.container.x,
      this.container.y,
      '📋 本日の依頼',
      { fontSize: '24px', color: '#333333' }
    );
  }

  private createQuestList(): void {
    // 日次依頼をカード形式で表示
  }

  updateQuests(quests: Quest[]): void {
    // 依頼リストを更新
    this.questCards.forEach(card => card.destroy());
    this.questCards = [];

    quests.forEach((quest, index) => {
      const card = new QuestCardUI(this.scene, {
        quest,
        x: 200 + (index % 3) * 300,
        y: 150 + Math.floor(index / 3) * 200,
        onAccept: () => this.onAcceptQuest(quest),
      });
      card.create();
      this.questCards.push(card);
    });
  }

  private onAcceptQuest(quest: Quest): void {
    // 依頼受注処理
    this.eventBus.emit(GameEventType.QUEST_ACCEPTED, { quest });
  }
}
```

### 2.3 依頼詳細モーダル 🟡

- 依頼の詳細情報表示
- 必要アイテムの確認
- 受注確認ボタン

### 2.4 受注済み依頼リスト 🔵

- サイドバーに受注済み依頼を表示
- 進捗状況の可視化

---

## 3. 受け入れ基準

### 3.1 必須条件 🔵

- [ ] 日次依頼が表示される
- [ ] 依頼を受注できる
- [ ] 受注後にリストが更新される
- [ ] 次フェーズへ進める

### 3.2 推奨条件 🟡

- [ ] 依頼詳細モーダル
- [ ] 受注アニメーション

---

## 4. テストケース

### 4.1 統合テスト

| テストID | テスト内容 | 期待結果 |
|---------|----------|----------|
| T-0022-01 | 依頼表示 | 日次依頼が表示される |
| T-0022-02 | 受注ボタン | 受注成功 |
| T-0022-03 | 受注後表示更新 | サイドバーに追加 |
| T-0022-04 | スキップ | 次フェーズへ遷移 |

---

## 5. 成果物

| 成果物 | パス |
|--------|------|
| フェーズUI | `/src/presentation/ui/phases/QuestAcceptPhaseUI.ts` |
| 依頼カード | `/src/presentation/ui/components/QuestCardUI.ts` |

---

## 関連文書

- **依頼受注フェーズ設計**: [../../design/atelier-guild-rank/ui-design/screens/quest-accept.md](../../design/atelier-guild-rank/ui-design/screens/quest-accept.md)

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2026-01-16 | 1.0.0 | 初版作成 |
