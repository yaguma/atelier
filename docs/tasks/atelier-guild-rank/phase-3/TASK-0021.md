# TASK-0021: カードUIコンポーネント

**バージョン**: 1.0.0
**作成日**: 2026-01-16
**フェーズ**: 3 - UI層
**見積時間**: 4時間（半日）
**依存タスク**: TASK-0018, TASK-0009

---

## 1. タスク概要

| 項目 | 値 |
|------|-----|
| **タスクID** | TASK-0021 |
| **タスク名** | カードUIコンポーネント |
| **カテゴリ** | UI層 |
| **優先度** | 高 |
| **担当レイヤー** | Presentation |

### 信頼性レベル

- 🔵 **青信号**: 設計文書に記載
- 🟡 **黄信号**: 設計文書から妥当な推測
- 🔴 **赤信号**: 設計文書にない推測

---

## 2. 実装内容

### 2.1 カードデザイン 🟡

```
┌─────────────────────┐
│ ┌─────────────────┐ │
│ │     アイコン    │ │
│ │                 │ │
│ └─────────────────┘ │
│                     │
│   採取カード        │
│                     │
│  ⚡ 1   素材×3      │
│                     │
│ 森の素材を3つ採取   │
│                     │
└─────────────────────┘
```

### 2.2 CardUIコンポーネント 🔵

`src/presentation/ui/components/CardUI.ts`:

```typescript
export interface CardUIConfig {
  card: Card;
  x: number;
  y: number;
  interactive?: boolean;
  onClick?: (card: Card) => void;
}

export class CardUI extends BaseComponent {
  private card: Card;
  private background!: Phaser.GameObjects.Rectangle;
  private nameText!: Phaser.GameObjects.Text;
  private costText!: Phaser.GameObjects.Text;
  private effectText!: Phaser.GameObjects.Text;

  constructor(scene: Phaser.Scene, config: CardUIConfig) {
    super(scene, config.x, config.y);
    this.card = config.card;
  }

  create(): void {
    this.createBackground();
    this.createIcon();
    this.createName();
    this.createCost();
    this.createEffect();
    this.setupInteraction();
  }

  private createBackground(): void {
    const color = this.getCardTypeColor();
    this.background = this.scene.add.rectangle(0, 0, 120, 160, color);
    this.background.setStrokeStyle(2, 0x333333);
    this.container.add(this.background);
  }

  private getCardTypeColor(): number {
    switch (this.card.type) {
      case 'gathering': return 0x90EE90; // LightGreen
      case 'alchemy': return 0xFFB6C1;   // LightPink
      case 'utility': return 0xADD8E6;   // LightBlue
      default: return 0xFFFFFF;
    }
  }

  // ホバー時の拡大・詳細表示
  private setupInteraction(): void {
    if (!this.config.interactive) return;

    this.background.setInteractive({ useHandCursor: true });

    this.background.on('pointerover', () => {
      this.scene.tweens.add({
        targets: this.container,
        scaleX: 1.1,
        scaleY: 1.1,
        duration: 100,
      });
    });

    this.background.on('pointerout', () => {
      this.scene.tweens.add({
        targets: this.container,
        scaleX: 1,
        scaleY: 1,
        duration: 100,
      });
    });

    this.background.on('pointerdown', () => {
      this.config.onClick?.(this.card);
    });
  }
}
```

### 2.3 手札表示コンポーネント 🔵

`src/presentation/ui/components/HandDisplay.ts`:

- 横並びで5枚のカード表示
- カード選択状態の管理
- 選択中カードの強調表示

### 2.4 カードアニメーション 🟡

- ドローアニメーション（デッキから手札へ）
- プレイアニメーション（手札から場へ）
- 捨てアニメーション

---

## 3. 受け入れ基準

### 3.1 必須条件 🔵

- [ ] カードが正しく表示される
- [ ] カードタイプで色が異なる
- [ ] クリックでコールバック実行
- [ ] 手札が横並びで表示される

### 3.2 推奨条件 🟡

- [ ] ホバーエフェクト
- [ ] ドラッグ＆ドロップ

---

## 4. テストケース

### 4.1 統合テスト

| テストID | テスト内容 | 期待結果 |
|---------|----------|----------|
| T-0021-01 | カード表示 | 正しいデザイン |
| T-0021-02 | タイプ別色 | 採取=緑、調合=ピンク |
| T-0021-03 | 手札表示 | 5枚横並び |
| T-0021-04 | カード選択 | 強調表示 |

---

## 5. 成果物

| 成果物 | パス |
|--------|------|
| CardUI | `/src/presentation/ui/components/CardUI.ts` |
| HandDisplay | `/src/presentation/ui/components/HandDisplay.ts` |

---

## 関連文書

- **UI設計概要**: [../../design/atelier-guild-rank/ui-design/overview.md](../../design/atelier-guild-rank/ui-design/overview.md)

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2026-01-16 | 1.0.0 | 初版作成 |
