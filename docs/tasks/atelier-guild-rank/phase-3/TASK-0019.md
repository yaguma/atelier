# TASK-0019: TitleScene実装

**バージョン**: 1.0.0
**作成日**: 2026-01-16
**フェーズ**: 3 - UI層
**見積時間**: 4時間（半日）
**依存タスク**: TASK-0008, TASK-0018

---

## 1. タスク概要

| 項目 | 値 |
|------|-----|
| **タスクID** | TASK-0019 |
| **タスク名** | TitleScene実装 |
| **カテゴリ** | UI層 |
| **優先度** | 高 |
| **担当レイヤー** | Presentation |

### 信頼性レベル

- 🔵 **青信号**: 設計文書に記載
- 🟡 **黄信号**: 設計文書から妥当な推測
- 🔴 **赤信号**: 設計文書にない推測

---

## 2. 実装内容

### 2.1 画面レイアウト 🟡

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│                    ╔═══════════════════╗                    │
│                    ║   ATELIER GUILD   ║                    │
│                    ║   錬金術師ギルド   ║                    │
│                    ╚═══════════════════╝                    │
│                                                             │
│                    ┌─────────────────┐                      │
│                    │   新規ゲーム    │                      │
│                    └─────────────────┘                      │
│                    ┌─────────────────┐                      │
│                    │  コンティニュー │                      │
│                    └─────────────────┘                      │
│                    ┌─────────────────┐                      │
│                    │     設定        │                      │
│                    └─────────────────┘                      │
│                                                             │
│                                           Version 1.0.0     │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 TitleScene実装 🔵

`src/presentation/scenes/TitleScene.ts`:

```typescript
export class TitleScene extends BaseScene {
  private newGameButton!: Button;
  private continueButton!: Button;
  private settingsButton!: Button;

  constructor() {
    super({ key: 'TitleScene' });
  }

  create(): void {
    this.createBackground();
    this.createLogo();
    this.createButtons();
    this.createVersionText();
    this.checkSaveData();
  }

  private createBackground(): void {
    this.add.rectangle(
      this.cameras.main.centerX,
      this.cameras.main.centerY,
      1280,
      720,
      THEME.colors.background
    );
  }

  private createLogo(): void {
    // タイトルロゴ
    this.add.text(
      this.cameras.main.centerX,
      200,
      'ATELIER GUILD',
      {
        fontFamily: THEME.fonts.primary,
        fontSize: '48px',
        color: '#8B4513',
      }
    ).setOrigin(0.5);

    // サブタイトル
    this.add.text(
      this.cameras.main.centerX,
      260,
      '錬金術師ギルド',
      {
        fontFamily: THEME.fonts.primary,
        fontSize: '24px',
        color: '#666666',
      }
    ).setOrigin(0.5);
  }

  private createButtons(): void {
    // 新規ゲームボタン
    this.newGameButton = new Button(this, {
      x: this.cameras.main.centerX,
      y: 380,
      text: '新規ゲーム',
      style: 'primary',
      onClick: () => this.onNewGame(),
    });

    // コンティニューボタン
    this.continueButton = new Button(this, {
      x: this.cameras.main.centerX,
      y: 450,
      text: 'コンティニュー',
      style: 'secondary',
      onClick: () => this.onContinue(),
    });

    // 設定ボタン
    this.settingsButton = new Button(this, {
      x: this.cameras.main.centerX,
      y: 520,
      text: '設定',
      style: 'secondary',
      onClick: () => this.onSettings(),
    });
  }

  private onNewGame(): void {
    // セーブデータがあれば確認ダイアログ
    if (this.hasSaveData) {
      this.showConfirmDialog();
    } else {
      this.startNewGame();
    }
  }

  // ... 他のメソッド
}
```

### 2.3 確認ダイアログ 🟡

- 既存セーブデータがある場合に表示
- 「はい」「いいえ」選択

### 2.4 設定ダイアログ 🔴

- BGM音量スライダー
- SE音量スライダー
- アニメーションON/OFF

---

## 3. 受け入れ基準

### 3.1 必須条件 🔵

- [x] タイトルロゴが表示される
- [x] 3つのボタンが表示される
- [x] 新規ゲームでMainSceneへ遷移
- [x] セーブデータ無時はコンティニュー無効

### 3.2 推奨条件 🟡

- [ ] フェードイン・アウトアニメーション（Phase 2予定）
- [ ] ボタンホバーエフェクト（Phase 2予定）

---

## 4. テストケース

### 4.1 統合テスト

| テストID | テスト内容 | 期待結果 |
|---------|----------|----------|
| T-0019-01 | 画面表示 | 全要素表示 |
| T-0019-02 | 新規ゲームボタン | MainSceneへ遷移 |
| T-0019-03 | コンティニュー（セーブあり） | ゲーム再開 |
| T-0019-04 | コンティニュー（セーブなし） | ボタン無効 |

---

## 5. 成果物

| 成果物 | パス |
|--------|------|
| TitleScene | `/src/presentation/scenes/TitleScene.ts` |

---

## 関連文書

- **タイトル画面設計**: [../../design/atelier-guild-rank/ui-design/screens/title.md](../../design/atelier-guild-rank/ui-design/screens/title.md)

---

## 変更履歴

| 日付 | バージョン | 変更内容 |
|------|----------|---------|
| 2026-01-16 | 1.0.0 | 初版作成 |
| 2026-01-18 | 1.1.0 | TDD開発完了・実装状況追加 |

---

## 実装状況（2026-01-18更新）

### ✅ **完了** (TDD開発完了 - 24テストケース)

- [x] タイトルロゴ「ATELIER GUILD」表示
- [x] サブタイトル「錬金術師ギルド」表示
- [x] バージョン情報「Version 1.0.0」表示
- [x] 新規ゲーム/コンティニュー/設定の3ボタン
- [x] セーブデータ存在チェックとコンティニューボタン有効/無効制御
- [x] 確認ダイアログ（セーブデータ上書き確認）
- [x] 設定ダイアログ（Phase 1スタブ実装）
- [x] エラーダイアログ（セーブデータ読み込み失敗時）
- [x] ISaveDataRepositoryインターフェース定義

**実装詳細**:
- 要件網羅率: 100% (Phase 1範囲)
- テスト成功率: 87.5% (21/24 passed, 3 skipped for Phase 2 animations)
- コード行数: 約730行
- 定数分離: LAYOUT, STYLES, SIZES, DEPTH, ANIMATION, TEXT

**テストファイル**:
- `src/presentation/scenes/TitleScene.spec.ts` (24テストケース)

### Phase 2予定

- [ ] フェードイン・アウトアニメーション
- [ ] ボタンホバーエフェクト
- [ ] 設定ダイアログ本実装（BGM/SE音量、アニメーションON/OFF）
