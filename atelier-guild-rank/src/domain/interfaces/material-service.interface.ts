/**
 * material-service.interface.ts - MaterialServiceã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 *
 * TASK-0010: ç´ æã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒ»MaterialServiceå®Ÿè£…
 *
 * @description
 * ç´ æã®ç”Ÿæˆã€å“è³ªè¨ˆç®—ã€æ¤œç´¢ã‚’è¡Œã†ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ã€‚
 *
 * @ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ« ğŸ”µ
 * - note.mdã«åŸºã¥ã„ãŸå®Ÿè£…
 */

import type { MaterialInstance } from '@domain/entities/MaterialInstance';
import type { GuildRank, IMaterial, MaterialId, Quality } from '@shared/types';

/**
 * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: MaterialServiceã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
 * ã€å®Ÿè£…æ–¹é‡ã€‘: ç´ æã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆã€å“è³ªè¨ˆç®—ã€æ¤œç´¢æ©Ÿèƒ½ã‚’æä¾›
 * ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: note.mdãƒ»è¨­è¨ˆæ–‡æ›¸ã«æ˜è¨˜
 */
export interface IMaterialService {
  // =============================================================================
  // ç´ æç”Ÿæˆ
  // =============================================================================

  /**
   * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: ç´ æã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
   * ã€å®Ÿè£…æ–¹é‡ã€‘: ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç´ æã‚’å–å¾—ã—ã€ä¸€æ„ãªIDã‚’ä»˜ä¸ã—ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆ
   * ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã€‘: å­˜åœ¨ã—ãªã„ç´ æIDã®å ´åˆã¯ApplicationErrorã‚’ã‚¹ãƒ­ãƒ¼
   * ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: note.mdãƒ»è¨­è¨ˆæ–‡æ›¸ã«æ˜è¨˜
   *
   * @param materialId - ç´ æID
   * @param quality - å“è³ª
   * @returns ç´ æã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
   * @throws {ApplicationError} ç´ æãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆï¼ˆErrorCodes.INVALID_MATERIAL_IDï¼‰
   */
  createInstance(materialId: MaterialId, quality: Quality): MaterialInstance;

  /**
   * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: ãƒ©ãƒ³ãƒ€ãƒ ãªå“è³ªã‚’ç”Ÿæˆ
   * ã€å®Ÿè£…æ–¹é‡ã€‘: åŸºæº–å“è³ªã‹ã‚‰Â±1æ®µéšã®ç¯„å›²ã§ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆ
   * ã€å¢ƒç•Œå€¤å‡¦ç†ã€‘: Dï¼ˆæœ€å°ï¼‰ï½Sï¼ˆæœ€å¤§ï¼‰ã®ç¯„å›²ã‚’è¶…ãˆãªã„ã‚ˆã†ã‚¯ãƒ©ãƒ³ãƒ—
   * ã€ç¢ºç‡åˆ†å¸ƒã€‘: -1, 0, 1ãŒå‡ç­‰ãªç¢ºç‡ï¼ˆãã‚Œãã‚Œ1/3ï¼‰
   * ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: note.mdãƒ»è¨­è¨ˆæ–‡æ›¸ã«æ˜è¨˜
   *
   * @param baseQuality - åŸºæº–å“è³ª
   * @returns ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚ŒãŸå“è³ª
   *
   * @example
   * ```typescript
   * // åŸºæº–å“è³ªãŒBã®å ´åˆã€A, B, Cã®ã„ãšã‚Œã‹ãŒç”Ÿæˆã•ã‚Œã‚‹
   * generateRandomQuality(Quality.B); // => Quality.A | Quality.B | Quality.C
   * // åŸºæº–å“è³ªãŒDã®å ´åˆã€D ã¾ãŸã¯ C ã®ã¿ç”Ÿæˆã•ã‚Œã‚‹
   * generateRandomQuality(Quality.D); // => Quality.D | Quality.C
   * ```
   */
  generateRandomQuality(baseQuality: Quality): Quality;

  // =============================================================================
  // å“è³ªè¨ˆç®—
  // =============================================================================

  /**
   * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: ç´ æã®å¹³å‡å“è³ªã‚’è¨ˆç®—
   * ã€å®Ÿè£…æ–¹é‡ã€‘: å„ç´ æã®å“è³ªã‚’æ•°å€¤ã«å¤‰æ›ã—ã¦å¹³å‡ã‚’ç®—å‡ºã—ã€å››æ¨äº”å…¥ã—ã¦å“è³ªã«å¤‰æ›
   * ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã€‘: ç©ºé…åˆ—ã®å ´åˆã¯ApplicationErrorã‚’ã‚¹ãƒ­ãƒ¼
   * ã€å››æ¨äº”å…¥ã€‘: Math.round()ã‚’ä½¿ç”¨
   * ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: note.mdãƒ»è¨­è¨ˆæ–‡æ›¸ã«æ˜è¨˜
   *
   * @param materials - ç´ æã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®é…åˆ—
   * @returns å¹³å‡å“è³ª
   * @throws {ApplicationError} ç©ºé…åˆ—ã®å ´åˆï¼ˆErrorCodes.INVALID_MATERIALSï¼‰
   *
   * @example
   * ```typescript
   * // [B(3), B(3), C(2)] => å¹³å‡2.67 => Math.round(2.67) = 3 => B
   * calculateAverageQuality([materialB1, materialB2, materialC1]); // => Quality.B
   * // [A(4), C(2), B(3)] => å¹³å‡3.0 => Math.round(3.0) = 3 => B
   * calculateAverageQuality([materialA, materialC, materialB]); // => Quality.B
   * ```
   */
  calculateAverageQuality(materials: MaterialInstance[]): Quality;

  // =============================================================================
  // æ¤œç´¢ï¼ˆå°†æ¥å®Ÿè£…ï¼‰
  // =============================================================================

  /**
   * ã€æ©Ÿèƒ½æ¦‚è¦ã€‘: ã‚®ãƒ«ãƒ‰ãƒ©ãƒ³ã‚¯ã§è§£ç¦ã•ã‚Œã‚‹ç´ æã‚’å–å¾—ï¼ˆå°†æ¥å®Ÿè£…ï¼‰
   * ã€å®Ÿè£…æ–¹é‡ã€‘: ç¾æ™‚ç‚¹ã§ã¯ç©ºé…åˆ—ã‚’è¿”ã™
   * ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: å°†æ¥å®Ÿè£…äºˆå®š
   *
   * @param rank - ã‚®ãƒ«ãƒ‰ãƒ©ãƒ³ã‚¯
   * @returns è©²å½“ã™ã‚‹ç´ æãƒã‚¹ã‚¿ãƒ¼ã®é…åˆ—
   */
  getMaterialsByRank?(rank: GuildRank): IMaterial[];
}
