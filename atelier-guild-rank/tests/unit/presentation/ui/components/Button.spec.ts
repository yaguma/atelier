// @ts-nocheck
/**
 * Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ
 * TASK-0018 Phase 2 å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŸºç›¤
 *
 * @description
 * T-0018-BTN-01: ãƒ—ãƒ©ã‚¤ãƒãƒªãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º
 * T-0018-BTN-02: ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º
 * T-0018-BTN-03: ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º
 * T-0018-BTN-04: ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º
 * T-0018-BTN-05: ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œ
 * T-0018-BTN-06: ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã®å‹•ä½œç¢ºèª
 * T-0018-BTN-07: ç©ºæ–‡å­—åˆ—ã®ãƒ†ã‚­ã‚¹ãƒˆã§ãƒœã‚¿ãƒ³ç”Ÿæˆ
 * T-0018-BTN-08: onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒnullã®å ´åˆ
 * T-0018-BTN-09: ç„¡åŠ¹åŒ–ã•ã‚ŒãŸãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯
 * T-0018-BTN-10: rexUIãŒæœªåˆæœŸåŒ–ã®å ´åˆ
 * T-0018-BTN-11: æœ€å°å¹…ã®ãƒœã‚¿ãƒ³ç”Ÿæˆ
 * T-0018-BTN-12: éå¸¸ã«é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã®ãƒœã‚¿ãƒ³ç”Ÿæˆ
 * T-0018-BTN-13: ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹åŒ–ã¨å†æœ‰åŠ¹åŒ–
 */

import { Button, ButtonType } from '@presentation/ui/components/Button';
import type Phaser from 'phaser';
import { beforeEach, describe, expect, test, vi } from 'vitest';

// rexUIãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ‹¡å¼µã‚·ãƒ¼ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
interface RexUIScene extends Phaser.Scene {
  rexUI: {
    add: {
      label: ReturnType<typeof vi.fn>;
      roundRectangle: ReturnType<typeof vi.fn>;
      dialog?: ReturnType<typeof vi.fn>;
      sizer?: ReturnType<typeof vi.fn>;
    };
  };
}

interface MockLabel {
  setInteractive: ReturnType<typeof vi.fn>;
  on: ReturnType<typeof vi.fn>;
  setAlpha: ReturnType<typeof vi.fn>;
  layout: ReturnType<typeof vi.fn>;
}

interface MockContainer {
  setVisible: ReturnType<typeof vi.fn>;
  setPosition: ReturnType<typeof vi.fn>;
  x: number;
  y: number;
  visible: boolean;
}

describe('Button', () => {
  let scene: RexUIScene;
  let mockCallback: () => void;
  let mockLabel: MockLabel;
  let mockContainer: MockContainer;

  beforeEach(() => {
    // ã€ãƒ†ã‚¹ãƒˆå‰æº–å‚™ã€‘: å„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå‰ã«Phaserã‚·ãƒ¼ãƒ³ã¨rexUIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ãƒ¢ãƒƒã‚¯åŒ–ã—ã€ä¸€è²«ã—ãŸãƒ†ã‚¹ãƒˆæ¡ä»¶ã‚’ä¿è¨¼
    // ã€ç’°å¢ƒåˆæœŸåŒ–ã€‘: Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒrexUIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ä¾å­˜ã™ã‚‹ãŸã‚ã€é©åˆ‡ãªãƒ¢ãƒƒã‚¯ã‚’ç”¨æ„
    // ã€å‰ææ¡ä»¶ç¢ºèªã€‘: scene.rexUIãŒå­˜åœ¨ã—ã€add.labelãƒ¡ã‚½ãƒƒãƒ‰ãŒåˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’å‰æã¨ã™ã‚‹

    mockCallback = vi.fn() as () => void;

    // ãƒ¢ãƒƒã‚¯ã®Labelã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    mockLabel = {
      setInteractive: vi.fn().mockReturnThis(),
      on: vi.fn().mockReturnThis(),
      setAlpha: vi.fn().mockReturnThis(),
      layout: vi.fn().mockReturnThis(),
    };

    // ãƒ¢ãƒƒã‚¯ã®Container
    mockContainer = {
      setVisible: vi.fn().mockReturnThis(),
      setPosition: vi.fn().mockReturnThis(),
      x: 0,
      y: 0,
      visible: true,
    };

    // Phaserã‚·ãƒ¼ãƒ³ã®ãƒ¢ãƒƒã‚¯ã‚’ä½œæˆ
    scene = {
      add: {
        container: vi.fn().mockReturnValue(mockContainer),
        text: vi.fn().mockReturnValue({
          setStyle: vi.fn().mockReturnThis(),
        }),
      },
      tweens: {
        add: vi.fn().mockReturnThis(),
      },
      rexUI: {
        add: {
          label: vi.fn().mockReturnValue(mockLabel),
          roundRectangle: vi.fn().mockReturnValue({
            setFillStyle: vi.fn().mockReturnThis(),
          }),
        },
      },
    } as unknown as RexUIScene;
  });

  describe('T-0018-BTN-01: ãƒ—ãƒ©ã‚¤ãƒãƒªãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ãƒ—ãƒ©ã‚¤ãƒãƒªãƒœã‚¿ãƒ³ãŒè¨­è¨ˆæ›¸é€šã‚Šã®ã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: rexUI.add.labelãŒå‘¼ã°ã‚Œã€æ­£ã—ã„èƒŒæ™¯è‰²ãƒ»ãƒ†ã‚­ã‚¹ãƒˆè‰²ã§ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ãƒ†ãƒ¼ãƒå®šç¾©ã‚’ä½¿ç”¨ã—ãŸãƒœã‚¿ãƒ³ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã‚‹
    // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: UIè¨­è¨ˆæ›¸ overview.md ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 5.1 ã«æ˜è¨˜

    test('ãƒ—ãƒ©ã‚¤ãƒãƒªãƒœã‚¿ãƒ³ãŒæ­£ã—ã„ã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ãƒ—ãƒ©ã‚¤ãƒãƒªãƒœã‚¿ãƒ³ã®æ¨™æº–çš„ãªè¨­å®šã‚’ç”¨æ„
      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: Buttonã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç”Ÿæˆ
      new Button(scene, 100, 200, {
        text: 'ç¢ºå®š',
        type: ButtonType.PRIMARY,
        onClick: mockCallback,
      });

      // ã€çµæœæ¤œè¨¼ã€‘: rexUI.add.labelãŒæ­£ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§å‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      // ã€æœŸå¾…å€¤ç¢ºèªã€‘: èƒŒæ™¯è‰²ãŒTHEME.colors.primaryã§ã‚ã‚Šã€ãƒ†ãƒ¼ãƒå®šç¾©ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ¤œè¨¼
      // ã€å“è³ªä¿è¨¼ã€‘: ãƒ†ãƒ¼ãƒã®ä¸€è²«æ€§ã‚’ä¿ã¡ã€ãƒ‡ã‚¶ã‚¤ãƒ³è¦ç´„ã«æº–æ‹ ã—ãŸãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼

      // ã€æ¤œè¨¼é …ç›®ã€‘: rexUI.add.labelãŒå‘¼ã°ã‚ŒãŸã“ã¨
      expect(scene.rexUI.add.label).toHaveBeenCalled(); // ğŸ”µ
    });

    test('ãƒ†ã‚­ã‚¹ãƒˆãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹', () => {
      // ã€ç¢ºèªå†…å®¹ã€‘: ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆãŒæŒ‡å®šã—ãŸå€¤ã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
      new Button(scene, 100, 200, {
        text: 'ç¢ºå®š',
        type: ButtonType.PRIMARY,
        onClick: mockCallback,
      });

      // ãƒ†ã‚­ã‚¹ãƒˆãŒ'ç¢ºå®š'ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
      expect(scene.add.text).toHaveBeenCalledWith(
        expect.anything(),
        expect.anything(),
        'ç¢ºå®š',
        expect.anything(),
      ); // ğŸ”µ
    });

    test('ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹', () => {
      // ã€ç¢ºèªå†…å®¹ã€‘: ãƒœã‚¿ãƒ³ãŒã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«è¨­å®šã•ã‚Œã€ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
      new Button(scene, 100, 200, {
        text: 'ç¢ºå®š',
        type: ButtonType.PRIMARY,
        onClick: mockCallback,
      });

      // setInteractiveãŒå‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      expect(mockLabel.setInteractive).toHaveBeenCalled(); // ğŸ”µ

      // pointerdownã‚¤ãƒ™ãƒ³ãƒˆãŒç™»éŒ²ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      expect(mockLabel.on).toHaveBeenCalledWith('pointerdown', expect.any(Function)); // ğŸ”µ
    });
  });

  describe('T-0018-BTN-02: ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ãŒè¨­è¨ˆæ›¸é€šã‚Šã®ã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: é€æ˜ãªèƒŒæ™¯ã¨ã‚°ãƒ¬ãƒ¼ã®æ ç·šã§ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒæ­£ã—ãé©ç”¨ã•ã‚Œã‚‹
    // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: UIè¨­è¨ˆæ›¸ overview.md ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 5.1 ã«æ˜è¨˜

    test('ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ãŒæ­£ã—ã„ã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹', () => {
      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ã‚»ã‚«ãƒ³ãƒ€ãƒªãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
      new Button(scene, 100, 200, {
        text: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
        type: ButtonType.SECONDARY,
        onClick: mockCallback,
      });

      // ã€çµæœæ¤œè¨¼ã€‘: rexUI.add.labelãŒå‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      expect(scene.rexUI.add.label).toHaveBeenCalled(); // ğŸ”µ
    });
  });

  describe('T-0018-BTN-03: ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ãŒã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: èƒŒæ™¯ã¨æ ç·šãŒãªã„ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ã®ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒæ­£ã—ãé©ç”¨ã•ã‚Œã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: TASK-0018.md ã«ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ã®å­˜åœ¨ã¯è¨˜è¼‰ã‚ã‚Šã€è©³ç´°ã‚¹ã‚¿ã‚¤ãƒ«ã¯æ¨æ¸¬

    test('ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ãŒæ­£ã—ã„ã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹', () => {
      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ†ã‚­ã‚¹ãƒˆãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
      new Button(scene, 100, 200, {
        text: 'ã‚¹ã‚­ãƒƒãƒ—',
        type: ButtonType.TEXT,
        onClick: mockCallback,
      });

      // ã€çµæœæ¤œè¨¼ã€‘: rexUI.add.labelãŒå‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      expect(scene.rexUI.add.label).toHaveBeenCalled(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-04: ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ã®ç”Ÿæˆã¨è¡¨ç¤º', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã‚’å«ã‚€ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒæ­£ã—ãé©ç”¨ã•ã‚Œã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: TASK-0018.md ã«ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ã®å­˜åœ¨ã¯è¨˜è¼‰ã‚ã‚Šã€è©³ç´°ã‚¹ã‚¿ã‚¤ãƒ«ã¯æ¨æ¸¬

    test('ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ãŒæ­£ã—ã„ã‚¹ã‚¿ã‚¤ãƒ«ã§ç”Ÿæˆã•ã‚Œã‚‹', () => {
      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
      new Button(scene, 100, 200, {
        text: '',
        icon: 'close-icon',
        type: ButtonType.ICON,
        onClick: mockCallback,
      });

      // ã€çµæœæ¤œè¨¼ã€‘: rexUI.add.labelãŒå‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      expect(scene.rexUI.add.label).toHaveBeenCalled(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-05: ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œ', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã«onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ç™»éŒ²ã•ã‚ŒãŸã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹
    // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 2.1.2 ã«æ˜è¨˜

    test('ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³è¨­å®šã‚’ç”¨æ„
      new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: pointerdownã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«ã•ã›ã‚‹
      // ã€å‡¦ç†å†…å®¹ã€‘: rexUIã®pointerdownã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã€onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®å‘¼ã³å‡ºã—ã‚’æ¤œè¨¼
      const onPointerDown = mockLabel.on.mock.calls.find(
        (call: unknown[]) => call[0] === 'pointerdown',
      )?.[1];

      if (onPointerDown) {
        onPointerDown();
      }

      // ã€çµæœæ¤œè¨¼ã€‘: onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒ1å›å‘¼ã°ã‚ŒãŸã“ã¨ã‚’ç¢ºèª
      // ã€æœŸå¾…å€¤ç¢ºèªã€‘: ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒæ­£ã—ãå®Ÿè¡Œã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
      expect(mockCallback).toHaveBeenCalledTimes(1); // ğŸ”µ
    });

    test('ãƒœã‚¿ãƒ³ã‚’è¤‡æ•°å›ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨è¤‡æ•°å›ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹', () => {
      // ã€ç¢ºèªå†…å®¹ã€‘: è¤‡æ•°å›ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆã€ãã®å›æ•°åˆ†ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      const onPointerDown = mockLabel.on.mock.calls.find(
        (call: unknown[]) => call[0] === 'pointerdown',
      )?.[1];

      if (onPointerDown) {
        onPointerDown();
        onPointerDown();
        onPointerDown();
      }

      expect(mockCallback).toHaveBeenCalledTimes(3); // ğŸ”µ
    });
  });

  describe('T-0018-BTN-06: ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã®å‹•ä½œç¢ºèª', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: Fluent Interfaceãƒ‘ã‚¿ãƒ¼ãƒ³ãŒæ­£ã—ãå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: setVisibleã€setPositionã€setEnabledãƒ¡ã‚½ãƒƒãƒ‰ãŒthisã‚’è¿”ã—ã€ãƒã‚§ãƒ¼ãƒ³å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: é€£ç¶šã—ã¦ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ãŒã§ãã‚‹
    // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 1ã§å®Ÿè£…æ¸ˆã¿ã®BaseComponentã‚’ç¶™æ‰¿

    test('ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ãŒæ­£ã—ãå‹•ä½œã™ã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³ã‚’ç”¨æ„
      const button = new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: è¤‡æ•°ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é€£ç¶šã—ã¦å‘¼ã³å‡ºã™
      // ã€å‡¦ç†å†…å®¹ã€‘: setVisibleã€setPositionã‚’é€£ç¶šã§å‘¼ã³å‡ºã—ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ãŒæ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
      const result = button.setVisible(true).setPosition(200, 300);

      // ã€çµæœæ¤œè¨¼ã€‘: æœ€çµ‚çš„ãªçµæœãŒButtonã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹è‡ªèº«ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
      // ã€æœŸå¾…å€¤ç¢ºèªã€‘: ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ãŒæ­£ã—ãæ©Ÿèƒ½ã—ã€thisãŒè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
      expect(result).toBe(button); // ğŸ”µ
    });

    test('setEnabledãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ãƒã‚§ãƒ¼ãƒ³å¯èƒ½ã§ã‚ã‚‹', () => {
      // ã€ç¢ºèªå†…å®¹ã€‘: setEnabledãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã«å«ã‚ã‚‰ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      const button = new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      const result = button.setEnabled(false).setVisible(true);

      expect(result).toBe(button); // ğŸ”µ
    });
  });

  describe('T-0018-BTN-07: ç©ºæ–‡å­—åˆ—ã®ãƒ†ã‚­ã‚¹ãƒˆã§ãƒœã‚¿ãƒ³ç”Ÿæˆ', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ç©ºæ–‡å­—åˆ—å…¥åŠ›æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: textãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ç©ºæ–‡å­—åˆ—ãŒæ¸¡ã•ã‚ŒãŸå ´åˆã®å‹•ä½œã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã€ã¾ãŸã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4.4.1 ã«ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã¨ã—ã¦è¨˜è¼‰

    test('ç©ºæ–‡å­—åˆ—ã®ãƒ†ã‚­ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ç©ºæ–‡å­—åˆ—ã‚’å«ã‚€ä¸æ­£ãªè¨­å®šã‚’ç”¨æ„
      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ç©ºæ–‡å­—åˆ—ã§ãƒœã‚¿ãƒ³ç”Ÿæˆã‚’è©¦ã¿ã‚‹
      // ã€å‡¦ç†å†…å®¹ã€‘: ã‚¨ãƒ©ãƒ¼ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…

      // ã€çµæœæ¤œè¨¼ã€‘: ã‚¨ãƒ©ãƒ¼ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      // ã€æœŸå¾…å€¤ç¢ºèªã€‘: 'Button: text is required' ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå«ã¾ã‚Œã‚‹ã“ã¨ã‚’æ¤œè¨¼
      expect(() => {
        new Button(scene, 100, 200, {
          text: '',
          onClick: mockCallback,
        });
      }).toThrow(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-08: onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒnullã®å ´åˆ', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¤œè¨¼ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: onClick ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒ null ã¾ãŸã¯ undefined ã®å ´åˆã®å‹•ä½œã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4.4.1 ã«ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã¨ã—ã¦è¨˜è¼‰

    test('onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒnullã®å ´åˆã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: nullã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å«ã‚€ä¸æ­£ãªè¨­å®šã‚’ç”¨æ„
      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: nullã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãƒœã‚¿ãƒ³ç”Ÿæˆã‚’è©¦ã¿ã‚‹

      // ã€çµæœæ¤œè¨¼ã€‘: ã‚¨ãƒ©ãƒ¼ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      expect(() => {
        new Button(scene, 100, 200, {
          text: 'ãƒœã‚¿ãƒ³',
          onClick: null as unknown as () => void,
        });
      }).toThrow(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-09: ç„¡åŠ¹åŒ–ã•ã‚ŒãŸãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ç„¡åŠ¹åŒ–çŠ¶æ…‹ã§ã®ã‚¯ãƒªãƒƒã‚¯é˜²æ­¢ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: setEnabled(false)ã§ç„¡åŠ¹åŒ–ã•ã‚ŒãŸãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸå ´åˆã®å‹•ä½œã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: onClickã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œãªã„
    // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4.3.1 ã«ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã¨ã—ã¦è¨˜è¼‰

    test('ç„¡åŠ¹åŒ–ã•ã‚ŒãŸãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚‚ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œãªã„', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆã—ã€ç„¡åŠ¹åŒ–ã™ã‚‹
      const button = new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã¦ã‹ã‚‰ã‚¯ãƒªãƒƒã‚¯ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
      button.setEnabled(false);

      const onPointerDown = mockLabel.on.mock.calls.find(
        (call: unknown[]) => call[0] === 'pointerdown',
      )?.[1];

      if (onPointerDown) {
        onPointerDown();
      }

      // ã€çµæœæ¤œè¨¼ã€‘: ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª
      // ã€æœŸå¾…å€¤ç¢ºèªã€‘: ç„¡åŠ¹çŠ¶æ…‹ã®ãƒœã‚¿ãƒ³ã¯ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‡¦ç†ã—ãªã„ã“ã¨ã‚’æ¤œè¨¼
      expect(mockCallback).not.toHaveBeenCalled(); // ğŸ”µ
    });

    test('ãƒœã‚¿ãƒ³ãŒè¦–è¦šçš„ã«ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹', () => {
      // ã€ç¢ºèªå†…å®¹ã€‘: ç„¡åŠ¹åŒ–ã•ã‚ŒãŸãƒœã‚¿ãƒ³ãŒã‚¢ãƒ«ãƒ•ã‚¡å€¤ã§åŠé€æ˜ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèª
      const button = new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      button.setEnabled(false);

      // ã‚¢ãƒ«ãƒ•ã‚¡å€¤ãŒè¨­å®šã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      expect(mockLabel.setAlpha).toHaveBeenCalledWith(0.5); // ğŸ”µ
    });
  });

  describe('T-0018-BTN-10: rexUIãŒæœªåˆæœŸåŒ–ã®å ´åˆ', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ä¾å­˜é–¢ä¿‚ã®æ¤œè¨¼ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: Phaserã‚·ãƒ¼ãƒ³ã® rexUI ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæœªåˆæœŸåŒ–ã®çŠ¶æ…‹ã§Buttonã‚’ç”Ÿæˆ
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹ã€ã¾ãŸã¯è­¦å‘Šã‚’å‡ºåŠ›ã™ã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4.4.2 ã«ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã¨ã—ã¦è¨˜è¼‰

    test('rexUIãŒæœªåˆæœŸåŒ–ã®å ´åˆã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: rexUIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒå­˜åœ¨ã—ãªã„ã‚·ãƒ¼ãƒ³ã‚’ç”¨æ„
      const sceneWithoutRexUI = {
        add: {
          container: vi.fn().mockReturnValue(mockContainer),
        },
        rexUI: undefined,
      } as unknown as RexUIScene;

      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: rexUIæœªåˆæœŸåŒ–ã§ãƒœã‚¿ãƒ³ç”Ÿæˆã‚’è©¦ã¿ã‚‹
      // ã€çµæœæ¤œè¨¼ã€‘: ã‚¨ãƒ©ãƒ¼ãŒã‚¹ãƒ­ãƒ¼ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      expect(() => {
        new Button(sceneWithoutRexUI, 100, 200, {
          text: 'ãƒœã‚¿ãƒ³',
          onClick: mockCallback,
        });
      }).toThrow(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-11: æœ€å°å¹…ã®ãƒœã‚¿ãƒ³ç”Ÿæˆ', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: æœ€å°ã‚µã‚¤ã‚ºã§ã®å‹•ä½œã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: ãƒœã‚¿ãƒ³ã®æœ€å°ã‚µã‚¤ã‚ºã‚’è¨­å®šã—ã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå´©ã‚Œãªã„ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ãƒœã‚¿ãƒ³ãŒæœ€å°å¹…ã§ç”Ÿæˆã•ã‚Œã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4.3.3 ã«ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã¨ã—ã¦è¨˜è¼‰

    test('æœ€å°å¹…ã®ãƒœã‚¿ãƒ³ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: æœ€å°å¹…ã‚’æŒ‡å®šã—ãŸãƒœã‚¿ãƒ³è¨­å®šã‚’ç”¨æ„
      new Button(scene, 100, 200, {
        text: 'OK',
        width: 50,
        onClick: mockCallback,
      });

      // ã€çµæœæ¤œè¨¼ã€‘: ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      expect(scene.rexUI.add.label).toHaveBeenCalled(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-12: éå¸¸ã«é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã®ãƒœã‚¿ãƒ³ç”Ÿæˆ', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼å‡¦ç†ã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã§ã‚‚ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãŒå´©ã‚Œãªã„ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: ãƒ†ã‚­ã‚¹ãƒˆãŒé©åˆ‡ã«å‡¦ç†ã•ã‚Œã‚‹
    // ğŸŸ¡ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 4.3.3 ã«ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã¨ã—ã¦è¨˜è¼‰

    test('é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã®ãƒœã‚¿ãƒ³ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: éå¸¸ã«é•·ã„ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€ãƒœã‚¿ãƒ³è¨­å®šã‚’ç”¨æ„
      const longText = 'ã“ã‚Œã¯éå¸¸ã«é•·ã„ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆã‚’è¡Œã„ã¾ã™'.repeat(3);
      new Button(scene, 100, 200, {
        text: longText,
        width: 200,
        onClick: mockCallback,
      });

      // ã€çµæœæ¤œè¨¼ã€‘: ãƒœã‚¿ãƒ³ãŒç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
      expect(scene.rexUI.add.label).toHaveBeenCalled(); // ğŸŸ¡
    });
  });

  describe('T-0018-BTN-13: ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹åŒ–ã¨å†æœ‰åŠ¹åŒ–', () => {
    // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: çŠ¶æ…‹åˆ‡ã‚Šæ›¿ãˆã®å‹•ä½œã‚’ç¢ºèª
    // ã€ãƒ†ã‚¹ãƒˆå†…å®¹ã€‘: enabledçŠ¶æ…‹ã®åˆ‡ã‚Šæ›¿ãˆãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼
    // ã€æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã€‘: çŠ¶æ…‹åˆ‡ã‚Šæ›¿ãˆãŒå³åº§ã«åæ˜ ã•ã‚Œã‚‹
    // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: Phase 2è¦ä»¶å®šç¾©æ›¸ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ 2.1.3 ã«å…¬é–‹ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦è¨˜è¼‰

    test('ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹åŒ–ã¨å†æœ‰åŠ¹åŒ–ãŒæ­£ã—ãå‹•ä½œã™ã‚‹', () => {
      // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ãƒœã‚¿ãƒ³ã‚’ç”Ÿæˆ
      const button = new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ç„¡åŠ¹åŒ–â†’æœ‰åŠ¹åŒ–â†’ç„¡åŠ¹åŒ–ã®é †ã«å®Ÿè¡Œ
      button.setEnabled(false);
      expect(button.isEnabled()).toBe(false); // ğŸ”µ

      button.setEnabled(true);
      expect(button.isEnabled()).toBe(true); // ğŸ”µ

      button.setEnabled(false);
      expect(button.isEnabled()).toBe(false); // ğŸ”µ
    });

    test('å†æœ‰åŠ¹åŒ–å¾Œã«ã‚¯ãƒªãƒƒã‚¯ãŒå‹•ä½œã™ã‚‹', () => {
      // ã€ç¢ºèªå†…å®¹ã€‘: å†æœ‰åŠ¹åŒ–å¾Œã€ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãŒå†ã³æ©Ÿèƒ½ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
      const button = new Button(scene, 100, 200, {
        text: 'ãƒ†ã‚¹ãƒˆ',
        onClick: mockCallback,
      });

      button.setEnabled(false);
      button.setEnabled(true);

      const onPointerDown = mockLabel.on.mock.calls.find(
        (call: unknown[]) => call[0] === 'pointerdown',
      )?.[1];

      if (onPointerDown) {
        onPointerDown();
      }

      expect(mockCallback).toHaveBeenCalledTimes(1); // ğŸ”µ
    });
  });
});
